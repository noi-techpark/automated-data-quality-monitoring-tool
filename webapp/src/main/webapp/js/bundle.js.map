{
  "version": 3,
  "sources": ["../../../../node_modules/keycloak-js/lib/keycloak.js", "../../typescript/api/api3.ts", "../../typescript/config.ts", "../../typescript/auth.ts", "../../typescript/CommonWebComponent.ts", "../../typescript/Loader.html", "../../typescript/Loader.ts", "../../typescript/quality.ts", "../../typescript/MenuComponent.html", "../../typescript/MenuComponent.ts", "../../typescript/LabelAndData.html", "../../typescript/LabelAndData.ts", "../../typescript/DatasetCardComponent.html", "../../typescript/DatasetCardComponent.ts", "../../typescript/StandardDashboardsComponent.html", "../../typescript/StandardDashboardsComponent.ts", "../../typescript/CustomDashboardsComponent.html", "../../typescript/CustomDashboardsComponent.ts", "../../typescript/OpenCloseSection.html", "../../typescript/OpenCloseSection.ts", "../../typescript/SectionRow.html", "../../typescript/SectionRow.ts", "../../typescript/DatasetIssueCategoryComponent.html", "../../typescript/DatasetIssueCategoryComponent.ts", "../../typescript/DatasetIssuesDetail.html", "../../typescript/DatasetIssuesDetail.ts", "../../typescript/DatasetIssuesByCategories.html", "../../typescript/DatasetIssuesByCategories.ts", "../../../../node_modules/jwt-decode/build/esm/index.js", "../../typescript/AuthComponent.html", "../../typescript/AuthComponent.ts", "../../typescript/CustomDatasetForm.html", "../../typescript/AutoComplete.html", "../../typescript/AutoComplete.ts", "../../typescript/CustomDatasetFormQualityCheck.html", "../../typescript/CustomDatasetFormQualityCheck.ts", "../../typescript/CustomDatasetForm.ts", "../../typescript/MainComponent.html", "../../typescript/MainComponent.ts", "../../typescript/main.ts"],
  "sourcesContent": ["// @ts-check\n/**\n * @import {Acr, KeycloakAccountOptions, KeycloakAdapter, KeycloakConfig, KeycloakError, KeycloakFlow, KeycloakInitOptions, KeycloakLoginOptions, KeycloakLogoutOptions, KeycloakPkceMethod, KeycloakProfile, KeycloakRegisterOptions, KeycloakResourceAccess, KeycloakResponseMode, KeycloakResponseType, KeycloakRoles, KeycloakTokenParsed, OpenIdProviderMetadata} from \"./keycloak.ts\"\n */\n/*\n * Copyright 2016 Red Hat, Inc. and/or its affiliates\n * and other contributors as indicated by the @author tags.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst CONTENT_TYPE_JSON = 'application/json'\n\n/**\n * @typedef {Object} Endpoints\n * @property {() => string} authorize\n * @property {() => string} token\n * @property {() => string} logout\n * @property {() => string} checkSessionIframe\n * @property {() => string=} thirdPartyCookiesIframe\n * @property {() => string} register\n * @property {() => string} userinfo\n */\n\n/**\n * @typedef {Object} LoginIframe\n * @property {boolean} enable\n * @property {((error: Error | null, value?: boolean) => void)[]} callbackList\n * @property {number} interval\n * @property {HTMLIFrameElement=} iframe\n * @property {string=} iframeOrigin\n */\n\nexport default class Keycloak {\n  /** @type {Pick<PromiseWithResolvers<boolean>, 'resolve' | 'reject'>[]} */\n  #refreshQueue = []\n  /** @type {KeycloakAdapter} */\n  #adapter\n  /** @type {boolean} */\n  #useNonce = true\n  /** @type {CallbackStorage} */\n  #callbackStorage\n  #logInfo = this.#createLogger(console.info)\n  #logWarn = this.#createLogger(console.warn)\n  /** @type {LoginIframe} */\n  #loginIframe = {\n    enable: true,\n    callbackList: [],\n    interval: 5\n  }\n\n  /** @type {KeycloakConfig} config */\n  #config\n  didInitialize = false\n  authenticated = false\n  loginRequired = false\n  /** @type {KeycloakResponseMode} */\n  responseMode = 'fragment'\n  /** @type {KeycloakResponseType} */\n  responseType = 'code'\n  /** @type {KeycloakFlow} */\n  flow = 'standard'\n  /** @type {number?} */\n  timeSkew = null\n  /** @type {string=} */\n  redirectUri\n  /** @type {string=} */\n  silentCheckSsoRedirectUri\n  /** @type {boolean} */\n  silentCheckSsoFallback = true\n  /** @type {KeycloakPkceMethod} */\n  pkceMethod = 'S256'\n  enableLogging = false\n  /** @type {'GET' | 'POST'} */\n  logoutMethod = 'GET'\n  /** @type {string=} */\n  scope\n  messageReceiveTimeout = 10000\n  /** @type {string=} */\n  idToken\n  /** @type {KeycloakTokenParsed=} */\n  idTokenParsed\n  /** @type {string=} */\n  token\n  /** @type {KeycloakTokenParsed=} */\n  tokenParsed\n  /** @type {string=} */\n  refreshToken\n  /** @type {KeycloakTokenParsed=} */\n  refreshTokenParsed\n  /** @type {string=} */\n  clientId\n  /** @type {string=} */\n  sessionId\n  /** @type {string=} */\n  subject\n  /** @type {string=} */\n  authServerUrl\n  /** @type {string=} */\n  realm\n  /** @type {KeycloakRoles=} */\n  realmAccess\n  /** @type {KeycloakResourceAccess=} */\n  resourceAccess\n  /** @type {KeycloakProfile=} */\n  profile\n  /** @type {{}=} */\n  userInfo\n  /** @type {Endpoints} */\n  endpoints\n  /** @type {number=} */\n  tokenTimeoutHandle\n  /** @type {() => void=} */\n  onAuthSuccess\n  /** @type {(errorData?: KeycloakError) => void=} */\n  onAuthError\n  /** @type {() => void=} */\n  onAuthRefreshSuccess\n  /** @type {() => void=} */\n  onAuthRefreshError\n  /** @type {() => void=} */\n  onTokenExpired\n  /** @type {() => void=} */\n  onAuthLogout\n  /** @type {(authenticated: boolean) => void=} */\n  onReady\n  /** @type {(status: 'success' | 'cancelled' | 'error', action: string) => void=} */\n  onActionUpdate\n\n  /**\n   * @param {KeycloakConfig} config\n   */\n  constructor (config) {\n    if (typeof config !== 'string' && !isObject(config)) {\n      throw new Error(\"The 'Keycloak' constructor must be provided with a configuration object, or a URL to a JSON configuration file.\")\n    }\n\n    if (isObject(config)) {\n      const requiredProperties = 'oidcProvider' in config\n        ? ['clientId']\n        : ['url', 'realm', 'clientId']\n\n      for (const property of requiredProperties) {\n        if (!(property in config)) {\n          throw new Error(`The configuration object is missing the required '${property}' property.`)\n        }\n      }\n    }\n\n    if (!globalThis.isSecureContext) {\n      this.#logWarn(\n        \"[KEYCLOAK] Keycloak JS must be used in a 'secure context' to function properly as it relies on browser APIs that are otherwise not available.\\n\" +\n                'Continuing to run your application insecurely will lead to unexpected behavior and breakage.\\n\\n' +\n                'For more information see: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts'\n      )\n    }\n\n    this.#config = config\n  }\n\n  /**\n   * @param {KeycloakInitOptions} initOptions\n   * @returns {Promise<boolean>}\n   */\n  async init (initOptions = {}) {\n    if (this.didInitialize) {\n      throw new Error(\"A 'Keycloak' instance can only be initialized once.\")\n    }\n\n    this.didInitialize = true\n    this.#callbackStorage = createCallbackStorage()\n\n    const adapters = ['default', 'cordova', 'cordova-native']\n\n    if (typeof initOptions.adapter === 'string' && adapters.includes(initOptions.adapter)) {\n      this.#adapter = this.#loadAdapter(initOptions.adapter)\n    } else if (typeof initOptions.adapter === 'object') {\n      this.#adapter = initOptions.adapter\n    } else if ('Cordova' in window || 'cordova' in window) {\n      this.#adapter = this.#loadAdapter('cordova')\n    } else {\n      this.#adapter = this.#loadAdapter('default')\n    }\n\n    if (typeof initOptions.useNonce !== 'undefined') {\n      this.#useNonce = initOptions.useNonce\n    }\n\n    if (typeof initOptions.checkLoginIframe !== 'undefined') {\n      this.#loginIframe.enable = initOptions.checkLoginIframe\n    }\n\n    if (initOptions.checkLoginIframeInterval) {\n      this.#loginIframe.interval = initOptions.checkLoginIframeInterval\n    }\n\n    if (initOptions.onLoad === 'login-required') {\n      this.loginRequired = true\n    }\n\n    if (initOptions.responseMode) {\n      if (initOptions.responseMode === 'query' || initOptions.responseMode === 'fragment') {\n        this.responseMode = initOptions.responseMode\n      } else {\n        throw new Error('Invalid value for responseMode')\n      }\n    }\n\n    if (initOptions.flow) {\n      switch (initOptions.flow) {\n        case 'standard':\n          this.responseType = 'code'\n          break\n        case 'implicit':\n          this.responseType = 'id_token token'\n          break\n        case 'hybrid':\n          this.responseType = 'code id_token token'\n          break\n        default:\n          throw new Error('Invalid value for flow')\n      }\n      this.flow = initOptions.flow\n    }\n\n    if (typeof initOptions.timeSkew === 'number') {\n      this.timeSkew = initOptions.timeSkew\n    }\n\n    if (initOptions.redirectUri) {\n      this.redirectUri = initOptions.redirectUri\n    }\n\n    if (initOptions.silentCheckSsoRedirectUri) {\n      this.silentCheckSsoRedirectUri = initOptions.silentCheckSsoRedirectUri\n    }\n\n    if (typeof initOptions.silentCheckSsoFallback === 'boolean') {\n      this.silentCheckSsoFallback = initOptions.silentCheckSsoFallback\n    }\n\n    if (typeof initOptions.pkceMethod !== 'undefined') {\n      if (initOptions.pkceMethod !== 'S256' && initOptions.pkceMethod !== false) {\n        throw new TypeError(`Invalid value for pkceMethod', expected 'S256' or false but got ${initOptions.pkceMethod}.`)\n      }\n\n      this.pkceMethod = initOptions.pkceMethod\n    }\n\n    if (typeof initOptions.enableLogging === 'boolean') {\n      this.enableLogging = initOptions.enableLogging\n    }\n\n    if (initOptions.logoutMethod === 'POST') {\n      this.logoutMethod = 'POST'\n    }\n\n    if (typeof initOptions.scope === 'string') {\n      this.scope = initOptions.scope\n    }\n\n    if (typeof initOptions.messageReceiveTimeout === 'number' && initOptions.messageReceiveTimeout > 0) {\n      this.messageReceiveTimeout = initOptions.messageReceiveTimeout\n    }\n\n    await this.#loadConfig()\n    await this.#check3pCookiesSupported()\n    await this.#processInit(initOptions)\n\n    this.onReady?.(this.authenticated)\n\n    return this.authenticated\n  }\n\n  /**\n   * @param {\"default\" | \"cordova\" | \"cordova-native\"} type\n   * @returns {KeycloakAdapter}\n   */\n  #loadAdapter (type) {\n    if (type === 'default') {\n      return this.#loadDefaultAdapter()\n    }\n\n    if (type === 'cordova') {\n      this.#loginIframe.enable = false\n      return this.#loadCordovaAdapter()\n    }\n\n    if (type === 'cordova-native') {\n      this.#loginIframe.enable = false\n      return this.#loadCordovaNativeAdapter()\n    }\n\n    throw new Error('invalid adapter type: ' + type)\n  }\n\n  /**\n   * @returns {KeycloakAdapter}\n   */\n  #loadDefaultAdapter () {\n    /** @type {KeycloakAdapter['redirectUri']}{} */\n    const redirectUri = (options) => {\n      return options?.redirectUri || this.redirectUri || globalThis.location.href\n    }\n\n    return {\n      login: async (options) => {\n        window.location.assign(await this.createLoginUrl(options))\n        return await new Promise(() => {})\n      },\n\n      logout: async (options) => {\n        const logoutMethod = options?.logoutMethod ?? this.logoutMethod\n\n        if (logoutMethod === 'GET') {\n          window.location.replace(this.createLogoutUrl(options))\n          return\n        }\n\n        // Create form to send POST request.\n        const form = document.createElement('form')\n\n        form.setAttribute('method', 'POST')\n        form.setAttribute('action', this.createLogoutUrl(options))\n        form.style.display = 'none'\n\n        // Add data to form as hidden input fields.\n        const data = {\n          id_token_hint: this.idToken,\n          client_id: this.clientId,\n          post_logout_redirect_uri: redirectUri(options)\n        }\n\n        for (const [name, value] of Object.entries(data)) {\n          const input = document.createElement('input')\n\n          input.setAttribute('type', 'hidden')\n          input.setAttribute('name', name)\n          input.setAttribute('value', /** @type {string} */ (value))\n\n          form.appendChild(input)\n        }\n\n        // Append form to page and submit it to perform logout and redirect.\n        document.body.appendChild(form)\n        form.submit()\n      },\n\n      register: async (options) => {\n        window.location.assign(await this.createRegisterUrl(options))\n        return await new Promise(() => {})\n      },\n\n      accountManagement: async () => {\n        const accountUrl = this.createAccountUrl()\n        if (typeof accountUrl !== 'undefined') {\n          window.location.href = accountUrl\n        } else {\n          throw new Error('Not supported by the OIDC server')\n        }\n        return await new Promise(() => {})\n      },\n\n      redirectUri\n    }\n  }\n\n  /**\n   * @returns {KeycloakAdapter}\n   */\n  #loadCordovaAdapter () {\n    /**\n     * @param {string} loginUrl\n     * @param {string} target\n     * @param {string} options\n     * @returns {WindowProxy | null}\n     */\n    const cordovaOpenWindowWrapper = (loginUrl, target, options) => {\n      if (window.cordova && window.cordova.InAppBrowser) {\n        // Use inappbrowser for IOS and Android if available\n        return window.cordova.InAppBrowser.open(loginUrl, target, options)\n      } else {\n        return window.open(loginUrl, target, options)\n      }\n    }\n\n    const shallowCloneCordovaOptions = (userOptions) => {\n      if (userOptions && userOptions.cordovaOptions) {\n        return Object.keys(userOptions.cordovaOptions).reduce((options, optionName) => {\n          options[optionName] = userOptions.cordovaOptions[optionName]\n          return options\n        }, {})\n      } else {\n        return {}\n      }\n    }\n\n    const formatCordovaOptions = (cordovaOptions) => {\n      return Object.keys(cordovaOptions).reduce((options, optionName) => {\n        options.push(optionName + '=' + cordovaOptions[optionName])\n        return options\n      }, []).join(',')\n    }\n\n    const createCordovaOptions = (userOptions) => {\n      const cordovaOptions = shallowCloneCordovaOptions(userOptions)\n      cordovaOptions.location = 'no'\n      if (userOptions && userOptions.prompt === 'none') {\n        cordovaOptions.hidden = 'yes'\n      }\n      return formatCordovaOptions(cordovaOptions)\n    }\n\n    const getCordovaRedirectUri = () => {\n      return this.redirectUri || 'http://localhost'\n    }\n\n    return {\n      login: async (options) => {\n        const cordovaOptions = createCordovaOptions(options)\n        const loginUrl = await this.createLoginUrl(options)\n        const ref = cordovaOpenWindowWrapper(loginUrl, '_blank', cordovaOptions)\n        let completed = false\n        let closed = false\n\n        function closeBrowser () {\n          closed = true\n          ref.close()\n        };\n\n        return await new Promise((resolve, reject) => {\n          ref.addEventListener('loadstart', async (event) => {\n            if (event.url.indexOf(getCordovaRedirectUri()) === 0) {\n              const callback = this.#parseCallback(event.url)\n\n              try {\n                await this.#processCallback(callback)\n                resolve()\n              } catch (error) {\n                reject(error)\n              }\n              closeBrowser()\n              completed = true\n            }\n          })\n\n          ref.addEventListener('loaderror', async (event) => {\n            if (!completed) {\n              if (event.url.indexOf(getCordovaRedirectUri()) === 0) {\n                const callback = this.#parseCallback(event.url)\n                try {\n                  await this.#processCallback(callback)\n                  resolve()\n                } catch (error) {\n                  reject(error)\n                }\n                closeBrowser()\n                completed = true\n              } else {\n                reject(new Error('Unable to process login.'))\n                closeBrowser()\n              }\n            }\n          })\n\n          ref.addEventListener('exit', function (event) {\n            if (!closed) {\n              reject(new Error('User closed the login window.'))\n            }\n          })\n        })\n      },\n\n      logout: async (options) => {\n        const logoutUrl = this.createLogoutUrl(options)\n        const ref = cordovaOpenWindowWrapper(logoutUrl, '_blank', 'location=no,hidden=yes,clearcache=yes')\n        let error = false\n\n        ref.addEventListener('loadstart', (event) => {\n          if (event.url.indexOf(getCordovaRedirectUri()) === 0) {\n            ref.close()\n          }\n        })\n\n        ref.addEventListener('loaderror', (event) => {\n          if (event.url.indexOf(getCordovaRedirectUri()) === 0) {\n            ref.close()\n          } else {\n            error = true\n            ref.close()\n          }\n        })\n\n        await new Promise((resolve, reject) => {\n          ref.addEventListener('exit', () => {\n            if (error) {\n              reject(new Error('User closed the login window.'))\n            } else {\n              this.clearToken()\n              resolve()\n            }\n          })\n        })\n      },\n\n      register: async (options) => {\n        const registerUrl = await this.createRegisterUrl()\n        const cordovaOptions = createCordovaOptions(options)\n        const ref = cordovaOpenWindowWrapper(registerUrl, '_blank', cordovaOptions)\n\n        /** @type {Promise<void>} */\n        const promise = new Promise((resolve, reject) => {\n          ref.addEventListener('loadstart', async (event) => {\n            if (event.url.indexOf(getCordovaRedirectUri()) === 0) {\n              ref.close()\n              const oauth = this.#parseCallback(event.url)\n\n              try {\n                await this.#processCallback(oauth)\n                resolve()\n              } catch (error) {\n                reject(error)\n              }\n            }\n          })\n        })\n\n        await promise\n      },\n\n      accountManagement: async () => {\n        const accountUrl = this.createAccountUrl()\n        if (typeof accountUrl !== 'undefined') {\n          const ref = cordovaOpenWindowWrapper(accountUrl, '_blank', 'location=no')\n          ref.addEventListener('loadstart', function (event) {\n            if (event.url.indexOf(getCordovaRedirectUri()) === 0) {\n              ref.close()\n            }\n          })\n        } else {\n          throw new Error('Not supported by the OIDC server')\n        }\n      },\n\n      redirectUri: () => {\n        return getCordovaRedirectUri()\n      }\n    }\n  }\n\n  /**\n   * @returns {KeycloakAdapter}\n   */\n  #loadCordovaNativeAdapter () {\n    /* global universalLinks */\n    return {\n      login: async (options) => {\n        const loginUrl = await this.createLoginUrl(options)\n\n        await new Promise((resolve, reject) => {\n          universalLinks.subscribe('keycloak', async (event) => {\n            universalLinks.unsubscribe('keycloak')\n            window.cordova.plugins.browsertab.close()\n            const oauth = this.#parseCallback(event.url)\n\n            try {\n              await this.#processCallback(oauth)\n              resolve()\n            } catch (error) {\n              reject(error)\n            }\n          })\n\n          window.cordova.plugins.browsertab.openUrl(loginUrl)\n        })\n      },\n\n      logout: async (options) => {\n        const logoutUrl = this.createLogoutUrl(options)\n\n        await new Promise((resolve) => {\n          universalLinks.subscribe('keycloak', () => {\n            universalLinks.unsubscribe('keycloak')\n            window.cordova.plugins.browsertab.close()\n            this.clearToken()\n            resolve()\n          })\n\n          window.cordova.plugins.browsertab.openUrl(logoutUrl)\n        })\n      },\n\n      register: async (options) => {\n        const registerUrl = await this.createRegisterUrl(options)\n\n        await new Promise((resolve, reject) => {\n          universalLinks.subscribe('keycloak', async (event) => {\n            universalLinks.unsubscribe('keycloak')\n            window.cordova.plugins.browsertab.close()\n            const oauth = this.#parseCallback(event.url)\n            try {\n              await this.#processCallback(oauth)\n              resolve()\n            } catch (error) {\n              reject(error)\n            }\n          })\n\n          window.cordova.plugins.browsertab.openUrl(registerUrl)\n        })\n      },\n\n      accountManagement: async () => {\n        const accountUrl = this.createAccountUrl()\n        if (typeof accountUrl !== 'undefined') {\n          window.cordova.plugins.browsertab.openUrl(accountUrl)\n        } else {\n          throw new Error('Not supported by the OIDC server')\n        }\n      },\n\n      redirectUri: (options) => {\n        if (options && options.redirectUri) {\n          return options.redirectUri\n        } else if (this.redirectUri) {\n          return this.redirectUri\n        } else {\n          return 'http://localhost'\n        }\n      }\n    }\n  }\n\n  /**\n   * @returns {Promise<void>}\n   */\n  async #loadConfig () {\n    if (typeof this.#config === 'string') {\n      const jsonConfig = await fetchJsonConfig(this.#config)\n      this.authServerUrl = jsonConfig['auth-server-url']\n      this.realm = jsonConfig.realm\n      this.clientId = jsonConfig.resource\n      this.#setupEndpoints()\n    } else {\n      this.clientId = this.#config.clientId\n\n      if ('oidcProvider' in this.#config) {\n        await this.#loadOidcConfig(this.#config.oidcProvider)\n      } else {\n        this.authServerUrl = this.#config.url\n        this.realm = this.#config.realm\n        this.#setupEndpoints()\n      }\n    }\n  }\n\n  /**\n   * @returns {void}\n   */\n  #setupEndpoints () {\n    this.endpoints = {\n      authorize: () => {\n        return this.#getRealmUrl() + '/protocol/openid-connect/auth'\n      },\n      token: () => {\n        return this.#getRealmUrl() + '/protocol/openid-connect/token'\n      },\n      logout: () => {\n        return this.#getRealmUrl() + '/protocol/openid-connect/logout'\n      },\n      checkSessionIframe: () => {\n        return this.#getRealmUrl() + '/protocol/openid-connect/login-status-iframe.html'\n      },\n      thirdPartyCookiesIframe: () => {\n        return this.#getRealmUrl() + '/protocol/openid-connect/3p-cookies/step1.html'\n      },\n      register: () => {\n        return this.#getRealmUrl() + '/protocol/openid-connect/registrations'\n      },\n      userinfo: () => {\n        return this.#getRealmUrl() + '/protocol/openid-connect/userinfo'\n      }\n    }\n  }\n\n  /**\n   * @param {string | OpenIdProviderMetadata} oidcProvider\n   * @returns {Promise<void>}\n   */\n  async #loadOidcConfig (oidcProvider) {\n    if (typeof oidcProvider === 'string') {\n      const url = `${stripTrailingSlash(oidcProvider)}/.well-known/openid-configuration`\n      const openIdConfig = await fetchOpenIdConfig(url)\n      this.#setupOidcEndpoints(openIdConfig)\n    } else {\n      this.#setupOidcEndpoints(oidcProvider)\n    }\n  }\n\n  /**\n   * @param {OpenIdProviderMetadata} config\n   * @returns {void}\n   */\n  #setupOidcEndpoints (config) {\n    this.endpoints = {\n      authorize () {\n        return config.authorization_endpoint\n      },\n      token () {\n        return config.token_endpoint\n      },\n      logout () {\n        if (!config.end_session_endpoint) {\n          throw new Error('Not supported by the OIDC server')\n        }\n        return config.end_session_endpoint\n      },\n      checkSessionIframe () {\n        if (!config.check_session_iframe) {\n          throw new Error('Not supported by the OIDC server')\n        }\n        return config.check_session_iframe\n      },\n      register () {\n        throw new Error('Redirection to \"Register user\" page not supported in standard OIDC mode')\n      },\n      userinfo () {\n        if (!config.userinfo_endpoint) {\n          throw new Error('Not supported by the OIDC server')\n        }\n        return config.userinfo_endpoint\n      }\n    }\n  }\n\n  /**\n   * @returns {Promise<void>}\n   */\n  async #check3pCookiesSupported () {\n    if ((!this.#loginIframe.enable && !this.silentCheckSsoRedirectUri) || typeof this.endpoints.thirdPartyCookiesIframe !== 'function') {\n      return\n    }\n\n    const iframe = document.createElement('iframe')\n    iframe.setAttribute('src', this.endpoints.thirdPartyCookiesIframe())\n    iframe.setAttribute('sandbox', 'allow-storage-access-by-user-activation allow-scripts allow-same-origin')\n    iframe.setAttribute('title', 'keycloak-3p-check-iframe')\n    iframe.style.display = 'none'\n    document.body.appendChild(iframe)\n\n    /** @type {Promise<void>} */\n    const promise = new Promise((resolve) => {\n      /**\n       * @param {MessageEvent} event\n       */\n      const messageCallback = (event) => {\n        if (iframe.contentWindow !== event.source) {\n          return\n        }\n\n        if (event.data !== 'supported' && event.data !== 'unsupported') {\n          return\n        } else if (event.data === 'unsupported') {\n          this.#logWarn(\n            '[KEYCLOAK] Your browser is blocking access to 3rd-party cookies, this means:\\n\\n' +\n                        ' - It is not possible to retrieve tokens without redirecting to the Keycloak server (a.k.a. no support for silent authentication).\\n' +\n                        ' - It is not possible to automatically detect changes to the session status (such as the user logging out in another tab).\\n\\n' +\n                        'For more information see: https://www.keycloak.org/securing-apps/javascript-adapter#_modern_browsers'\n          )\n\n          this.#loginIframe.enable = false\n          if (this.silentCheckSsoFallback) {\n            this.silentCheckSsoRedirectUri = undefined\n          }\n        }\n\n        document.body.removeChild(iframe)\n        window.removeEventListener('message', messageCallback)\n        resolve()\n      }\n\n      window.addEventListener('message', messageCallback, false)\n    })\n\n    return await applyTimeoutToPromise(promise, this.messageReceiveTimeout, 'Timeout when waiting for 3rd party check iframe message.')\n  }\n\n  /**\n   * @param {KeycloakInitOptions} initOptions\n   * @returns {Promise<void>}\n   */\n  async #processInit (initOptions) {\n    const callback = this.#parseCallback(window.location.href)\n\n    if (callback?.redirectUri) {\n      window.history.replaceState(window.history.state, '', callback.redirectUri)\n    }\n\n    if (callback && callback.valid) {\n      await this.#setupCheckLoginIframe()\n      await this.#processCallback(callback)\n      return\n    }\n\n    /** @param {boolean} prompt */\n    const doLogin = async (prompt) => {\n      /** @type {KeycloakLoginOptions} */\n      const options = {}\n\n      if (!prompt) {\n        options.prompt = 'none'\n      }\n\n      if (initOptions.locale) {\n        options.locale = initOptions.locale\n      }\n\n      await this.login(options)\n    }\n\n    const onLoad = async () => {\n      switch (initOptions.onLoad) {\n        case 'check-sso':\n          if (this.#loginIframe.enable) {\n            await this.#setupCheckLoginIframe()\n            const unchanged = await this.#checkLoginIframe()\n\n            if (!unchanged) {\n              this.silentCheckSsoRedirectUri ? await this.#checkSsoSilently() : await doLogin(false)\n            }\n          } else {\n            this.silentCheckSsoRedirectUri ? await this.#checkSsoSilently() : await doLogin(false)\n          }\n          break\n        case 'login-required':\n          await doLogin(true)\n          break\n        default:\n          throw new Error('Invalid value for onLoad')\n      }\n    }\n\n    if (initOptions.token && initOptions.refreshToken) {\n      this.#setToken(initOptions.token, initOptions.refreshToken, initOptions.idToken)\n\n      if (this.#loginIframe.enable) {\n        await this.#setupCheckLoginIframe()\n        const unchanged = await this.#checkLoginIframe()\n\n        if (unchanged) {\n          this.onAuthSuccess?.()\n          this.#scheduleCheckIframe()\n        }\n      } else {\n        try {\n          await this.updateToken(-1)\n          this.onAuthSuccess?.()\n        } catch (error) {\n          this.onAuthError?.()\n          if (initOptions.onLoad) {\n            await onLoad()\n          } else {\n            throw error\n          }\n        }\n      }\n    } else if (initOptions.onLoad) {\n      await onLoad()\n    }\n  }\n\n  /**\n   * @returns {Promise<void>}\n   */\n  async #setupCheckLoginIframe () {\n    if (!this.#loginIframe.enable || this.#loginIframe.iframe) {\n      return\n    }\n\n    const iframe = document.createElement('iframe')\n    this.#loginIframe.iframe = iframe\n    iframe.setAttribute('src', this.endpoints.checkSessionIframe())\n    iframe.setAttribute('sandbox', 'allow-storage-access-by-user-activation allow-scripts allow-same-origin')\n    iframe.setAttribute('title', 'keycloak-session-iframe')\n    iframe.style.display = 'none'\n    document.body.appendChild(iframe)\n\n    /**\n     * @param {MessageEvent} event\n     */\n    const messageCallback = (event) => {\n      if (event.origin !== this.#loginIframe.iframeOrigin || this.#loginIframe.iframe?.contentWindow !== event.source) {\n        return\n      }\n\n      if (!(event.data === 'unchanged' || event.data === 'changed' || event.data === 'error')) {\n        return\n      }\n\n      if (event.data !== 'unchanged') {\n        this.clearToken()\n      }\n\n      const callbacks = this.#loginIframe.callbackList\n      this.#loginIframe.callbackList = []\n\n      for (const callback of callbacks.reverse()) {\n        if (event.data === 'error') {\n          callback(new Error('Error while checking login iframe'))\n        } else {\n          callback(null, event.data === 'unchanged')\n        }\n      }\n    }\n\n    window.addEventListener('message', messageCallback, false)\n\n    /** @type {Promise<void>} */\n    const promise = new Promise((resolve) => {\n      iframe.addEventListener('load', () => {\n        const authUrl = this.endpoints.authorize()\n        if (authUrl.startsWith('/')) {\n          this.#loginIframe.iframeOrigin = globalThis.location.origin\n        } else {\n          this.#loginIframe.iframeOrigin = new URL(authUrl).origin\n        }\n        resolve()\n      })\n    })\n\n    await promise\n  }\n\n  /**\n   * @returns {Promise<boolean | undefined>}\n   */\n  async #checkLoginIframe () {\n    if (!this.#loginIframe.iframe || !this.#loginIframe.iframeOrigin) {\n      return\n    }\n\n    const message = `${this.clientId} ${(this.sessionId ? this.sessionId : '')}`\n    const origin = this.#loginIframe.iframeOrigin\n\n    /** @type {Promise<boolean>} */\n    const promise = new Promise((resolve, reject) => {\n      /** @type {(error: Error | null, value?: boolean) => void} */\n      const callback = (error, result) => error ? reject(error) : resolve(/** @type {boolean} */ (result))\n\n      this.#loginIframe.callbackList.push(callback)\n\n      if (this.#loginIframe.callbackList.length === 1) {\n        this.#loginIframe.iframe?.contentWindow?.postMessage(message, origin)\n      }\n    })\n\n    return await promise\n  }\n\n  /**\n   * @returns {Promise<void>}\n   */\n  async #checkSsoSilently () {\n    const iframe = document.createElement('iframe')\n    const src = await this.createLoginUrl({ prompt: 'none', redirectUri: this.silentCheckSsoRedirectUri })\n    iframe.setAttribute('src', src)\n    iframe.setAttribute('sandbox', 'allow-storage-access-by-user-activation allow-scripts allow-same-origin')\n    iframe.setAttribute('title', 'keycloak-silent-check-sso')\n    iframe.style.display = 'none'\n    document.body.appendChild(iframe)\n\n    return await new Promise((resolve, reject) => {\n      /**\n       * @param {MessageEvent} event\n       */\n      const messageCallback = async (event) => {\n        if (event.origin !== window.location.origin || iframe.contentWindow !== event.source) {\n          return\n        }\n\n        const oauth = this.#parseCallback(event.data)\n\n        try {\n          await this.#processCallback(oauth)\n          resolve()\n        } catch (error) {\n          reject(error)\n        }\n\n        document.body.removeChild(iframe)\n        window.removeEventListener('message', messageCallback)\n      }\n\n      window.addEventListener('message', messageCallback)\n    })\n  };\n\n  /**\n   * @param {string} url\n   */\n  #parseCallback (url) {\n    const oauth = this.#parseCallbackUrl(url)\n    if (!oauth) {\n      return\n    }\n\n    const oauthState = this.#callbackStorage.get(oauth.state)\n\n    if (oauthState) {\n      oauth.valid = true\n      oauth.redirectUri = oauthState.redirectUri\n      oauth.storedNonce = oauthState.nonce\n      oauth.prompt = oauthState.prompt\n      oauth.pkceCodeVerifier = oauthState.pkceCodeVerifier\n      oauth.loginOptions = oauthState.loginOptions\n    }\n\n    return oauth\n  }\n\n  /**\n   * @param {string} urlString\n   */\n  #parseCallbackUrl (urlString) {\n    let supportedParams = []\n    switch (this.flow) {\n      case 'standard':\n        supportedParams = ['code', 'state', 'session_state', 'kc_action_status', 'kc_action', 'iss']\n        break\n      case 'implicit':\n        supportedParams = ['access_token', 'token_type', 'id_token', 'state', 'session_state', 'expires_in', 'kc_action_status', 'kc_action', 'iss']\n        break\n      case 'hybrid':\n        supportedParams = ['access_token', 'token_type', 'id_token', 'code', 'state', 'session_state', 'expires_in', 'kc_action_status', 'kc_action', 'iss']\n        break\n    }\n\n    supportedParams.push('error')\n    supportedParams.push('error_description')\n    supportedParams.push('error_uri')\n\n    const url = new URL(urlString)\n    let redirectUri = ''\n    let parsed\n\n    if (this.responseMode === 'query' && url.searchParams.size > 0) {\n      parsed = this.#parseCallbackParams(url.search, supportedParams)\n      url.search = parsed.paramsString\n      redirectUri = url.toString()\n    } else if (this.responseMode === 'fragment' && url.hash.length > 0) {\n      parsed = this.#parseCallbackParams(url.hash.substring(1), supportedParams)\n      url.hash = ''\n      redirectUri = url.toString()\n    }\n\n    if (parsed?.oauthParams) {\n      if (this.flow === 'standard' || this.flow === 'hybrid') {\n        if ((parsed.oauthParams.code || parsed.oauthParams.error) && parsed.oauthParams.state) {\n          parsed.oauthParams.redirectUri = redirectUri\n          return parsed.oauthParams\n        }\n      } else if (this.flow === 'implicit') {\n        if ((parsed.oauthParams.access_token || parsed.oauthParams.error) && parsed.oauthParams.state) {\n          parsed.oauthParams.redirectUri = redirectUri\n          return parsed.oauthParams\n        }\n      }\n    }\n  }\n\n  /**\n   * @typedef {Object} ParsedCallbackParams\n   * @property {string} paramsString\n   * @property {Record<string, string | undefined>} oauthParams\n   */\n\n  /**\n   * @param {string} paramsString\n   * @param {string[]} supportedParams\n   * @returns {ParsedCallbackParams}\n   */\n  #parseCallbackParams (paramsString, supportedParams) {\n    const params = new URLSearchParams(paramsString)\n    /** @type {Record<string, string>} */\n    const oauthParams = {}\n\n    for (const [key, value] of Array.from(params.entries())) {\n      if (supportedParams.includes(key)) {\n        oauthParams[key] = value\n        params.delete(key)\n      }\n    }\n\n    return {\n      paramsString: params.toString(),\n      oauthParams\n    }\n  }\n\n  async #processCallback (oauth) {\n    const { code, error, prompt } = oauth\n    let timeLocal = new Date().getTime()\n\n    /**\n     * @param {string} accessToken\n     * @param {string=} refreshToken\n     * @param {string=} idToken\n     */\n    const authSuccess = (accessToken, refreshToken, idToken) => {\n      timeLocal = (timeLocal + new Date().getTime()) / 2\n\n      this.#setToken(accessToken, refreshToken, idToken, timeLocal)\n\n      if (this.#useNonce && (this.idTokenParsed && this.idTokenParsed.nonce !== oauth.storedNonce)) {\n        this.#logInfo('[KEYCLOAK] Invalid nonce, clearing token')\n        this.clearToken()\n        throw new Error('Invalid nonce.')\n      }\n    }\n\n    if (oauth.kc_action_status) {\n      this.onActionUpdate && this.onActionUpdate(oauth.kc_action_status, oauth.kc_action)\n    }\n\n    if (error) {\n      if (prompt !== 'none') {\n        if (oauth.error_description && oauth.error_description === 'authentication_expired') {\n          await this.login(oauth.loginOptions)\n        } else {\n          const errorData = { error, error_description: oauth.error_description }\n          this.onAuthError?.(errorData)\n          throw errorData\n        }\n      }\n      return\n    } else if ((this.flow !== 'standard') && (oauth.access_token || oauth.id_token)) {\n      authSuccess(oauth.access_token, undefined, oauth.id_token)\n      this.onAuthSuccess?.()\n    }\n\n    if ((this.flow !== 'implicit') && code) {\n      try {\n        const response = await fetchAccessToken(this.endpoints.token(), code, /** @type {string} */ (this.clientId), oauth.redirectUri, oauth.pkceCodeVerifier)\n        authSuccess(response.access_token, response.refresh_token, response.id_token)\n\n        if (this.flow === 'standard') {\n          this.onAuthSuccess?.()\n        }\n\n        this.#scheduleCheckIframe()\n      } catch (error) {\n        this.onAuthError?.()\n        throw error\n      }\n    }\n  }\n\n  async #scheduleCheckIframe () {\n    if (this.#loginIframe.enable && this.token) {\n      await waitForTimeout(this.#loginIframe.interval * 1000)\n      const unchanged = await this.#checkLoginIframe()\n\n      if (unchanged) {\n        await this.#scheduleCheckIframe()\n      }\n    }\n  }\n\n  /**\n   * @param {KeycloakLoginOptions} [options]\n   * @returns {Promise<void>}\n   */\n  login (options) {\n    return this.#adapter.login(options)\n  }\n\n  /**\n   * @param {KeycloakLoginOptions} [options]\n   * @returns {Promise<string>}\n   */\n  async createLoginUrl (options) {\n    const state = createUUID()\n    const nonce = createUUID()\n    const redirectUri = this.#adapter.redirectUri(options)\n    /** @type {CallbackState} */\n    const callbackState = {\n      state,\n      nonce,\n      redirectUri,\n      loginOptions: options\n    }\n\n    if (options?.prompt) {\n      callbackState.prompt = options.prompt\n    }\n\n    const url = options?.action === 'register'\n      ? this.endpoints.register()\n      : this.endpoints.authorize()\n\n    let scope = options?.scope || this.scope\n    const scopeValues = scope ? scope.split(' ') : []\n\n    // Ensure the 'openid' scope is always included.\n    if (!scopeValues.includes('openid')) {\n      scopeValues.unshift('openid')\n    }\n\n    scope = scopeValues.join(' ')\n\n    const params = new URLSearchParams([\n      ['client_id', /** @type {string} */ (this.clientId)],\n      // The endpoint URI MUST NOT include a fragment component.\n      // https://datatracker.ietf.org/doc/html/rfc6749#section-3.1.2\n      ['redirect_uri', stripHash(redirectUri)],\n      ['state', state],\n      ['response_mode', this.responseMode],\n      ['response_type', this.responseType],\n      ['scope', scope]\n    ])\n\n    if (this.#useNonce) {\n      params.append('nonce', nonce)\n    }\n\n    if (options?.prompt) {\n      params.append('prompt', options.prompt)\n    }\n\n    if (typeof options?.maxAge === 'number') {\n      params.append('max_age', options.maxAge.toString())\n    }\n\n    if (options?.loginHint) {\n      params.append('login_hint', options.loginHint)\n    }\n\n    if (options?.idpHint) {\n      params.append('kc_idp_hint', options.idpHint)\n    }\n\n    if (options?.action && options.action !== 'register') {\n      params.append('kc_action', options.action)\n    }\n\n    if (options?.locale) {\n      params.append('ui_locales', options.locale)\n    }\n\n    if (options?.acr) {\n      params.append('claims', buildClaimsParameter(options.acr))\n    }\n\n    if (options?.acrValues) {\n      params.append('acr_values', options.acrValues)\n    }\n\n    if (this.pkceMethod) {\n      try {\n        const codeVerifier = generateCodeVerifier(96)\n        const pkceChallenge = await generatePkceChallenge(this.pkceMethod, codeVerifier)\n\n        callbackState.pkceCodeVerifier = codeVerifier\n\n        params.append('code_challenge', pkceChallenge)\n        params.append('code_challenge_method', this.pkceMethod)\n      } catch (error) {\n        throw new Error('Failed to generate PKCE challenge.', { cause: error })\n      }\n    }\n\n    this.#callbackStorage.add(callbackState)\n\n    return `${url}?${params.toString()}`\n  }\n\n  /**\n   * @param {KeycloakLogoutOptions} [options]\n   * @returns {Promise<void>}\n   */\n  logout (options) {\n    return this.#adapter.logout(options)\n  }\n\n  /**\n   * @param {KeycloakLogoutOptions} [options]\n   * @returns {string}\n   */\n  createLogoutUrl (options) {\n    const logoutMethod = options?.logoutMethod ?? this.logoutMethod\n    const url = this.endpoints.logout()\n\n    if (logoutMethod === 'POST') {\n      return url\n    }\n\n    const params = new URLSearchParams([\n      ['client_id', /** @type {string} */ (this.clientId)],\n      ['post_logout_redirect_uri', this.#adapter.redirectUri(options)]\n    ])\n\n    if (this.idToken) {\n      params.append('id_token_hint', this.idToken)\n    }\n\n    return `${url}?${params.toString()}`\n  }\n\n  /**\n   * @param {KeycloakRegisterOptions} [options]\n   * @returns {Promise<void>}\n   */\n  register (options) {\n    return this.#adapter.register(options)\n  }\n\n  /**\n   * @param {KeycloakRegisterOptions} [options]\n   * @returns {Promise<string>}\n   */\n  createRegisterUrl (options) {\n    return this.createLoginUrl({ ...options, action: 'register' })\n  }\n\n  /**\n   * @param {KeycloakAccountOptions} [options]\n   * @returns {string}\n   */\n  createAccountUrl (options) {\n    const url = this.#getRealmUrl()\n\n    if (!url) {\n      throw new Error('Unable to create account URL, make sure the adapter is not configured using a generic OIDC provider.')\n    }\n\n    const params = new URLSearchParams([\n      ['referrer', /** @type {string} */ (this.clientId)],\n      ['referrer_uri', this.#adapter.redirectUri(options)]\n    ])\n\n    return `${url}/account?${params.toString()}`\n  }\n\n  /**\n   * @returns {Promise<void>}\n   */\n  accountManagement () {\n    return this.#adapter.accountManagement()\n  }\n\n  /**\n   * @param {string} role\n   * @returns {boolean}\n   */\n  hasRealmRole (role) {\n    const access = this.realmAccess\n    return !!access && access.roles.indexOf(role) >= 0\n  }\n\n  /**\n   * @param {string} role\n   * @param {string} [resource]\n   * @returns {boolean}\n   */\n  hasResourceRole (role, resource) {\n    if (!this.resourceAccess) {\n      return false\n    }\n\n    const access = this.resourceAccess[resource || /** @type {string} */ (this.clientId)]\n    return !!access && access.roles.indexOf(role) >= 0\n  }\n\n  /**\n   * @returns {Promise<KeycloakProfile>}\n   */\n  async loadUserProfile () {\n    const realmUrl = this.#getRealmUrl()\n\n    if (!realmUrl) {\n      throw new Error('Unable to load user profile, make sure the adapter is not configured using a generic OIDC provider.')\n    }\n\n    const url = `${realmUrl}/account`\n    /** @type {KeycloakProfile} */\n    const profile = await fetchJSON(url, {\n      headers: [buildAuthorizationHeader(this.token)]\n    })\n\n    return (this.profile = profile)\n  }\n\n  /**\n   * @returns {Promise<{}>}\n   */\n  async loadUserInfo () {\n    const url = this.endpoints.userinfo()\n    /** @type {{}} */\n    const userInfo = await fetchJSON(url, {\n      headers: [buildAuthorizationHeader(this.token)]\n    })\n\n    return (this.userInfo = userInfo)\n  }\n\n  /**\n   * @param {number} [minValidity]\n   * @returns {boolean}\n   */\n  isTokenExpired (minValidity) {\n    if (!this.tokenParsed || (!this.refreshToken && this.flow !== 'implicit')) {\n      throw new Error('Not authenticated')\n    }\n\n    if (this.timeSkew == null) {\n      this.#logInfo('[KEYCLOAK] Unable to determine if token is expired as timeskew is not set')\n      return true\n    }\n\n    if (typeof this.tokenParsed.exp !== 'number') {\n      return false\n    }\n\n    let expiresIn = this.tokenParsed.exp - Math.ceil(new Date().getTime() / 1000) + this.timeSkew\n    if (minValidity) {\n      if (isNaN(minValidity)) {\n        throw new Error('Invalid minValidity')\n      }\n      expiresIn -= minValidity\n    }\n    return expiresIn < 0\n  }\n\n  /**\n   * @param {number} minValidity\n   * @returns {Promise<boolean>}\n   */\n  async updateToken (minValidity) {\n    if (!this.refreshToken) {\n      throw new Error('Unable to update token, no refresh token available.')\n    }\n\n    minValidity = minValidity || 5\n\n    if (this.#loginIframe.enable) {\n      await this.#checkLoginIframe()\n    }\n\n    let refreshToken = false\n\n    if (minValidity === -1) {\n      refreshToken = true\n      this.#logInfo('[KEYCLOAK] Refreshing token: forced refresh')\n    } else if (!this.tokenParsed || this.isTokenExpired(minValidity)) {\n      refreshToken = true\n      this.#logInfo('[KEYCLOAK] Refreshing token: token expired')\n    }\n\n    if (!refreshToken) {\n      return false\n    }\n\n    /** @type {PromiseWithResolvers<boolean>} */\n    const { promise, resolve, reject } = Promise.withResolvers()\n\n    this.#refreshQueue.push({ resolve, reject })\n\n    if (this.#refreshQueue.length === 1) {\n      const url = this.endpoints.token()\n      let timeLocal = new Date().getTime()\n\n      try {\n        const response = await fetchRefreshToken(url, this.refreshToken, /** @type {string} */ (this.clientId))\n        this.#logInfo('[KEYCLOAK] Token refreshed')\n\n        timeLocal = (timeLocal + new Date().getTime()) / 2\n\n        this.#setToken(response.access_token, response.refresh_token, response.id_token, timeLocal)\n\n        this.onAuthRefreshSuccess?.()\n        for (let p = this.#refreshQueue.pop(); p != null; p = this.#refreshQueue.pop()) {\n          p.resolve(true)\n        }\n      } catch (error) {\n        this.#logWarn('[KEYCLOAK] Failed to refresh token')\n\n        if (error instanceof NetworkError && error.response.status === 400) {\n          this.clearToken()\n        }\n\n        this.onAuthRefreshError?.()\n        for (let p = this.#refreshQueue.pop(); p != null; p = this.#refreshQueue.pop()) {\n          p.reject(error)\n        }\n      }\n    }\n\n    return await promise\n  }\n\n  clearToken () {\n    if (this.token) {\n      this.#setToken()\n      this.onAuthLogout?.()\n      if (this.loginRequired) {\n        this.login()\n      }\n    }\n  }\n\n  /**\n   * @param {string} [token]\n   * @param {string} [refreshToken]\n   * @param {string} [idToken]\n   * @param {number} [timeLocal]\n   */\n  #setToken (token, refreshToken, idToken, timeLocal) {\n    if (this.tokenTimeoutHandle) {\n      clearTimeout(this.tokenTimeoutHandle)\n      this.tokenTimeoutHandle = undefined\n    }\n\n    if (refreshToken) {\n      this.refreshToken = refreshToken\n      this.refreshTokenParsed = decodeToken(refreshToken)\n    } else {\n      delete this.refreshToken\n      delete this.refreshTokenParsed\n    }\n\n    if (idToken) {\n      this.idToken = idToken\n      this.idTokenParsed = decodeToken(idToken)\n    } else {\n      delete this.idToken\n      delete this.idTokenParsed\n    }\n\n    if (token) {\n      this.token = token\n      this.tokenParsed = decodeToken(token)\n      this.sessionId = this.tokenParsed.sid\n      this.authenticated = true\n      this.subject = this.tokenParsed.sub\n      this.realmAccess = this.tokenParsed.realm_access\n      this.resourceAccess = this.tokenParsed.resource_access\n\n      if (timeLocal) {\n        this.timeSkew = Math.floor(timeLocal / 1000) - this.tokenParsed.iat\n      }\n\n      if (this.timeSkew !== null) {\n        this.#logInfo('[KEYCLOAK] Estimated time difference between browser and server is ' + this.timeSkew + ' seconds')\n\n        if (this.onTokenExpired) {\n          const expiresIn = (this.tokenParsed.exp - (new Date().getTime() / 1000) + this.timeSkew) * 1000\n          this.#logInfo('[KEYCLOAK] Token expires in ' + Math.round(expiresIn / 1000) + ' s')\n          if (expiresIn <= 0) {\n            this.onTokenExpired()\n          } else {\n            this.tokenTimeoutHandle = window.setTimeout(this.onTokenExpired, expiresIn)\n          }\n        }\n      }\n    } else {\n      delete this.token\n      delete this.tokenParsed\n      delete this.subject\n      delete this.realmAccess\n      delete this.resourceAccess\n\n      this.authenticated = false\n    }\n  }\n\n  /**\n   * @returns {string=}\n   */\n  #getRealmUrl () {\n    if (typeof this.authServerUrl === 'undefined') {\n      return\n    }\n\n    return `${stripTrailingSlash(this.authServerUrl)}/realms/${encodeURIComponent(/** @type {string} */ (this.realm))}`\n  }\n\n  /**\n   * @param {Function} fn\n   * @returns {(message: string) => void}\n   */\n  #createLogger (fn) {\n    return (message) => {\n      if (this.enableLogging) {\n        fn.call(console, message)\n      }\n    }\n  }\n}\n\n/**\n * @returns {string}\n */\nfunction createUUID () {\n  if (typeof crypto === 'undefined' || typeof crypto.randomUUID === 'undefined') {\n    throw new Error('Web Crypto API is not available.')\n  }\n\n  return crypto.randomUUID()\n}\n\n/**\n * @param {Acr} requestedAcr\n * @returns {string}\n */\nfunction buildClaimsParameter (requestedAcr) {\n  return JSON.stringify({\n    id_token: {\n      acr: requestedAcr\n    }\n  })\n}\n\n/**\n * @param {number} len\n * @returns {string}\n */\nfunction generateCodeVerifier (len) {\n  return generateRandomString(len, 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789')\n}\n\n/**\n * @param {string} pkceMethod\n * @param {string} codeVerifier\n * @returns {Promise<string>}\n */\nasync function generatePkceChallenge (pkceMethod, codeVerifier) {\n  if (pkceMethod !== 'S256') {\n    throw new TypeError(`Invalid value for 'pkceMethod', expected 'S256' but got '${pkceMethod}'.`)\n  }\n\n  // hash codeVerifier, then encode as url-safe base64 without padding\n  const hashBytes = new Uint8Array(await sha256Digest(codeVerifier))\n  const encodedHash = bytesToBase64(hashBytes)\n    .replace(/\\+/g, '-')\n    .replace(/\\//g, '_')\n    .replace(/=/g, '')\n\n  return encodedHash\n}\n\n/**\n * @param {number} len\n * @param {string} alphabet\n * @returns {string}\n */\nfunction generateRandomString (len, alphabet) {\n  const randomData = generateRandomData(len)\n  const chars = new Array(len)\n  for (let i = 0; i < len; i++) {\n    chars[i] = alphabet.charCodeAt(randomData[i] % alphabet.length)\n  }\n  return String.fromCharCode.apply(null, chars)\n}\n\n/**\n * @param {number} len\n * @returns {Uint8Array<ArrayBuffer>}\n */\nfunction generateRandomData (len) {\n  if (typeof crypto === 'undefined' || typeof crypto.getRandomValues === 'undefined') {\n    throw new Error('Web Crypto API is not available.')\n  }\n\n  return crypto.getRandomValues(new Uint8Array(len))\n}\n\n/**\n * Function to extend existing native Promise with timeout\n *\n * @template T\n * @param {Promise<T>} promise\n * @param {number} timeout\n * @param {string} errorMessage\n * @returns {Promise<T>}\n */\nfunction applyTimeoutToPromise (promise, timeout, errorMessage) {\n  /** @type {number} */\n  let timeoutHandle\n  const timeoutPromise = new Promise(function (resolve, reject) {\n    timeoutHandle = window.setTimeout(function () {\n      reject(new Error(errorMessage || 'Promise is not settled within timeout of ' + timeout + 'ms'))\n    }, timeout)\n  })\n\n  return Promise.race([promise, timeoutPromise]).finally(function () {\n    clearTimeout(timeoutHandle)\n  })\n}\n\n/**\n * @returns {CallbackStorage}\n */\nfunction createCallbackStorage () {\n  try {\n    return new LocalStorage()\n  } catch (err) {\n    return new CookieStorage()\n  }\n}\n\nconst STORAGE_KEY_PREFIX = 'kc-callback-'\n\n/**\n * @typedef {Object} CallbackState\n * @property {string} state\n * @property {string} nonce\n * @property {string} redirectUri\n * @property {KeycloakLoginOptions} [loginOptions]\n * @property {KeycloakLoginOptions['prompt']} [prompt]\n * @property {string} [pkceCodeVerifier]\n */\n\n/**\n * @typedef {Object} CallbackStorage\n * @property {(state?: string) => CallbackState | null} get\n * @property {(state: CallbackState) => void} add\n */\n\n/**\n * @implements {CallbackStorage}\n */\nclass LocalStorage {\n  constructor () {\n    globalThis.localStorage.setItem('kc-test', 'test')\n    globalThis.localStorage.removeItem('kc-test')\n  }\n\n  /**\n   * @param {string} [state]\n   * @returns {CallbackState | null}\n   */\n  get (state) {\n    if (!state) {\n      return null\n    }\n\n    this.#clearInvalidValues()\n\n    const key = STORAGE_KEY_PREFIX + state\n    const value = globalThis.localStorage.getItem(key)\n\n    if (value) {\n      globalThis.localStorage.removeItem(key)\n      return JSON.parse(value)\n    }\n\n    return null\n  };\n\n  /**\n   * @param {CallbackState} state\n   */\n  add (state) {\n    this.#clearInvalidValues()\n\n    const key = STORAGE_KEY_PREFIX + state.state\n    const value = JSON.stringify({\n      ...state,\n      // Set the expiry time to 1 hour from now.\n      expires: Date.now() + (60 * 60 * 1000)\n    })\n\n    try {\n      globalThis.localStorage.setItem(key, value)\n    } catch (error) {\n      // If the storage is full, clear all known values and try again.\n      this.#clearAllValues()\n      globalThis.localStorage.setItem(key, value)\n    }\n  };\n\n  /**\n   * Clears all values from local storage that are no longer valid.\n   */\n  #clearInvalidValues () {\n    const currentTime = Date.now()\n\n    for (const [key, value] of this.#getStoredEntries()) {\n      // Attempt to parse the expiry time from the value.\n      const expiry = this.#parseExpiry(value)\n\n      // Discard the value if it is malformed or expired.\n      if (expiry === null || expiry < currentTime) {\n        globalThis.localStorage.removeItem(key)\n      }\n    }\n  }\n\n  /**\n   * Clears all known values from local storage.\n   */\n  #clearAllValues () {\n    for (const [key] of this.#getStoredEntries()) {\n      globalThis.localStorage.removeItem(key)\n    }\n  }\n\n  /**\n   * Gets all entries stored in local storage that are known to be managed by this class.\n   * @returns {[string, string][]} An array of key-value pairs.\n   */\n  #getStoredEntries () {\n    return Object.entries(globalThis.localStorage).filter(([key]) => key.startsWith(STORAGE_KEY_PREFIX))\n  }\n\n  /**\n   * Parses the expiry time from a value stored in local storage.\n   * @param {string} value\n   * @returns {number | null} The expiry time in milliseconds, or `null` if the value is malformed.\n   */\n  #parseExpiry (value) {\n    let parsedValue\n\n    // Attempt to parse the value as JSON.\n    try {\n      parsedValue = JSON.parse(value)\n    } catch (error) {\n      return null\n    }\n\n    // Attempt to extract the 'expires' property.\n    if (isObject(parsedValue) && 'expires' in parsedValue && typeof parsedValue.expires === 'number') {\n      return parsedValue.expires\n    }\n\n    return null\n  }\n}\n\n/**\n * @implements {CallbackStorage}\n */\nclass CookieStorage {\n  /**\n   * @param {string} [state]\n   * @returns {CallbackState | null}\n   */\n  get (state) {\n    if (!state) {\n      return null\n    }\n\n    const value = this.#getCookie(STORAGE_KEY_PREFIX + state)\n    this.#setCookie(STORAGE_KEY_PREFIX + state, '', this.#cookieExpiration(-100))\n    if (value) {\n      return JSON.parse(value)\n    }\n\n    return null\n  }\n\n  /**\n   * @param {CallbackState} state\n   */\n  add (state) {\n    this.#setCookie(STORAGE_KEY_PREFIX + state.state, JSON.stringify(state), this.#cookieExpiration(60))\n  }\n\n  /**\n   * @param {string} key\n   * @returns\n   */\n  #getCookie (key) {\n    const name = key + '='\n    const ca = document.cookie.split(';')\n    for (let i = 0; i < ca.length; i++) {\n      let c = ca[i]\n      while (c.charAt(0) === ' ') {\n        c = c.substring(1)\n      }\n      if (c.indexOf(name) === 0) {\n        return c.substring(name.length, c.length)\n      }\n    }\n    return ''\n  }\n\n  /**\n   * @param {string} key\n   * @param {string} value\n   * @param {Date} expirationDate\n   */\n  #setCookie (key, value, expirationDate) {\n    const cookie = key + '=' + value + '; ' +\n            'expires=' + expirationDate.toUTCString() + '; '\n    document.cookie = cookie\n  }\n\n  /**\n   * @param {number} minutes\n   * @returns {Date}\n   */\n  #cookieExpiration (minutes) {\n    const exp = new Date()\n    exp.setTime(exp.getTime() + (minutes * 60 * 1000))\n    return exp\n  }\n}\n\n/**\n * @param {Uint8Array<ArrayBuffer>} bytes\n * @see https://developer.mozilla.org/en-US/docs/Glossary/Base64#the_unicode_problem\n */\nfunction bytesToBase64 (bytes) {\n  const binString = String.fromCodePoint(...bytes)\n  return btoa(binString)\n}\n\n/**\n * @param {string} message\n * @see https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/digest#basic_example\n */\nasync function sha256Digest (message) {\n  const encoder = new TextEncoder()\n  const data = encoder.encode(message)\n\n  if (typeof crypto === 'undefined' || typeof crypto.subtle === 'undefined') {\n    throw new Error('Web Crypto API is not available.')\n  }\n\n  return await crypto.subtle.digest('SHA-256', data)\n}\n\n/**\n * @param {string} token\n * @returns {KeycloakTokenParsed}\n */\nfunction decodeToken (token) {\n  const [, payload] = token.split('.')\n\n  if (typeof payload !== 'string') {\n    throw new Error('Unable to decode token, payload not found.')\n  }\n\n  let decoded\n\n  try {\n    decoded = base64UrlDecode(payload)\n  } catch (error) {\n    throw new Error('Unable to decode token, payload is not a valid Base64URL value.', { cause: error })\n  }\n\n  try {\n    return JSON.parse(decoded)\n  } catch (error) {\n    throw new Error('Unable to decode token, payload is not a valid JSON value.', { cause: error })\n  }\n}\n\n/**\n * @param {string} input\n */\nfunction base64UrlDecode (input) {\n  let output = input\n    .replaceAll('-', '+')\n    .replaceAll('_', '/')\n\n  switch (output.length % 4) {\n    case 0:\n      break\n    case 2:\n      output += '=='\n      break\n    case 3:\n      output += '='\n      break\n    default:\n      throw new Error('Input is not of the correct length.')\n  }\n\n  try {\n    return b64DecodeUnicode(output)\n  } catch (error) {\n    return atob(output)\n  }\n}\n\n/**\n * @param {string} input\n */\nfunction b64DecodeUnicode (input) {\n  return decodeURIComponent(atob(input).replace(/(.)/g, (m, p) => {\n    let code = p.charCodeAt(0).toString(16).toUpperCase()\n\n    if (code.length < 2) {\n      code = '0' + code\n    }\n\n    return '%' + code\n  }))\n}\n\n/**\n * Check if the input is an object that can be operated on.\n * @param {unknown} input\n */\nfunction isObject (input) {\n  return typeof input === 'object' && input !== null\n}\n\n/**\n * @typedef {Object} JsonConfig The JSON version of the adapter configuration.\n * @property {string} auth-server-url The URL of the authentication server.\n * @property {string} realm The name of the realm.\n * @property {string} resource The name of the resource, usually the client ID.\n */\n\n/**\n * Fetch the adapter configuration from the given URL.\n * @param {string} url\n * @returns {Promise<JsonConfig>}\n */\nasync function fetchJsonConfig (url) {\n  return await fetchJSON(url)\n}\n\n/**\n * Fetch the OpenID configuration from the given URL.\n * @param {string} url\n * @returns {Promise<OpenIdProviderMetadata>}\n */\nasync function fetchOpenIdConfig (url) {\n  return await fetchJSON(url)\n}\n\n/**\n * @typedef {Object} AccessTokenResponse The successful token response from the authorization server, based on the {@link https://datatracker.ietf.org/doc/html/rfc6749#section-5.1 OAuth 2.0 Authorization Framework specification}.\n * @property {string} access_token The access token issued by the authorization server.\n * @property {string} token_type The type of the token issued by the authorization server.\n * @property {number} [expires_in] The lifetime in seconds of the access token.\n * @property {string} [refresh_token] The refresh token issued by the authorization server.\n * @property {string} [id_token] The ID token issued by the authorization server, if requested.\n * @property {string} [scope] The scope of the access token.\n */\n\n/**\n * Fetch the access token from the given URL.\n * @param {string} url\n * @param {string} code\n * @param {string} clientId\n * @param {string} redirectUri\n * @param {string} [pkceCodeVerifier]\n * @returns {Promise<AccessTokenResponse>}\n */\nasync function fetchAccessToken (url, code, clientId, redirectUri, pkceCodeVerifier) {\n  const body = new URLSearchParams([\n    ['code', code],\n    ['grant_type', 'authorization_code'],\n    ['client_id', clientId],\n    ['redirect_uri', stripHash(redirectUri)]\n  ])\n\n  if (pkceCodeVerifier) {\n    body.append('code_verifier', pkceCodeVerifier)\n  }\n\n  return await fetchJSON(url, {\n    method: 'POST',\n    credentials: 'include',\n    body\n  })\n}\n\n/**\n * Fetch the refresh token from the given URL.\n * @param {string} url\n * @param {string} refreshToken\n * @param {string} clientId\n * @returns {Promise<AccessTokenResponse>}\n */\nasync function fetchRefreshToken (url, refreshToken, clientId) {\n  const body = new URLSearchParams([\n    ['grant_type', 'refresh_token'],\n    ['refresh_token', refreshToken],\n    ['client_id', clientId]\n  ])\n\n  return await fetchJSON(url, {\n    method: 'POST',\n    credentials: 'include',\n    body\n  })\n}\n\n/**\n * @template [T=unknown]\n * @param {string} url\n * @param {RequestInit} init\n * @returns {Promise<T>}\n */\nasync function fetchJSON (url, init = {}) {\n  const headers = new Headers(init.headers)\n  headers.set('Accept', CONTENT_TYPE_JSON)\n\n  const response = await fetchWithErrorHandling(url, {\n    ...init,\n    headers\n  })\n\n  return await response.json()\n}\n\n/**\n * @param {string} url\n * @param {RequestInit} [init]\n * @returns {Promise<Response>}\n */\nasync function fetchWithErrorHandling (url, init) {\n  const response = await fetch(url, init)\n\n  if (!response.ok) {\n    throw new NetworkError('Server responded with an invalid status.', { response })\n  }\n\n  return response\n}\n\n/**\n * @param {string} [token]\n * @returns {[string, string]}\n */\nfunction buildAuthorizationHeader (token) {\n  if (!token) {\n    throw new Error('Unable to build authorization header, token is not set, make sure the user is authenticated.')\n  }\n\n  return ['Authorization', `bearer ${token}`]\n}\n\n/**\n * @param {string} url\n * @returns {string}\n */\nfunction stripTrailingSlash (url) {\n  return url.endsWith('/') ? url.slice(0, -1) : url\n}\n\n/**\n * @param {string} url\n * @returns {string}\n */\nfunction stripHash (url) {\n  const parsedUrl = new URL(url)\n  parsedUrl.hash = ''\n  return parsedUrl.toString()\n}\n\n/**\n * @typedef {Object} NetworkErrorOptionsProperties\n * @property {Response} response\n * @typedef {ErrorOptions & NetworkErrorOptionsProperties} NetworkErrorOptions\n */\n\nexport class NetworkError extends Error {\n  /** @type {Response} */\n  response\n\n  /**\n   * @param {string} message\n   * @param {NetworkErrorOptions} options\n   */\n  constructor (message, options) {\n    super(message, options)\n    this.response = options.response\n  }\n}\n\n/**\n * @param {number} delay\n * @returns {Promise<void>}\n */\nconst waitForTimeout = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n", "// SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport { kc } from \"../auth.js\";\n\n\nexport class API3 {\n\n\tstatic async call(action: string, json: any)\n\t{\n\t\tconst params = new URLSearchParams();\n\t\tparams.append('action', action);\n\t\tparams.append('filter_byexample', JSON.stringify(json));\n\t\tconst current_role = sessionStorage.getItem('used_key_role');\n\t\tparams.append('current_role', current_role!);\n\n\t\tconst access_token = kc.token;\n\t\tconst headers: HeadersInit = access_token ? { Authorization: `Bearer ${access_token}` } : {};\n\n\t\tconst resp = await fetch('api?' + params.toString(), { headers });\n\t\tconst respjson = await resp.json();\n\t\treturn respjson;\n\t}\n\n\t// begin crudl methods\n\n\tstatic async list__catchsolve_noiodh__test_dataset_max_ts_vw\n\t(filter: catchsolve_noiodh__test_dataset_max_ts_vw__byexample):\n\t Promise<catchsolve_noiodh__test_dataset_max_ts_vw__row[]>\n\t{\n\t\tconst resp = await API3.call('catchsolve_noiodh.catchsolve_noiodh__test_dataset_max_ts_vw', filter)\n\t\treturn resp;\n\t}\n\n\tstatic async list__catchsolve_noiodh__custom_dashboards\n\t(filter: catchsolve_noiodh__custom_dashboards__byexample):\n\t Promise<catchsolve_noiodh__custom_dashboards__row[]>\n\t{\n\t\tconst resp = await API3.call('catchsolve_noiodh.custom_dashboards', filter)\n\t\treturn resp;\n\t}\n\n\tstatic async get__catchsolve_noiodh__custom_dashboards_next_id():\n\t Promise<number>\n\t{\n\t\tconst resp = await API3.call('catchsolve_noiodh.custom_dashboards_next_id', {})\n\t\treturn resp[0]?.id ?? NaN;\n\t}\n\t\n\tstatic async list__catchsolve_noiodh__test_dataset_check_category_failed_recors_vw\n\t(filter: catchsolve_noiodh__test_dataset_check_category_failed_recors_vw__byexample):\n\t Promise<catchsolve_noiodh__test_dataset_check_category_failed_recors_vw__row[]>\n\t{\n\t\tconst resp = await API3.call('catchsolve_noiodh.test_dataset_check_category_failed_recors_vw', filter)\n\t\treturn resp;\n\t}\n\t\n\tstatic async list__catchsolve_noiodh__test_dataset_check_category_check_name_failed_recors_vw\n\t(filter: catchsolve_noiodh__test_dataset_check_category_check_name_failed_recors_vw__byexample):\n\t Promise<catchsolve_noiodh__test_dataset_check_category_check_name_failed_recors_vw__row[]>\n\t{\n\t\tconst resp = await API3.call('catchsolve_noiodh.test_dataset_check_category_check_name_failed_recors_vw', filter)\n\t\treturn resp;\n\t}\n\t\n\tstatic async list__catchsolve_noiodh__test_dataset_check_category_check_name_record_record_failed_vw\n\t(filter: catchsolve_noiodh__test_dataset_check_category_check_name_record_record_failed_vw__byexample):\n\t Promise<catchsolve_noiodh__test_dataset_check_category_check_name_record_record_failed_vw__row[]>\n\t{\n\t\tconst resp = await API3.call('catchsolve_noiodh.test_dataset_check_category_check_name_record_record_failed_vw', filter)\n\t\treturn resp;\n\t}\n\t\n\tstatic async list__catchsolve_noiodh__test_dataset_record_check_failed\n\t(filter: catchsolve_noiodh__test_dataset_record_check_failed__byexample):\n\t Promise<catchsolve_noiodh__test_dataset_record_check_failed__row[]>\n\t{\n\t\tconst resp = await API3.call('catchsolve_noiodh.test_dataset_record_check_failed', filter)\n\t\treturn resp;\n\t}\n\n\tstatic async list__catchsolve_noiodh__test_dataset_check_category_record_jsonpath_failed_vw\n\t(filter: catchsolve_noiodh__test_dataset_check_category_record_jsonpath_failed_vw__byexample):\n\t Promise<catchsolve_noiodh__test_dataset_check_category_record_jsonpath_failed_vw__row[]>\n\t{\n\t\tconst resp = await API3.call('catchsolve_noiodh.test_dataset_check_category_record_jsonpath_failed_vw', filter)\n\t\treturn resp;\n\t}\n\n\tstatic async list__catchsolve_noiodh__test_dataset_history_vw\n\t(filter: catchsolve_noiodh__test_dataset_history_vw__byexample):\n\t Promise<catchsolve_noiodh__test_dataset_history_vw__row[]>\n\t{\n\t\tconst resp = await API3.call('catchsolve_noiodh.test_dataset_history_vw', filter)\n\t\treturn resp;\n\t}\n\t\n\t// end crudl methods\n\n\tstatic async get_auth_user_roles(): Promise<string[]>\n\t{\n\t\tconst resp = await API3.call('auth_roles', {})\n\t\treturn resp;\n\t}\n\n\n\n}\n\n// begin interfaces\n\nexport interface catchsolve_noiodh__test_dataset__row {\n\tdataset_img_url: string\n\tdataset_name: string\n\tid: number\n\tsession_start_ts: string\n\ttested_records: number\n}\n\nexport interface catchsolve_noiodh__test_dataset_check__row {\n\tcheck_name: string\n\tdataset_name: string\n\tid: number\n\tsession_start_ts: string\n}\n\nexport interface catchsolve_noiodh__test_dataset_check_category_check_name_failed_recors_vw__row {\n\tcheck_category: string\n\tcheck_name: string\n\tdataset_name: string\n\tfailed_records: number\n\tsession_start_ts: string\n\ttot_records: number\n}\n\nexport interface catchsolve_noiodh__test_dataset_check_category_check_name_record_record_failed_vw__row {\n\tcheck_category: string\n\tcheck_name: string\n\tdataset_name: string\n\tnr_records: number\n\tsession_start_ts: string\n}\n\nexport interface catchsolve_noiodh__test_dataset_check_category_failed_recors_vw__row {\n\tcheck_category: string\n\tdataset_name: string\n\tfailed_records: number\n\tsession_start_ts: string\n\ttot_records: number\n}\n\nexport interface catchsolve_noiodh__test_dataset_check_category_record_jsonpath_failed_vw__row {\n\tcheck_category: string\n\tdataset_name: string\n\tnr_check_names: number\n\trecord_json: string\n\trecord_jsonpath: string\n\tsession_start_ts: string\n}\n\nexport interface catchsolve_noiodh__test_dataset_history_vw__row {\n\tcheck_category: string\n\tcheck_stats: string\n\tdataset_name: string\n\tsession_start_ts: string\n}\n\nexport interface catchsolve_noiodh__test_dataset_max_ts_vw__row {\n\tdataset_img_url: string\n\tdataset_name: string\n\tfailed_records: number\n\tsession_start_ts: string\n\ttested_records: number\n}\n\nexport interface catchsolve_noiodh__custom_dashboards__row {\n\tid: number\n\tname: string\n\ttest_definition_json: string\n\tuser_id: string\n\tuser_role: string\n}\n\nexport interface catchsolve_noiodh__custom_dashboards_next_id__row {\n\tid: number\n}\n\nexport interface catchsolve_noiodh__test_dataset_record_check_failed__row {\n\tcheck_category: string\n\tcheck_name: string\n\tdataset_name: string\n\tid: number\n\timpacted_attributes_csv: string\n\tproblem_hint: string\n\trecord_json: string\n\trecord_jsonpath: string\n\tsession_start_ts: string\n}\n\nexport interface catchsolve_noiodh__test_dataset__byexample {\n\tdataset_img_url?: string\n\tdataset_name?: string\n\tid?: number\n\tsession_start_ts?: string\n\ttested_records?: number\n}\n\nexport interface catchsolve_noiodh__test_dataset_check__byexample {\n\tcheck_name?: string\n\tdataset_name?: string\n\tid?: number\n\tsession_start_ts?: string\n}\n\nexport interface catchsolve_noiodh__test_dataset_check_category_check_name_failed_recors_vw__byexample {\n\tcheck_category?: string\n\tcheck_name?: string\n\tdataset_name?: string\n\tfailed_records?: number\n\tsession_start_ts?: string\n\ttot_records?: number\n}\n\nexport interface catchsolve_noiodh__test_dataset_check_category_check_name_record_record_failed_vw__byexample {\n\tcheck_category?: string\n\tcheck_name?: string\n\tdataset_name?: string\n\tnr_records?: number\n\tsession_start_ts?: string\n}\n\nexport interface catchsolve_noiodh__test_dataset_check_category_failed_recors_vw__byexample {\n\tcheck_category?: string\n\tdataset_name?: string\n\tfailed_records?: number\n\tsession_start_ts?: string\n\ttot_records?: number\n}\n\nexport interface catchsolve_noiodh__test_dataset_check_category_record_jsonpath_failed_vw__byexample {\n\tcheck_category?: string\n\tdataset_name?: string\n\tnr_check_names?: number\n\trecord_json?: string\n\trecord_jsonpath?: string\n\tsession_start_ts?: string\n\toffset?: number\n\tlimit? : number\n}\n\nexport interface catchsolve_noiodh__test_dataset_history_vw__byexample {\n\tcheck_category?: string\n\tcheck_stats?: string\n\tdataset_name?: string\n\tsession_start_ts?: string\n}\n\nexport interface catchsolve_noiodh__test_dataset_max_ts_vw__byexample {\n\tdataset_img_url?: string\n\tdataset_name?: string\n\tfailed_records?: number\n\tsession_start_ts?: string\n\ttested_records?: number\n\tused_key?: string\n}\n\nexport interface catchsolve_noiodh__custom_dashboards__byexample {\n\tid?: number\n\tname?: string\n\ttest_definition_json?: string\n\tuser_id?: string\n\tuser_role?: string\n}\n\nexport interface catchsolve_noiodh__test_dataset_record_check_failed__byexample {\n\tcheck_category?: string\n\tcheck_name?: string\n\tdataset_name?: string\n\tid?: number\n\timpacted_attributes_csv?: string\n\tproblem_hint?: string\n\trecord_json?: string\n\trecord_jsonpath?: string\n\tsession_start_ts?: string\n\toffset?: number\n\tlimit? : number\n}\n\n// end interfaces\n", "// SPDX-FileCopyrightText: 2025 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\n// Configuration module for environment variables used in the frontend.\n// Vite exposes variables prefixed with VITE_ via import.meta.env.\n// This file provides typed constants with sensible defaults.\n\n// Vite does not provide typings for `import.meta.env` out of the box. We cast to `any` to avoid\n// TypeScript errors while still allowing the values to be injected at build time.\nconst env = (import.meta as any).env ?? {};\n\nexport const KEYCLOAK_URL = (env.VITE_KEYCLOAK_URL as string) ?? \"https://auth.opendatahub.com/auth/\";\nexport const KEYCLOAK_REALM = (env.VITE_KEYCLOAK_REALM as string) ?? \"noi\";\n\nexport const TOURISM_API_BASE = (env.VITE_TOURISM_API_BASE as string) ?? \"https://tourism.api.opendatahub.com\";\nexport const MOBILITY_API_BASE = (env.VITE_MOBILITY_API_BASE as string) ?? \"https://mobility.api.opendatahub.com\";\n// Base URL for the backend API. In development the Vite proxy will forward requests, but the\n// environment variable allows overriding the target (e.g., when deploying).\nexport const API_BASE = (env.VITE_API_BASE as string) ?? \"\";\n\n// Additional configuration variables can be added here following the same pattern.\n", "// SPDX-FileCopyrightText: 2025 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport Keycloak from 'keycloak-js';\nimport { jwtDecode } from 'jwt-decode';\nimport { API3 } from './api/api3.js';\nimport { KEYCLOAK_URL, KEYCLOAK_REALM } from './config.js';\n\n// https://www.keycloak.org/securing-apps/javascript-adapter\n\nexport const kc = new Keycloak({\n    url: KEYCLOAK_URL,\n    realm: KEYCLOAK_REALM,\n    clientId: \"odh-data-quality-web\",\n});\n\nexport async function initAuth() {\n\n    const roleKey = 'used_key_role';\n    await kc.init({\n        onLoad: 'check-sso',\n        // avoid full reload of page with check-sso & spa\n        silentCheckSsoRedirectUri: `${location.origin}/silent-check-sso.html`,\n    });\n\n    if (!kc.authenticated) {\n        sessionStorage.setItem(roleKey, 'opendata');\n    } else {\n        const roles = await API3.get_auth_user_roles();\n        if (roles.length > 0) {\n            const currentRole = sessionStorage.getItem(roleKey);\n            if (!currentRole || !roles.includes(currentRole)) {\n                sessionStorage.setItem(roleKey, roles[0]);\n            }\n        } else {\n            sessionStorage.setItem(roleKey, 'opendata');\n        }\n    }\n    \n}\n", "// SPDX-FileCopyrightText: 2025 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nexport class CommonWebComponent extends HTMLElement {\n\n    sroot: ShadowRoot\n\n    constructor(html: string = '') {\n        super()\n        this.setAttribute('data-component-name', this.constructor.name)\n        this.sroot = this.attachShadow({ mode: 'open' })\n        this.sroot.innerHTML = html\n        customElements.upgrade(this.sroot)\n    }\n\n    querySelector(q: string): HTMLElement {\n        const e = this.sroot.querySelector(q)\n        if (e === null)\n            throw new Error();\n        if (!(e instanceof HTMLElement))\n            throw new Error();\n        return e\n    }\n\n}\n", "<!--\n  SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n\n  SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<link rel=\"stylesheet\" href=\"loader.css\">\n<style>\n    :host {\n        width: 65px;\n        height: 15px;\n        display: inline-block;\n        overflow: hidden;\n        margin: 2rem;\n    }\n\n    div.loader {\n        color: #222;\n    }\n</style>\n<div class=\"loader\" style=\"margin-top: 0px; margin-left:20px\"></div>\n", "// SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport { CommonWebComponent } from \"./CommonWebComponent.js\";\nimport template from './Loader.html?raw'\n\nexport class Loader extends CommonWebComponent\n{\n\tconstructor() {\n\t\tsuper(template)\n\t}\n\t\n}\n\ncustomElements.define('cs-loader', Loader)\n", "// SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nexport function throwNPE(): never {\n\tthrow new Error('unexpected null or undefined value')\n}\n\n// use this function instead of <Class> to add runtime checking\nexport function cs_cast<T extends object>(tc: { new(...args: any): T }, x: any): T\n{\n\tif (x === undefined)\n\t\tthrow new Error('runtime cast: x is undefined instead of ' + tc.name);\n\tif (x === null)\n\t\tthrow new Error('runtime cast: x is null instead of ' + tc.name);\n\tif (typeof x !== 'object')\n\t\tthrow new Error('runtime cast: this function check only objects <T extends object>, instead of ' + (typeof x));\n\tif (!(x instanceof tc))\n\t\tthrow new Error('runtime cast: x with type: ' + x.constructor.name + ' does not match required type: ' + tc.name);\t\n\treturn x\n}\n\nexport function cs_notnull<T>(x: T|null): T\n{\n\tif (x === null)\n\t\tthrow new Error('unexpected null value');\n\treturn x\n}", "<!--\n  SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n\n  SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<style>\n    @import url(\"all-webcomponent.css\");\n\n\t@import url(\"anywhere.css\");\n\n\t:host {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 0.5rem;\n\t\tbox-sizing: border-box;\n\t}\n\n\t.title {\n\t\tpadding: 0.5rem 0.4rem;\n\t\tfont-weight: 600;\n\t\tfont-size: 0.75rem;\n\t\tletter-spacing: 0.06em;\n\t\ttext-transform: uppercase;\n\t\tcolor: #111111;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 0.5rem;\n\t}\n\n\tdiv.submenus {\n\t\tpadding-left: 0;\n\t\toverflow: auto;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 0.25rem;\n\t}\n\n\tdiv.submenus_custom {\n\t\tpadding-left: 0;\n\t\toverflow: auto;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 0.25rem;\n\t}\n\n\n\n\tdiv.submenus > * {\n\t\tmargin: 0;\n\t\tmargin-left: 1rem;\n\t\tpadding: 0.35rem 0.5rem;\n\t\tcursor: pointer;\n\t\tborder-radius: 6px;\n\t\tline-height: 1.3;\n\t}\n\tdiv.submenus > *:hover {\n\t\tbackground: #e5e7eb;\n\t}\n\tdiv.submenus_custom > .flex-row {\n\t\talign-items: center;\n\t\tgap: 0.35rem;\n\t\tmargin-left: 1rem;\n\t\tpadding: 0.35rem 0.5rem;\n\t\tborder-radius: 6px;\n\t\tcursor: pointer;\n\t}\n\tdiv.submenus_custom > .flex-row:hover {\n\t\tbackground: #e5e7eb;\n\t}\n\t.selected {\n\t\tbackground: #e5e7eb;\n\t\tcolor: #111111;\n\t\tfont-weight: 600;\n\t}\n\t.title.standard-title.close ~ .submenus {\n\t\tdisplay: none;\n\t}\n\t.title.custom-title.close ~ .submenus_custom {\n\t\tdisplay: none;\n\t}\n\t.openclose {\n\t\tcursor: pointer;\n\t\tcolor: var(--events-tertiary);\n\t}\n\t.openclose:before {\n\t\tcontent: \"\";\n\t\tdisplay: inline-block;\n\t\twidth: 0.8rem;\n\t\theight: 0.8rem;\n\t\tbackground-color: var(--events-tertiary);\n\t\t-webkit-mask: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12'%3E%3Cpath d='M2 4l4 4 4-4' fill='none' stroke='%23000' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E\") center / contain no-repeat;\n\t\tmask: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12'%3E%3Cpath d='M2 4l4 4 4-4' fill='none' stroke='%23000' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E\") center / contain no-repeat;\n\t\ttransform: rotate(180deg);\n\t}\n\t.title.close .openclose:before {\n\t\ttransform: rotate(0deg);\n\t}\n\t.newbutton {\n\t\twidth: 1.8rem;\n\t\theight: 1.8rem;\n\t\tborder: 1px solid #111111;\n\t\tbackground: #111111;\n\t\tcolor: #ffffff;\n\t\tborder-radius: 4px;\n\t\tline-height: 1;\n\t\tcursor: pointer;\n\t}\n</style>\n<div class=\"title standard-title\"><span class=\"openclose\"></span> standard dashboards</div>\n<div class=\"submenus\"></div>\n<div class=\"title custom-title flex-row flex-align-items-center gap-medium\"><span class=\"openclose\"></span><span class=\"flex-grow\">custom dashboards</span></div>\n<div class=\"submenus_custom flex-col gap-medium\"></div>\n", "// SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport { CommonWebComponent } from './CommonWebComponent.js';\nimport { Loader } from './Loader.js';\nimport {API3, catchsolve_noiodh__custom_dashboards__row} from './api/api3.js';\nimport { cs_cast } from './quality.js';\nimport template from './MenuComponent.html?raw'\n\nexport class MenuComponent extends CommonWebComponent\n{\n\tsubmenus\n\t\n\tmenuitemByName: {[k:string]: HTMLElement} = {}\n\t\n\tmenuready_promise\n\t\n\tconstructor()\n\t{\n\t\tsuper(template);\n\t\tthis.submenus = cs_cast(HTMLElement, this.sroot.querySelector('div.submenus'));\n\t\tconst submenusCustom = cs_cast(HTMLElement, this.sroot.querySelector('div.submenus_custom'));\n\t\tconst title = cs_cast(HTMLElement, this.sroot.querySelector('div.title.standard-title'))\n\t\tconst customTitle = cs_cast(HTMLElement, this.sroot.querySelector('div.title.custom-title'))\n\t\tthis.menuitemByName[''] = title\n\t\tthis.menuitemByName['custom'] = customTitle\n\n\t\tconst currentRole = sessionStorage.getItem('used_key_role') ?? 'opendata'\n\t\tconst isOpendata = currentRole === 'opendata'\n\t\tcustomTitle.classList.toggle('display-none', isOpendata)\n\t\tsubmenusCustom.classList.toggle('display-none', isOpendata)\n\t\t\n\t\ttitle.onclick = () => {\n\t\t\ttitle.classList.toggle('close')\n\t\t\tlocation.hash = ''\n\t\t}\n\t\tcustomTitle.onclick = () => {\n\t\t\tcustomTitle.classList.toggle('close')\n\t\t\tlocation.hash = '#customdataset'\n\t\t}\n\t\t\n\t\tconst openclose = cs_cast(HTMLElement, title.querySelector('span.openclose'));\n\t\topenclose.onclick = (event) => {\n\t\t\tevent.stopPropagation()\n\t\t\tconst wasClosed = title.classList.contains('close')\n\t\t\ttitle.classList.toggle('close')\n\t\t\tif (wasClosed) {\n\t\t\t\tcustomTitle.classList.add('close')\n\t\t\t} else {\n\t\t\t\tcustomTitle.classList.remove('close')\n\t\t\t}\n\t\t}\n\t\tconst opencloseCustom = cs_cast(HTMLElement, customTitle.querySelector('span.openclose'));\n\t\topencloseCustom.onclick = (event) => {\n\t\t\tevent.stopPropagation()\n\t\t\tconst wasClosed = customTitle.classList.contains('close')\n\t\t\tcustomTitle.classList.toggle('close')\n\t\t\tif (wasClosed) {\n\t\t\t\ttitle.classList.add('close')\n\t\t\t} else {\n\t\t\t\ttitle.classList.remove('close')\n\t\t\t}\n\t\t}\n\n\n\t\tlet menuready_fun: (x: null) => void\n\t\tthis.menuready_promise = new Promise(s => menuready_fun = s);\n\t\tconst json_promise = API3.list__catchsolve_noiodh__test_dataset_max_ts_vw({used_key: currentRole})\n\t\tconst custom_dashboards_promise = isOpendata\n\t\t\t? Promise.resolve([] as catchsolve_noiodh__custom_dashboards__row[])\n\t\t\t: API3.list__catchsolve_noiodh__custom_dashboards({\n\t\t\t})\n\t\tconst loader = new Loader();\n\t\tthis.sroot.appendChild(loader)\n\t\tPromise.all([json_promise, custom_dashboards_promise]).then(([json, customDashboards]) => {\n\t\t\tfor (let dataset of json)\n\t\t\t{\n\t\t\t\tconst menu1_submenu = document.createElement('div');\n\t\t\t\tmenu1_submenu.textContent = (dataset.dataset_name);\n\t\t\t\tthis.menuitemByName[dataset.dataset_name] = menu1_submenu\n\t\t\t\tthis.submenus.appendChild(menu1_submenu);\n\t\t\t\tmenu1_submenu.onclick = () => {\n\t\t\t\t\tlocation.hash = '#page=dataset-categories' +\n\t\t\t\t\t                '&dataset_name=' + dataset.dataset_name + \n\t\t\t\t\t\t\t\t\t'&session_start_ts=' + dataset.session_start_ts \n\t\t\t\t\t\t\t\t\t+ \"&failed_records=\" + dataset.failed_records\n\t\t\t\t\t\t\t\t\t+ \"&tested_records=\" + dataset.tested_records\n\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (let dashboard of customDashboards)\n\t\t\t{\n\t\t\t\tconst menuCustom = document.createElement('div');\n\t\t\t\tmenuCustom.className = 'flex-row'\n\t\t\t\tconst label = document.createElement('span');\n\t\t\t\tlabel.textContent = dashboard.name;\n\t\t\t\tlabel.className = 'flex-grow'\n\t\t\t\tconst editButton = document.createElement('span');\n\t\t\t\teditButton.textContent = '\u270E';\n\t\t\t\teditButton.onclick = (event) => {\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tlocation.hash = `#customdataset?id=${dashboard.id}`;\n\t\t\t\t};\n\t\t\t\tthis.menuitemByName[`custom:${dashboard.id}`] = menuCustom\n\t\t\t\tmenuCustom.appendChild(label);\n\t\t\t\tmenuCustom.appendChild(editButton);\n\t\t\t\tsubmenusCustom.appendChild(menuCustom);\n\t\t\t}\n\t\t\tloader.remove();\n\t\t\tmenuready_fun(null)\n\t\t});\n\n\t}\n\t\n\tasync refresh()\n\t{\n\t}\n\t\n\tasync selectItem(name: string)\n\t{\n\t\tawait this.menuready_promise\n\t\tif (!(name in this.menuitemByName) && name.startsWith('custom:')) {\n\t\t\tname = 'custom'\n\t\t}\n\t\tfor (let k in this.menuitemByName)\n\t\t{\n\t\t\tconst item = this.menuitemByName[k]\n\t\t\tif (name === k)\n\t\t\t\titem.classList.add('selected')\n\t\t\telse\n\t\t\t\titem.classList.remove('selected')\n\t\t}\n\t}\n}\n\ncustomElements.define('cs-menu-element', MenuComponent)\n", "<!--\n  SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n\n  SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<style>\n    @import url(\"anywhere.css\");\n    @import url(\"all-webcomponent.css\");\n\n\t:host {\n\t\tdisplay: flex;\n\t\tborder-top: 1px solid #ccc;\n\t\tpadding-top: 0.3rem;\n\t\tpadding-bottom: 0.3rem;\n\t\talign-items: center;\n\t}\n\tspan {\n\t\tfont-size: 0.7rem;\n\t}\n\tspan.label {\n\t\tflex-grow: 1;\n\t\tmargin-right: 0.3rem;\n\t\tpadding: 0.2rem\n\t}\n\tspan.data {\n\t\tpadding: 0.2rem;\n\t\tborder-radius: 0.3rem;\n\t\tmargin-right: 0.3rem;\n\t\tbackground-color: var(--dark-background);\n\t\tcolor: #ddd;\n\t\tmin-width: 2rem;\n\t\ttext-align: right;\n\t}\n\t:host(.fail) span.label {\n\t\tbackground-color: #faa;\n\t\tcolor: #400;\n\t\tfont-weight: bold;\n\t}\n\t:host(.good) span.label {\n\t\tbackground-color: #afa;\n\t\tcolor: #040;\n\t\tfont-weight: bold;\n\t}\n\t:host(.warn) span.label {\n\t\tbackground-color: #ffa;\n\t\tcolor: #440;\n\t\tfont-weight: bold;\n\t}\n</style>\n<span class=\"data\">.</span>\n<span class=\"label\"></span>\n", "// SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport { CommonWebComponent } from \"./CommonWebComponent.js\";\nimport { cs_cast } from \"./quality.js\";\nimport template from './LabelAndData.html?raw'\n\nexport class LabelAndData extends CommonWebComponent\n{\n\tlabel\n\tdata\n\t\n\tprivate state: {\n\t\tlabelValue: string\n\t\tdataValue: string\n\t\tqualityLevel: undefined | \"good\" | \"warn\" | \"fail\"\n\t}\n\t\n\tconstructor()\n\t{\n\t\tsuper(template)\n\t\t\n\t\tthis.label = cs_cast(HTMLSpanElement, this.sroot.querySelector('.label'))\n\t\tthis.data  = cs_cast(HTMLSpanElement, this.sroot.querySelector('.data'))\n\t\tthis.state = {\n\t\t\tlabelValue: this.getAttribute('label') !== null ? this.getAttribute('label')! : 'label',\n\t\t\tdataValue: this.data.textContent ?? '',\n\t\t\tqualityLevel: undefined,\n\t\t}\n\t\tthis.#resync_derived_resources()\n\t\t\n\t}\n\t\n\tsetLabel(s: string)\n\t{\n\t\tif (this.state.labelValue === s)\n\t\t\treturn\n\t\tthis.state.labelValue = s\n\t\tthis.#resync_derived_resources()\n\t}\n\n\tsetData(s: string)\n\t{\n\t\tif (this.state.dataValue === s)\n\t\t\treturn\n\t\tthis.state.dataValue = s\n\t\tthis.#resync_derived_resources()\n\t}\n\t\n\tsetQualityLevel(severity: \"good\" | \"warn\" | \"fail\")\n\t{\n\t\tif (this.state.qualityLevel === severity)\n\t\t\treturn\n\t\tthis.state.qualityLevel = severity\n\t\tthis.#resync_derived_resources()\n\t}\n\n\t#resync_derived_resources(): void\n\t{\n\t\tthis.label.textContent = this.state.labelValue\n\t\tthis.data.textContent = this.state.dataValue\n\t\tthis.classList.remove(\"good\", \"warn\", \"fail\")\n\t\tif (this.state.qualityLevel !== undefined)\n\t\t\tthis.classList.add(this.state.qualityLevel)\n\t}\n\t\n}\n\ncustomElements.define('cs-label-and-data', LabelAndData)\n", "<!--\n  SPDX-FileCopyrightText: 2025 Catch Solve di Davide Montesin\n\n  SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<style>\n    @import url(\"anywhere.css\");\n    @import url(\"all-webcomponent.css\");\n\n\t:host {\n\t\tposition: relative;\n\t\tborder: 1px solid #ccc;\n\t\tmargin: 0.5rem;\n\t\tborder-radius: 4px;\n\t\tcursor: pointer;\n\t\twidth: 13rem;\n\t\tbox-shadow: 4px 4px #ccc;\n\t}\n\t.menu {\n\t\tposition: absolute;\n\t\ttop: 0.35rem;\n\t\tright: 0.35rem;\n\t\tz-index: 3;\n\t}\n\t.menu-button {\n\t\tborder: 1px solid #000;\n\t\tbackground: #000;\n\t\tborder-radius: 6px;\n\t\tpadding: 0.1rem 0.4rem;\n\t\tfont-weight: 700;\n\t\tcolor: #fff;\n\t\tcursor: pointer;\n\t\tz-index: 10;\n\t}\n\t.menu-button:hover {\n\t\tbackground: #222;\n\t}\n\t.menu-list {\n\t\tposition: absolute;\n\t\ttop: 1.7rem;\n\t\tright: 0;\n\t\tmin-width: 7rem;\n\t\tbackground: #000;\n\t\tborder: 1px solid #000;\n\t\tborder-radius: 6px;\n\t\tbox-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);\n\t\tdisplay: none;\n\t\tz-index: 4;\n\t}\n\t.menu.open .menu-list {\n\t\tdisplay: block;\n\t}\n\t.menu-item {\n\t\tpadding: 0.4rem 0.6rem;\n\t\tcursor: pointer;\n\t\twhite-space: nowrap;\n\t\tcolor: #fff;\n\t}\n\t.menu-item:hover {\n\t\tbackground: #222;\n\t}\n\t.menu-item.delete {\n\t\tcolor: #fca5a5;\n\t}\n\t.title {\n\t\tfont-weight: bold;\n\t\tmargin-top: .7rem;\n\t\tmargin-bottom: 0.3rem;\n\t\ttext-align: center;\n\t\toverflow: hidden;\n\t\theight: 2rem;\n\t\tline-height: 1rem;\n\t}\n\t\n\t/*\n\t:host(:hover) .title {\n\t\ttext-decoration: underline;\n\t}\n\t */\n\t\n\t.ts {\n\t\tfont-size: 0.7rem\n\t}\n\n\t.buttons {\n\t\tbackground-color: var(--dark-background);\n\t\tcolor: #ddd;\n\n\t}\n\t\n\t.view_dashboard {\n\t\t/* text-align: center;\n\t\tpadding: 0.6rem; */\n\t}\n\t.view_dashboard:hover {\n\t\t/* background-color: rgb(35, 75, 20); */\n\t}\n\t\n\t.wrapper {\n\t\tpadding: 1rem;\n\t}\n\n\t.lastupdate {\n\t\tmargin-top: 0.4rem;\n\t\tfont-size: 0.7rem;\n\t}\n\t\n\timg {\n\t\theight: 100px;\n\t\twidth: 100%;\n\t\tobject-fit: contain;\n\t\tmargin-bottom: 0.5rem;\n\t}\n\n\tdiv[data-length=\"0\"] {\n\t\tbackground-color: #aaa;\n\t\topacity: 0.5;\n\t}\n\n</style>\n<div class=\"menu display-none\">\n\t<button class=\"menu-button\" type=\"button\">...</button>\n\t<div class=\"menu-list\">\n\t\t<div class=\"menu-item edit\">Edit</div>\n\t\t<div class=\"menu-item delete\">Remove</div>\n\t</div>\n</div>\n<div class=\"wrapper\">\n\t<div class=\"title\">XXX</div>\n\t<img class=\"img\">\n\t<cs-label-and-data class=\"checktrec\">checked records</cs-label-and-data>\n\t<cs-label-and-data class=\"checkattr\" style=\"display: none\">checked attributes</cs-label-and-data>\n\t<cs-label-and-data class=\"totissues\" xstyle=\"display: none\">total issues</cs-label-and-data>\n\t<div class=\"lastupdate\">\n\t\t\uD83D\uDD51 <span class=\"data\"></span>\n\t\t<span></span>\n\t</div>\n</div>\n<div class=\"buttons flex-row gap-medium \">\n\t<div class=\"view_dashboard flex-grow padding-medium\">View dashboard</div>\n\t<div class=\"edit display-none padding-medium\">\u270E</div>\n</div>\n", "// SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport { CommonWebComponent } from \"./CommonWebComponent.js\";\nimport { cs_cast, throwNPE } from \"./quality.js\";\n\nimport { LabelAndData } from \"./LabelAndData.js\"\nimport { catchsolve_noiodh__test_dataset_max_ts_vw__row } from \"./api/api3.js\";\nimport template from './DatasetCardComponent.html?raw'\n\nexport class DatasetCardComponent extends CommonWebComponent\n{\n\tdtitle\n\timg\n\tcheckrecs\n\tcheckattr\n\tfailedrecs\n\tlastupdate\n\n\t#editdiv\n\t#edit_hash: string\n\t#menu\n\t#menuButton\n\t#menuList\n\t#menuEdit\n\t#menuDelete\n\t#menuDeleteHandler: (() => void) | null\n\t\n\tconstructor()\n\t{\n\t\tsuper(template)\n\n\t\tthis.checkrecs  = cs_cast(LabelAndData,      this.sroot.querySelector('.checktrec'))\n\t\tthis.checkattr  = cs_cast(LabelAndData,      this.sroot.querySelector('.checkattr'))\n\t\tthis.failedrecs = cs_cast(LabelAndData,      this.sroot.querySelector('.totissues'))\n\t\tthis.dtitle     = cs_cast(HTMLDivElement,    this.sroot.querySelector('.title'))\n\t\tthis.img        = cs_cast(HTMLImageElement,  this.sroot.querySelector('.img'))\n\t\tthis.lastupdate = cs_cast(HTMLSpanElement,   this.sroot.querySelector('.lastupdate .data'))\n\t\tthis.#editdiv   = cs_cast(HTMLDivElement,   this.sroot.querySelector('.edit'))\n\t\tthis.#menu      = cs_cast(HTMLDivElement,   this.sroot.querySelector('.menu'))\n\t\tthis.#menuButton = cs_cast(HTMLButtonElement, this.sroot.querySelector('.menu-button'))\n\t\tthis.#menuList   = cs_cast(HTMLDivElement,   this.sroot.querySelector('.menu-list'))\n\t\tthis.#menuEdit   = cs_cast(HTMLDivElement,   this.sroot.querySelector('.menu-item.edit'))\n\t\tthis.#menuDelete = cs_cast(HTMLDivElement,   this.sroot.querySelector('.menu-item.delete'))\n\t\t\t\t\n\t\t// this.img.style.display = 'none';\n\t\t\n\t\tthis.checkrecs.setLabel('total checks')\n\t\tthis.checkattr.setLabel('checked attrs')\n\t\tthis.failedrecs.setLabel('passed checks')\n\n\t\tthis.#edit_hash = ''\n\t\tthis.#menuDeleteHandler = null\n\n\t\tthis.#menuButton.onclick = (event) => {\n\t\t\tevent.stopPropagation()\n\t\t\tthis.#menu.classList.toggle('open')\n\t\t}\n\t\tthis.#menuEdit.onclick = (event) => {\n\t\t\tevent.stopPropagation()\n\t\t\tthis.#menu.classList.remove('open')\n\t\t\tlocation.hash = this.#edit_hash\t\t\t\n\t\t}\n\t\tthis.#menuDelete.onclick = (event) => {\n\t\t\tevent.stopPropagation()\n\t\t\tthis.#menu.classList.remove('open')\n\t\t\tthis.#menuDeleteHandler?.()\n\t\t}\n\t\t/*\n\t\tdocument.addEventListener('click', (event) => {\n\t\t\tif (event.composedPath().includes(this)) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tthis.#menu.classList.remove('open')\n\t\t})\n\t\t */\n\t\t\n\t\t// this.failedrecs.setSeverity(\"fail\")\n\t\t// this.failedrecs.setData('123')\n\n\t}\n\n\tset edit_hash(v: string) {\n\t\tthis.#edit_hash = v\n\t}\n\n\tset menu_on_delete(v: (() => void) | null) {\n\t\tthis.#menuDeleteHandler = v\n\t\tthis.#resync_menu()\n\t}\n\n\t#resync_menu() {\n\t\tconst showMenu = this.#edit_hash !== ''\n\t\tthis.#menu.classList.toggle('display-none', !showMenu)\n\t\tif (!showMenu) {\n\t\t\tthis.#menu.classList.remove('open')\n\t\t}\n\t}\n\n\t\n\trefresh(dataset: catchsolve_noiodh__test_dataset_max_ts_vw__row)\n\t{\n\t\tconst datestr = dataset.session_start_ts\n\t\tconst date = new Date(datestr)\n\t\t\n\t\tconst dateformat = new Intl.DateTimeFormat('it-IT', {\n\t\t\tyear: 'numeric',\n\t\t\tmonth: '2-digit',\n\t\t\tday: '2-digit',\n\t\t\thour: '2-digit',\n\t\t\tminute: \"2-digit\",\n\t\t\ttimeZone: 'Europe/Rome'\n\t\t}).format(date)\n\t\t\n\t\tthis.dtitle.textContent = dataset.dataset_name\n\t\tthis.img.src = dataset.dataset_img_url.length > 0 ? dataset.dataset_img_url : 'dataset-placeholder.png'\n\t\tthis.checkrecs.setData('' + dataset.tested_records)\n\t\tthis.shadowRoot!.querySelector('div.wrapper')!.setAttribute('data-length', '' + dataset.tested_records)\n\t\tthis.checkattr.setData('123')\n\t\tthis.failedrecs.setData('' + (dataset.tested_records - dataset.failed_records))\n\t\tconst quality_ratio = dataset.tested_records == 0 ? 100 : dataset.failed_records / dataset.tested_records\n\t\t/*\n\t\tif (dataset.tested_records > 0)\n\t\t{\n\t\t\tif (quality_ratio < 0.1)\n\t\t\t\tthis.failedrecs.setQualityLevel(\"good\")\n\t\t\telse if (quality_ratio < 0.3)\n\t\t\t\tthis.failedrecs.setQualityLevel(\"warn\")\n\t\t\telse\n\t\t\t\tthis.failedrecs.setQualityLevel(\"fail\")\n\t\t}\n\t\t */\n\t\tthis.#editdiv.classList.toggle('display-none', this.#edit_hash === '')\n\t\tthis.lastupdate.textContent = dateformat\n\t\tthis.onclick = () => {\n\t\t\tthis.#menu.classList.remove('open')\n\t\t\tconst escapedDatasetName = encodeURIComponent(dataset.dataset_name ?? '')\n\t\t\tlocation.hash = '#page=dataset-categories' + '&dataset_name=' + escapedDatasetName \n\t\t\t\t\t\t\t+ \"&session_start_ts=\" + dataset.session_start_ts\n\t\t\t\t\t\t\t+ \"&failed_records=\" + dataset.failed_records\n\t\t\t\t\t\t\t+ \"&tested_records=\" + dataset.tested_records\n\t\t\twindow.scrollTo(0,0);\n\t\t}\n\t}\n}\n\n\ncustomElements.define('cs-dataset-box', DatasetCardComponent)\n", "<!--\n  SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n\n  SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<style>\n    @import url(\"anywhere.css\");\n    @import url(\"all-webcomponent.css\");\n</style>\n<link rel=\"stylesheet\" href=\"index.css\">\n<div class=\"ProjectsElement\">\n\t<div class=\"title\" style=\"padding: 1rem\">standard dashboards</div>\n\t<div class=\"searchbar\">\n\t\t<input> \uD83D\uDD0D <span class=\"clearinput\">\u2715</span>\n\t</div>\n\t<div class=\"container\"></div>\n</div>\n", "// SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport { CommonWebComponent } from './CommonWebComponent.js';\nimport { DatasetCardComponent } from './DatasetCardComponent.js';\nimport { Loader } from './Loader.js';\nimport { API3 } from './api/api3.js';\nimport { cs_cast } from './quality.js';\nimport template from './StandardDashboardsComponent.html?raw'\n\nexport class StandardDashboardsComponent extends CommonWebComponent\n{\n\tboxContainer;\n\t\n\tboxes: DatasetCardComponent[] = []\n\ttitles: string[] = []\n\n\tconstructor()\n\t{\n\t\tsuper(template)\n\t\tthis.boxContainer = cs_cast(HTMLDivElement, this.sroot.querySelector('.container'))\n\n\t\tthis.boxContainer.textContent = (\"loading ...\");\n\t\t\n\t\tconst refreshlist = () => {\n\t\t\tfor (let b = 0; b < this.titles.length; b++)\n\t\t\t\tif (this.titles[b].toLowerCase().indexOf(input.value.toLowerCase()) >= 0)\n\t\t\t\t\tthis.boxes[b].style.display = 'block'\n\t\t\t\telse\n\t\t\t\t\tthis.boxes[b].style.display = 'none'\n\t\t}\n\n\t\tconst input = this.sroot.querySelector('input')!\n\t\tinput.oninput = refreshlist\n\t\t\n\t\tconst clearinput = <HTMLSpanElement> this.sroot.querySelector('.clearinput')!\n\t\tclearinput.onclick = () => {\n\t\t\tinput.value = ''\n\t\t\trefreshlist()\n\t\t}\n\t\t\n\t}\n\n\ttesting_htmlelements(): DatasetCardComponent[] {\n\t\treturn this.boxes\n\t}\n\n\tasync refresh()\n\t{\n\t\tthis.boxes = []\n\t\tthis.titles = []\n\t\tthis.boxContainer.textContent = ('');\n\t\tconst loader = new Loader();\n\t\tthis.boxContainer.appendChild(loader)\n\t\tlet used_key = sessionStorage.getItem('used_key_role')!;\n\t\tconsole.log('used key role', used_key);\n\t\tconst json = await API3.list__catchsolve_noiodh__test_dataset_max_ts_vw({used_key: used_key})\n\t\tloader.remove();\n\t\tconsole.log(json)\n\t\tfor (let dataset of json)\n\t\t{\n\t\t\tconst box = new DatasetCardComponent();\n\t\t\tthis.boxContainer.appendChild(box)\n\t\t\tbox.refresh(dataset)\n\t\t\tthis.boxes.push(box)\n\t\t\tthis.titles.push(dataset.dataset_name)\n\t\t}\n\t\t\n\t} \n}\n\ncustomElements.define('cs-standard-dashboards-element', StandardDashboardsComponent)\n", "<!--\n  SPDX-FileCopyrightText: 2025 Catch Solve di Davide Montesin\n\n  SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<style>\n    @import url(\"anywhere.css\");\n    @import url(\"all-webcomponent.css\");\n\n\t.add-dataset-card {\n\t\tborder: 2px dashed #9ca3af;\n\t\tmargin: 0.5rem;\n\t\tborder-radius: 6px;\n\t\tcursor: pointer;\n\t\twidth: 13rem;\n\t\tmin-height: 14rem;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tgap: 0.5rem;\n\t\tcolor: #4b5563;\n\t\tbackground: #f9fafb;\n\t}\n\t.add-dataset-card:hover {\n\t\tborder-color: #6b7280;\n\t\tcolor: #111111;\n\t\tbackground: #f3f4f6;\n\t}\n\t.add-dataset-plus {\n\t\tfont-size: 3rem;\n\t\tline-height: 1;\n\t\tfont-weight: 700;\n\t}\n\t.add-dataset-text {\n\t\tfont-size: 0.9rem;\n\t\tfont-weight: 600;\n\t\ttext-transform: uppercase;\n\t\tletter-spacing: 0.06em;\n\t}\n</style>\n<link rel=\"stylesheet\" href=\"index.css\">\n<div class=\"ProjectsElement\">\n\t<div class=\"title\" style=\"padding: 1rem\">custom dashboards</div>\n\t<div class=\"searchbar\">\n\t\t<input> \uD83D\uDD0D <span class=\"clearinput\">\u2715</span>\n\t</div>\n\t<div class=\"container\"></div>\n</div>\n", "// SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport { CommonWebComponent } from './CommonWebComponent.js';\nimport { DatasetCardComponent } from './DatasetCardComponent.js';\nimport { Loader } from './Loader.js';\nimport { API3, catchsolve_noiodh__test_dataset_max_ts_vw__row } from './api/api3.js';\nimport { kc } from './auth.js';\nimport { cs_cast } from './quality.js';\nimport template from './CustomDashboardsComponent.html?raw'\n\nexport class CustomDashboardsComponent extends CommonWebComponent\n{\n\tboxContainer;\n\tboxes: DatasetCardComponent[] = []\n\ttitles: string[] = []\n\n\tconstructor()\n\t{\n\t\tsuper(template)\n\t\tthis.boxContainer = cs_cast(HTMLDivElement, this.sroot.querySelector('.container'))\n\n\t\tthis.boxContainer.textContent = (\"loading ...\");\n\n\t\tconst refreshlist = () => {\n\t\t\tfor (let b = 0; b < this.titles.length; b++)\n\t\t\t\tif (this.titles[b].toLowerCase().indexOf(input.value.toLowerCase()) >= 0)\n\t\t\t\t\tthis.boxes[b].style.display = 'block'\n\t\t\t\telse\n\t\t\t\t\tthis.boxes[b].style.display = 'none'\n\t\t}\n\n\t\tconst input = this.sroot.querySelector('input')!\n\t\tinput.oninput = refreshlist\n\n\t\tconst clearinput = <HTMLSpanElement> this.sroot.querySelector('.clearinput')!\n\t\tclearinput.onclick = () => {\n\t\t\tinput.value = ''\n\t\t\trefreshlist()\n\t\t}\n\t}\n\n\tasync refresh()\n\t{\n\t\tthis.boxes = []\n\t\tthis.titles = []\n\t\tthis.boxContainer.textContent = ('');\n\t\tconst loader = new Loader();\n\t\tthis.boxContainer.appendChild(loader)\n\t\tconst used_key = sessionStorage.getItem('used_key_role') ?? ''\n\t\tconst [datasets, dashboards] = await Promise.all([\n\t\t\t// TODO manage custom dataset test too\n\t\t\t[] as catchsolve_noiodh__test_dataset_max_ts_vw__row[],\n\t\t\tAPI3.list__catchsolve_noiodh__custom_dashboards({})\n\t\t])\n\t\tloader.remove();\n\t\tconst datasetByName = new Map(datasets.map((row) => [row.dataset_name, row]))\n\t\tfor (let dashboard of dashboards)\n\t\t{\n\t\t\tconst dataset = datasetByName.get(dashboard.name) ?? this.buildFallbackDataset(dashboard.name)\n\t\t\tconst box = new DatasetCardComponent();\n\t\t\tbox.edit_hash = `#customdataset?id=${dashboard.id}`;\n\t\t\tbox.menu_edit_hash = `#customdataset?id=${dashboard.id}`\n\t\t\tbox.menu_on_delete = async () => {\n\t\t\t\tif (!confirm(`Delete \"${dashboard.name}\"?`)) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tconst ok = await this.deleteCustomDashboard(dashboard.id)\n\t\t\t\tif (!ok) {\n\t\t\t\t\talert('Delete failed')\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tconst index = this.boxes.indexOf(box)\n\t\t\t\tif (index !== -1) {\n\t\t\t\t\tthis.boxes.splice(index, 1)\n\t\t\t\t\tthis.titles.splice(index, 1)\n\t\t\t\t}\n\t\t\t\tbox.remove()\n\t\t\t}\n\t\t\tthis.boxContainer.appendChild(box)\n\t\t\tbox.refresh(dataset)\n\t\t\t/*\n\t\t\tbox.onclick = () => {\n\t\t\t\tlocation.hash = `#customdataset?id=${dashboard.id}`;\n\t\t\t\twindow.scrollTo(0,0);\n\t\t\t}\n\t\t\t */\n\t\t\tthis.boxes.push(box)\n\t\t\tthis.titles.push(dashboard.name)\n\t\t}\n\t\tthis.boxContainer.appendChild(this.createAddDatasetCard())\n\t}\n\n\tprivate async deleteCustomDashboard(id: number): Promise<boolean>\n\t{\n\t\tconst body = new URLSearchParams()\n\t\tbody.set('action', 'delete_custom_dashboard')\n\t\tbody.set('id', String(id))\n\t\tbody.set('current_role', sessionStorage.getItem('used_key_role') ?? '')\n\t\tconst headers: HeadersInit = { 'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8' }\n\t\tif (kc.token) {\n\t\t\theaders.Authorization = `Bearer ${kc.token}`\n\t\t}\n\t\tconst response = await fetch('api', {\n\t\t\tmethod: 'POST',\n\t\t\theaders,\n\t\t\tbody\n\t\t})\n\t\treturn response.ok\n\t}\n\n\tprivate createAddDatasetCard(): HTMLDivElement\n\t{\n\t\tconst card = document.createElement('div')\n\t\tcard.className = 'add-dataset-card'\n\t\tcard.setAttribute('data-testid', 'add-custom-dashboard-card')\n\t\tconst plus = document.createElement('div')\n\t\tplus.className = 'add-dataset-plus'\n\t\tplus.textContent = '+'\n\t\tconst label = document.createElement('div')\n\t\tlabel.className = 'add-dataset-text'\n\t\tlabel.textContent = 'Add dataset'\n\t\tcard.appendChild(plus)\n\t\tcard.appendChild(label)\n\t\tcard.onclick = async () => {\n\t\t\tconst newid = await API3.get__catchsolve_noiodh__custom_dashboards_next_id()\n\t\t\tlocation.hash = `#customdataset?id=${newid}`\n\t\t}\n\t\treturn card\n\t}\n\n\tprivate buildFallbackDataset(datasetName: string): catchsolve_noiodh__test_dataset_max_ts_vw__row\n\t{\n\t\treturn {\n\t\t\tdataset_img_url: '',\n\t\t\tdataset_name: datasetName,\n\t\t\tfailed_records: 0,\n\t\t\tsession_start_ts: new Date().toISOString(),\n\t\t\ttested_records: 0\n\t\t}\n\t}\n}\n\ncustomElements.define('cs-custom-dashboards-element', CustomDashboardsComponent)\n", "<!--\n  SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n\n  SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<style>\n    @import url(\"all-webcomponent.css\");\n\n\t@import url(\"anywhere.css\");\n\t:host {\n\t\tdisplay: block;\n\t}\n\t.header {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t}\n\t.label {\n\t\tflex-grow: 1;\n\t\tcursor: pointer;\n\t\tpadding: 0.4rem;\n\t\tuser-select: none;\n\t}\n\t.openclose {\n\t\tcursor: pointer;\n\t\tpadding: 0.4rem;\n\t\tuser-select: none;\n\t}\n\t.openclose::before {\n\t\tcontent: \"\";\n\t\tdisplay: inline-block;\n\t\twidth: 0.8rem;\n\t\theight: 0.8rem;\n\t\tbackground-color: currentColor;\n\t\t-webkit-mask: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12'%3E%3Cpath d='M2 4l4 4 4-4' fill='none' stroke='%23000' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E\") center / contain no-repeat;\n\t\tmask: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12'%3E%3Cpath d='M2 4l4 4 4-4' fill='none' stroke='%23000' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E\") center / contain no-repeat;\n\t\ttransform: rotate(180deg);\n\t}\n\t.openclose.close::before {\n\t\ttransform: rotate(0deg);\n\t}\n\t.content {\n\t\toverflow: hidden;\n\t\ttransition: transform 1s;\n\t\ttransform-origin: top;\n\t}\n\t\n\t/*\n\tspan.label::before {\n\t  content: \"\";\n\t  display: inline-block;\n\t  width: 8px;\n\t  height: 8px;\n\t  background-color: red;\n\t  border-radius: 50%;\n\t  margin-right: 5px;\n\t}\n\t */\n\t\n</style>\n<div class=\"header\">\n<span class=\"label\">title</span>\n<span class=\"actions\">actions</span>\n<span class=\"openclose\"></span>\n</div>\n<div class=\"content\"></div>\n", "// SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport { CommonWebComponent } from \"./CommonWebComponent.js\";\nimport { cs_cast, throwNPE } from \"./quality.js\";\nimport template from './OpenCloseSection.html?raw'\n\nexport class OpenCloseSection extends CommonWebComponent\n{\n\t\n\tcontent\n\topen = true \n\topenclose\n\tlabel\n\tactions\n\t\n\tonopen = () => {}\n\t\n\tconstructor() {\n\t\tsuper(template)\n\n\t\tthis.label = cs_cast(HTMLSpanElement, this.sroot.querySelector('.label'))\n\t\tthis.actions = cs_cast(HTMLSpanElement, this.sroot.querySelector('.actions'))\n\t\tthis.content = cs_cast(HTMLDivElement, this.sroot.querySelector('.content'))\n\t\tthis.openclose = cs_cast(HTMLSpanElement, this.sroot.querySelector('.openclose'))\n\t\tthis.openclose.onclick = () => {\n\t\t\tthis.toggle();\n\t\t}\n\t\tthis.label.onclick = this.openclose.onclick\n\t\tthis.toggle();\n\t}\n\t\n\ttoggle()\n\t{\n\t\tthis.open = !this.open\n\t\tthis.content.style.height     = !this.open ? '0rem' : 'auto'\n\t\tthis.openclose.classList.toggle('close', !this.open)\n\t\tif (this.open)\n\t\t{\n\t\t\tthis.content.textContent = '' // svuola la sezione\n\t\t\tthis.onopen()\n\t\t}\n\t}\n\t\n\tasync refresh(label: string, actions: string) {\n\t\tthis.label.textContent = label\n\t\tthis.actions.textContent = actions\n\t}\n\t\n\taddElementToContentArea(e: HTMLElement)\n\t{\n\t\tthis.content.appendChild(e)\n\t}\n}\n\ncustomElements.define('cs-open-close-section', OpenCloseSection)\n", "<!--\n  SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n\n  SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<style>\n    @import url(\"anywhere.css\");\n    @import url(\"all-webcomponent.css\");\n\n\t:host {\n\t\tdisplay: block;\n\t\tborder: 1px solid #eee;\n\t\tpadding: 1rem;\n\t}\n\t\n</style>\n<span class=\"label\">title</span>\n", "// SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport { CommonWebComponent } from \"./CommonWebComponent.js\";\nimport { cs_cast, throwNPE } from \"./quality.js\";\nimport template from './SectionRow.html?raw'\n\nexport class SectionRow extends CommonWebComponent\n{\n\tlabel\n\n\tconstructor() {\n\t\tsuper(template)\n\n\t\tthis.label = cs_cast(HTMLSpanElement, this.sroot.querySelector('.label'))\n\n\t}\n\t\n\t\n\tasync refresh(s: string) {\n\t\tthis.label.textContent = s;\n\t}\n\t\n}\n\ncustomElements.define('cs-section-row', SectionRow)\n", "<!--\n  SPDX-FileCopyrightText: 2025 Catch Solve di Davide Montesin\n\n  SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<style>\n    @import url(\"anywhere.css\");\n    @import url(\"all-webcomponent.css\");\n\n\t:host {\n\t\tdisplay: inline-block;\n\t\tbox-shadow: 4px 4px #ccc;\n\t}\n\t.category {\n\t\tborder: 1px solid gray;\n\t\twidth: 12rem;\n\t\tdisplay: inline-block;\n\t\t/* margin: 1rem; */\n\t}\n\t.category > img {\n\t\twidth: 100%;\n\t}\n\t.category .category_name {\n\t\tfont-weight: bold;\n\t\ttext-align: center;\n\t\tmargin-top: 0.4rem;\n\t\tmargin-bottom: 0.4rem;\n\t\tline-height: 1rem;\n\t\theight: 5rem;\n\t\tpadding: 1rem;\n\t}\n\t.frame {\n\t\tdisplay: flex\n\t}\n\t.frame .content {\n\t\tflex-grow: 100;\n\t\tdisplay: flex;\n\t}\n\t.chartdiv {\n\t\twidth:  100px;\n\t\theight: 100px;\n\t\tmargin: auto;\n\t\tposition: relative;\n\t\tmargin-top: 0.4rem;\n\t}\n\t\n\t.chartdiv .perc {\n\t\tposition: absolute;\n\t\ttop:  calc(50% - 0.8rem);\n\t\tleft: calc(50% - 1.6rem);\n\t\tfont-size: 1.5rem;\n\t\tfont-weight: bold;\n\t\tcolor: #000;\n\t}\n\t\n\tdetails {\n\t\tmargin-top: 0.4rem;\n\t\tmargin-bottom: 0.4rem;\n\t}\n\t\n\tdetails > * {\n\t\tpadding: 0.5em;\n\t\tborder-bottom: 1px solid #ccc;\n\t}\n\t\t\t\t\t\t\t\n\t.view_details {\n\t\t/* background-color: var(--dark-background); */\n\t\tbackground-color: black;\n\t\tcolor: #ddd;\n\t\ttext-align: center;\n\t\tpadding: 0.6rem;\n\t\tcursor: pointer;\n\t}\n\t\n\t.view_details:hover {\n\t\t/* background-color: rgb(35, 75, 20); */\n\t}\n\n\t.lastupdate {\n\t\tmargin-top: 0.4rem;\n\t\tfont-size: 0.7rem;\n\t\tmargin-bottom: 0.4rem;\n\t\tmargin-left: 0.4rem;\n\t\tmargin-right: 0.4rem;\n\t}\n\t\n\t.nr_records, details, .checked_nr_records {\n\t\tmargin-left: 0.4rem;\n\t\tmargin-right: 0.4rem;\n\t}\n\n</style>\n<div class=\"category\">\n\t<!-- <img src=\"kpi-pie-chart.png\"> -->\n\t<div class=\"chartdiv\">\n\t\t<div class=\"perc\">12%</div>\n\t\t<canvas class=\"chart\"></canvas>\n\t</div>\n\t<div class=\"category_name\">Completeness</div>\n\t<span></span>\n\t<cs-label-and-data label=\"checked recs\" class=\"checked_nr_records\"></cs-label-and-data>\n\t<cs-label-and-data label=\"quality-assured recs\" class=\"nr_records\"></cs-label-and-data>\n\t<div class=\"lastupdate\">\n\t\t<span class=\"data\"></span>\n\t\t<span></span>\n\t</div>\n\t<!-- <div class=\"nr_records\">123</div> -->\n\t<div class=\"more\">\n\t\t<details>\n\t\t\t<summary>carried out tests</summary>\n\t\t</details>\n\t\t<div class=\"view_details\">View details</div>\n\t</div>\n</div>\n", "// SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport { CommonWebComponent } from \"./CommonWebComponent.js\";\nimport { LabelAndData } from \"./LabelAndData.js\"\nimport { API3, catchsolve_noiodh__test_dataset_check_category_failed_recors_vw__row } from \"./api/api3.js\"\nimport { cs_cast } from \"./quality.js\"\nimport template from './DatasetIssueCategoryComponent.html?raw'\n\n\nexport class DatasetIssueCategoryComponent extends CommonWebComponent\n{\n\t\n\ttemplate\n\t\n\tconnected_promise\n\tconnected_func: (s: null) => void = s => null\n\t\n\tmore_div\n\t\n\tconnectedCallback()\n\t{\n\t\tconsole.log('connected')\n\t\tthis.connected_func(null)\n\t}\n\t\n\tconstructor() {\n\t\tsuper(template);\n\t\tthis.connected_promise = new Promise(s => this.connected_func = s)\n\t\tthis.template = cs_cast(HTMLElement, this.sroot.querySelector('.category'));\n\t\tthis.more_div = cs_cast(HTMLElement, this.sroot.querySelector('.more'));\n\t}\n\t\n\thideMoreDiv()  {\n\t\tthis.more_div.style.display = 'none'\n\t}\n\t\n\tasync refresh(data: {dataset_name: string, tot_records: number, failed_records: number, check_category: string, session_start_ts: string})\n\t{\n\n\t\tconst cat = this.template\n\t\tthis.setup_chart(cat, data)\n\t\tconst cat_name = cs_cast(HTMLElement, cat.querySelector('.category_name'))\n\t\tcat_name.textContent = data.check_category\n\t\tconst failedelement = cs_cast(LabelAndData, cat.querySelector('.nr_records'))\n\t\tfailedelement.setData('' + (data.tot_records - data.failed_records))\n\t\tconst checked_nr_records = cs_cast(LabelAndData, cat.querySelector('.checked_nr_records'))\n\t\tchecked_nr_records.setData('' + data.tot_records)\n\t\tconst last_update = cs_cast(HTMLSpanElement, cat.querySelector('.lastupdate .data'))\n\t\tconst date = new Date(data.session_start_ts)\n\t\t\n\t\tconst perc = cs_cast(HTMLElement, cat.querySelector('.perc'))\n\t\tperc.textContent = '' + ((data.tot_records - data.failed_records) * 100 / data.tot_records).toFixed(1)\n\t\t\t\t\n\t\tconst dateformat = new Intl.DateTimeFormat('it-IT', {\n\t\t\t\t\tyear: 'numeric',\n\t\t\t\t\tmonth: '2-digit',\n\t\t\t\t\tday: '2-digit',\n\t\t\t\t\thour: '2-digit',\n\t\t\t\t\tminute: \"2-digit\",\n\t\t\t\t\ttimeZone: 'Europe/Rome'\n\t\t\t\t}).format(date)\n\n\t\tlast_update.textContent = dateformat\n\n\t\tconst view_details = cs_cast(HTMLElement, cat.querySelector('.view_details'))\n\t\t\n\t\tview_details.onclick = () => {\n\t\t\tlocation.hash = '#page=summary&session_start_ts=' + data.session_start_ts + '&dataset_name=' + encodeURIComponent(data.dataset_name) + '&category_name=' + data.check_category +\n\t\t\t\t\t\t\t'&failed_records=' + data.failed_records + '&tot_records=' + data.tot_records \n\t\t}\n\t\t\n\t\tconst cat_details =  cs_cast(HTMLElement, cat.querySelector('details'))\n\t\t\n\t\tAPI3.list__catchsolve_noiodh__test_dataset_check_category_check_name_failed_recors_vw({\n\t\t\t\t\tsession_start_ts: data.session_start_ts,\n\t\t\t\t\tdataset_name : data.dataset_name,\n\t\t\t\t\tcheck_category: data.check_category\n\t\t\t\t}).then((checks) => {\n\t\t\t\t\tconsole.log(checks)\n\t\t\t\t\tfor (let i2 = 0; i2 < checks.length; i2++)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst div = document.createElement('div')\n\t\t\t\t\t\tdiv.textContent = checks[i2].check_name // + ' ' + checks[i2].failed_records +  ' / ' + checks[i2].tot_records \n\t\t\t\t\t\tcat_details.appendChild(div)\n\t\t\t\t\t}\n\t\t})\n\n\t}\n\n\tasync  setup_chart(cat: HTMLElement, arg1: {tot_records: number, failed_records: number}) {\n\t\tawait this.connected_promise\n\t\tconst chart = cs_cast(HTMLCanvasElement, cat.querySelector('.chart'));\n\t\t// const context = chart.getContext('2d');\n\t\t\t\t\t\tnew Chart(chart, \t\t\t\t{\n\t\t\t\t\t\t  type: 'doughnut',\n\t\t\t\t\t\t  data: {\n\t\t\t\t\t\t    labels: ['ok', 'fail'],\n\t\t\t\t\t\t    datasets: [\n\t\t\t\t\t\t      {\n\t\t\t\t\t\t        label: 'Dataset 1',\n\t\t\t\t\t\t        data: [arg1.tot_records - arg1.failed_records, arg1.failed_records, ],\n\t\t\t\t\t\t\t\tbackgroundColor: ['#0a0', '#222', ]\n\t\t\t\t\t\t      }\n\t\t\t\t\t\t    ]\n\t\t\t\t\t\t  },\n\t\t\t\t\t\t  options: {\n\t\t\t\t\t\t\tcutout: '80%',\n\t\t\t\t\t\t    responsive: true,\n\t\t\t\t\t\t    plugins: {\n\t\t\t\t\t\t      legend: {\n\t\t\t\t\t\t\t\tdisplay: false,\n\t\t\t\t\t\t        position: 'top',\n\t\t\t\t\t\t      },\n\t\t\t\t\t\t      title: {\n\t\t\t\t\t\t        display: false,\n\t\t\t\t\t\t        text: 'Chart.js Doughnut Chart'\n\t\t\t\t\t\t      }\n\t\t\t\t\t\t    }\n\t\t\t\t\t\t  },\n\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t}\n\n\n}\n\ncustomElements.define('cs-dataset-issue-category', DatasetIssueCategoryComponent)\n", "<!--\n  SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n\n  SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<style>\n    @import url(\"all-webcomponent.css\");\n\n\t@import url(\"anywhere.css\");\n\t:host {\n\t\tpadding: 0.5rem;\n\t\tdisplay: block;\n\t}\n\t.container {\n\t\tborder: 1px solid #ccc;\n\t\tborder-radius: 0.3rem;\n\t}\n\t\n\t.container > * {\n\t\tborder-bottom: 1px solid #ccc;\n\t}\n\t.header {\n\t\tdisplay: flex;\n\t}\n\t.header .chart {\n\t\twidth: 50%;\n\t}\n\t\n\t.actions {\n\t\tborder: 1px solid black;\n\t\twidth: 10rem;\n\t\tmargin-left: auto;\n\t\tdisplay: flex;\n\t\tborder-radius: 0.4rem;\n\t\tmargin-bottom: 0.5rem;\n\t}\n\t\n\t.actions span.selected {\n\t\tcolor: white;\n\t\tbackground-color: black;\n\t}\n\t\n\t.actions span {\n\t\tflex-grow: 50;\n\t\ttext-align: center;\n\t\tcursor: pointer;\n\t}\n\t\n\n</style>\n<!-- <img src=\"kpi-detail.png\" style=\"max-width: 100%\"> -->\n<div class=\"header\">\n\t<div>\n\t\t<cs-dataset-issue-category></cs-dataset-issue-category>\n\t</div>\n\t<div class=\"chart\">\n\t\t<canvas></canvas>\n\t</div>\n\t<!--<cs-general-info-and-settings></cs-general-info-and-settings>-->\n</div>\n<div style=\"width: calc(100% - 20px)\">\n\t<div style=\"text-align: right\" class=\"actions\">\n\t\t<span class=\"issues\">Issues</span>\n\t\t<span class=\"records\">Records</span>\n\t</div>\n\t<div class=\"container\"></div>\n</div>\n", "// SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport { CommonWebComponent } from \"./CommonWebComponent.js\";\nimport { cs_cast, throwNPE } from \"./quality.js\";\nimport {API3, catchsolve_noiodh__test_dataset_record_check_failed__row} from './api/api3.js';\nimport { OpenCloseSection } from \"./OpenCloseSection.js\";\nimport { SectionRow } from \"./SectionRow.js\";\nimport { Loader } from \"./Loader.js\";\nimport { DatasetIssueCategoryComponent } from \"./DatasetIssueCategoryComponent.js\";\nimport { GeneralInfoAndSettings } from \"./GeneralInfoAndSettings.js\";\nimport template from './DatasetIssuesDetail.html?raw'\n\nexport class DatasetIssuesDetail extends CommonWebComponent\n{\n\t\n\tcontainer \n\t\n\tlast_session_start_ts: string|null = null\n\tlast_dataset_name: string|null = null\n\tlast_check_category: string|null = null\n\tlast_failed_records: number|null = null\n\tlast_tot_records: number|null = null\n\t\n\tcurrent_tab: 'issues' | 'records' = 'issues'\n\t\n\tcanvas\n\t\n\t// connected_promise\n\t// connected_func: (s: null) => void = s => null\n\t\n\tchartjs_success: (s: Chart) => void\n\tchartjs_promise: Promise<Chart>\n\n\tissues: HTMLSpanElement;\n\trecords: HTMLSpanElement;\n    // info_and_settings: GeneralInfoAndSettings;\n\n\tconnectedCallback()\n\t{\n\t\t// chartjs need to be created when element is attached into the dom\n\t\tconst chart = new Chart(this.canvas, {\n\t\t\ttype: 'line',\n\t\t\tdata: {\n\t\t\t\tlabels: ['-5','-4','-3', '-2', '-1'],\n\t\t\t\tdatasets: []\n\t\t\t},\n\t\t\toptions: {\n\t\t\t\tscales: {\n\t\t\t\t\ty: {\n\t\t\t\t\t\tstacked: true,\n\t\t\t\t\t\tbeginAtZero: true\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t});\n\t\t\n\t\tthis.chartjs_success(chart)\n\t}\n\t\n\tconstructor() {\n\t\tsuper(template)\n\t\tthis.chartjs_success = (s) => {} // dummy initialization, next line will init chartjs_success but compiler don't understand this!\n\t\tthis.chartjs_promise = new Promise(s => this.chartjs_success = s)\n\n\t\tthis.container = cs_cast(HTMLDivElement, this.sroot.querySelector('.container'))\n\t\t\n\t\tthis.issues = cs_cast(HTMLSpanElement, this.sroot.querySelector('.issues'))\n\t\tthis.records = cs_cast(HTMLSpanElement, this.sroot.querySelector('.records'))\n\t\t\n\t\tthis.issues.onclick = () => {\n\t\t\tthis.current_tab = 'issues'\n\t\t\tif (this.last_session_start_ts != null && this.last_dataset_name != null && this.last_check_category != null\n\t\t\t\t&& this.last_failed_records != null && this.last_tot_records != null)\n\t\t\t\tthis.refresh(this.last_session_start_ts, this.last_dataset_name, this.last_check_category, this.last_failed_records, this.last_tot_records)\n\t\t}\n\t\t\n\t\tthis.records.onclick = () => {\n\t\t\tthis.current_tab = 'records'\n\t\t\tif (this.last_session_start_ts != null && this.last_dataset_name != null && this.last_check_category != null\n\t\t\t\t&& this.last_failed_records != null && this.last_tot_records != null)\n\t\t\t\tthis.refresh(this.last_session_start_ts, this.last_dataset_name, this.last_check_category, this.last_failed_records, this.last_tot_records)\n\t\t}\n\t\t\n\t\tthis.canvas = cs_cast(HTMLCanvasElement, this.sroot.querySelector('canvas'));\n\t\t\n\t\t// this.info_and_settings = cs_cast(GeneralInfoAndSettings, this.sroot.querySelector('cs-general-info-and-settings'));\n\n\n\t}\n\t\n\textractHumanReadableName(record_jsonpath: string, json: string): string\n\t{\n\t\tlet ret = '';\n\t\tfor (let fn of ['sname', 'mvalidtime', 'mvalue', 'AccoDetail.de.Name', 'Detail.de.Title'])\n\t\t{\n\t\t\tconst fn_parts = fn.split('.')\n\t\t\tlet val = JSON.parse(json)\n\t\t\tfor (let p of fn_parts)\n\t\t\t{\n\t\t\t\tval = val[p]\n\t\t\t\tif (val === undefined)\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t// const val = start[fn] \n\t\t\tif (val !== undefined)\n\t\t\t\tret += (ret === '' ? '' : ', ') + fn + '=' + JSON.stringify(val)\n\t\t}\n\t\tif (ret == '')\n\t\t\tret = record_jsonpath\n\t\treturn ret;\n\t}\n\t\n\tgroupRecords(list: {record_json: string}[]): {[k:string]: any[]}\n\t{\n\t\tconst groupBy: {[k:string]: any[]} = {}\n\t\tfor (let k = 0; k < list.length; k++)\n\t\t{\n\t\t\tconst json = JSON.parse(list[k].record_json);\n\t\t\tlet sname = json['sname'];\n\t\t\tif (typeof sname !== 'string')\n\t\t\t\tsname = ''\n\t\t\tlet prev_arr = groupBy[sname]\n\t\t\tprev_arr = prev_arr === undefined ? [] : prev_arr\n\t\t\tprev_arr.push(list[k])\n\t\t\tgroupBy[sname] = prev_arr\n\t\t}\n\t\treturn groupBy; \n\t}\n\t\n\tasync refresh(p_session_start_ts: string, p_dataset_name: string, p_category_name: string, p_failed_records: number, p_tot_records: number) {\n\t\t\n\t\tthis.last_session_start_ts = p_session_start_ts\n\t\tthis.last_dataset_name = p_dataset_name\n\t\tthis.last_check_category = p_category_name\n\t\tthis.last_failed_records = p_failed_records\n\t\tthis.last_tot_records = p_tot_records\n\t\t\n\t\t// this.info_and_settings.refresh(p_session_start_ts, p_dataset_name, p_failed_records, p_tot_records)\n\t\t\n\t\tconsole.log(p_session_start_ts)\n\t\tconsole.log(p_dataset_name)\n\t\tconsole.log(p_category_name);\n\t\t\n\t\t(async () => {\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\tconst data = await API3.list__catchsolve_noiodh__test_dataset_history_vw({\n\t\t\t\t\t\tdataset_name: this.last_dataset_name!,\n\t\t\t\t\t\tcheck_category: this.last_check_category!\n\t\t\t\t\t})\n\t\t\t\t\t\n\t\t\t\t\t// const goodarr  = []\n\t\t\t\t\t// const failarr  = []\n\t\t\t\t\t\n\t\t\t\t\tconst labels   = []\n\t\t\t\t\tconst datasets = []\n\t\t\t\t\t\n\t\t\t\t\tfor (let x = 0; x < data.length; x++)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst row = data[x]\n\t\t\t\t\t\tlabels.push(row.session_start_ts.slice(0,16).replace('T', ' '))\n\t\t\t\t\t\tconst check_stats = JSON.parse(row.check_stats);\n\t\t\t\t\t\tconsole.log(check_stats)\n\t\t\t\t\t\tfor (let c = 0; c < check_stats.length; c++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst check_stat = check_stats[c]\n\t\t\t\t\t\t\tlet found = false;\n\t\t\t\t\t\t\tfor (let d = 0; d < datasets.length; d++)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (datasets[d].label == check_stat.check_name)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tdatasets[d].data.push(check_stat.failed_recs)\n\t\t\t\t\t\t\t\t\tfound = true\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!found)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdatasets.push({\n\t\t\t\t\t\t\t\t\tlabel: check_stat.check_name,\n\t\t\t\t\t\t\t\t\tdata: [check_stat.failed_recs],\n\t\t\t\t\t\t\t\t\tfill: false,\n\t\t\t\t\t\t\t\t\tbackgroundColor: '#aaa',\n\t\t\t\t\t\t\t\t\tborderColor: '#aaa',\n\t\t\t\t\t\t\t\t\ttension: 0.1\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t/*\n\t\t\t\t\t\tgoodarr.push(data[x].tested_records - data[x].failed_recs)\n\t\t\t\t\t\tfailarr.push(data[x].failed_recs)\n\t\t\t\t\t\t */\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tconst chartjs = await this.chartjs_promise\n\t\t\t\t\tchartjs.data.labels = labels\n\t\t\t\t\tchartjs.data.datasets = datasets\n\t\t\t\t\t\n\t\t\t\t\t/*\n\t\t\t\t\tchartjs.data.datasets = [\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: 'fail trend',\n\t\t\t\t\t\t\t\t\t\t\t\t\tdata: failarr,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill: false,\n\t\t\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: '#222',\n\t\t\t\t\t\t\t\t\t\t\t\t\tborderColor: '#222',\n\t\t\t\t\t\t\t\t\t\t\t\t\ttension: 0.1\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: 'total trend',\n\t\t\t\t\t\t\t\t\t\t\t\t\tdata: goodarr,\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill: false,\n\t\t\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: '#aaa',\n\t\t\t\t\t\t\t\t\t\t\t\t\tborderColor: '#aaa',\n\t\t\t\t\t\t\t\t\t\t\t\t\ttension: 0.1\n\t\t\t\t\t\t\t\t\t\t\t\t},\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t*/\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\tchartjs.update()\n\t\t\t\t\t\t\t\t\t\n\t\t})();\n\t\t\n\t\tconst category = cs_cast(DatasetIssueCategoryComponent, this.sroot.querySelector('cs-dataset-issue-category'))\n\t\tcategory.hideMoreDiv()\n\t\tcategory.refresh(\n\t\t{\n\t\t\tdataset_name: p_dataset_name,\n\t\t\tsession_start_ts: p_session_start_ts,\n\t\t\tcheck_category: p_category_name,\n\t\t\tfailed_records: p_failed_records,\n\t\t\ttot_records: p_tot_records\n\t\t})\n\t\t\n\t\tthis.container.textContent = ''\n\t\t\n\t\tif (this.current_tab === 'issues')\n\t\t{\n\t\t\tthis.records.classList.remove('selected')\n\t\t\tthis.issues.classList.add('selected')\n\t\t\t\n\t\t\tconst loader = new Loader();\n\t\t\tthis.container.appendChild(loader)\n\t\t\n\t\t\tconst json = await API3.list__catchsolve_noiodh__test_dataset_check_category_check_name_record_record_failed_vw({\n\t\t\t\tsession_start_ts: p_session_start_ts,\n\t\t\t\tdataset_name: p_dataset_name,\n\t\t\t\tcheck_category: p_category_name\n\t\t\t})\n\n\t\t\tloader.remove();\n\t\n\t\t\tfor (let i = 0; i < json.length; i++)\n\t\t\t{\n\t\t\t\tconst issue = json[i]\n\t\t\t\t// console.log(issue)\n\t\t\t\tconst section = new OpenCloseSection()\n\t\t\t\tsection.refresh(issue.check_name, 'failed: ' + issue.nr_records + ' records')\n\t\t\t\tthis.container.appendChild(section)\n\t\t\t\t\n\t\t\t\tsection.onopen = async () => {\n\t\t\t\t\t\n\t\t\t\t\tconst moreButton = document.createElement('button')\n\t\t\t\t\tmoreButton.classList.add('nextpagebutton')\n\t\t\t\t\tmoreButton.textContent = 'next 100'\n\t\t\t\t\tsection.addElementToContentArea(moreButton)\n\t\t\t\t\tlet list_offset = 0\n\t\t\t\t\tconst nextFun = async () => {\n\t\t\t\t\t\t\n\t\t\t\t\t\tconst json2 = await API3.list__catchsolve_noiodh__test_dataset_record_check_failed({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsession_start_ts: p_session_start_ts,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdataset_name: p_dataset_name,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcheck_category: p_category_name,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcheck_name: issue.check_name,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlimit: 100,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\toffset: list_offset\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\t// const list = groupBy[keys[0]]\n\t\t\t\t\t\tfor (let k2 = 0; k2 < json2.length; k2++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst sectionRow2 = new SectionRow();\n\t\t\t\t\t\t\t// section.addElementToContentArea(sectionRow2)\n\t\t\t\t\t\t\tmoreButton.parentElement!.insertBefore(sectionRow2, moreButton)\n\t\t\t\t\t\t\tsectionRow2.refresh(this.extractHumanReadableName(json2[k2].record_jsonpath, json2[k2].record_json))\n\t\t\t\t\t\t\t// sectionRow2.refresh(json2[k2].problem_hint)\n\t\t\t\t\t\t\tsectionRow2.onclick = () => {\n\t\t\t\t\t\t\t\talert(json2[k2].record_json)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlist_offset += 100\n\t\t\t\t\t}\n\t\t\t\t\tmoreButton.onclick = nextFun\n\t\t\t\t\tnextFun()\n\t\t\t\t\t\n\t\t\t\t\t/*\n\t\t\t\t\t//console.log('sezione aperta, ricarico!')\n\t\t\t\t\tconst json2 = await API3.list__catchsolve_noiodh__test_dataset_record_check_failed({\n\t\t\t\t\t\t\t\tsession_start_ts: p_session_start_ts,\n\t\t\t\t\t\t\t\tdataset_name: p_dataset_name,\n\t\t\t\t\t\t\t\tcheck_category: p_category_name,\n\t\t\t\t\t\t\t\tcheck_name: issue.check_name\n\t\t\t\t\t});\n\t\t\t\t\tconst groupBy = this.groupRecords(json2)\n\t\t\t\t\tconst keys = Object.keys(groupBy)\n\t\t\t\t\tconsole.log(keys)\n\t\t\t\t\tif (keys.length == 1 && keys[0] == '')\n\t\t\t\t\t{\n\t\t\t\t\t\tconst moreButton = document.createElement('button')\n\t\t\t\t\t\tmoreButton.textContent = 'next 10'\n\t\t\t\t\t\tsection.addElementToContentArea(moreButton)\n\t\t\t\t\t\tconst nextFun = () => {\n\t\t\t\t\t\t\tconst list = groupBy[keys[0]]\n\t\t\t\t\t\t\tfor (let k2 = 0; k2 < list.length; k2++)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst sectionRow2 = new SectionRow();\n\t\t\t\t\t\t\t\tsection.addElementToContentArea(sectionRow2)\n\t\t\t\t\t\t\t\t// sectionRow2.refresh(this.extractHumanReadableName(list[k2].record_jsonpath, list[k2].record_json))\n\t\t\t\t\t\t\t\tsectionRow2.refresh(list[k2].problem_hint)\n\t\t\t\t\t\t\t\tsectionRow2.onclick = () => {\n\t\t\t\t\t\t\t\t\talert(list[k2].record_json)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmoreButton.onclick = nextFun\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tfor (let k = 0; k < keys.length; k++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst sectionRow = new OpenCloseSection();\n\t\t\t\t\t\t\tsection.addElementToContentArea(sectionRow)\n\t\t\t\t\t\t\tsectionRow.refresh(keys[k], '' + groupBy[keys[k]].length + ' records')\n\t\t\t\t\t\t\tsectionRow.onclick = () => {\n\t\t\t\t\t\t\t\tconst list = groupBy[keys[k]]\n\t\t\t\t\t\t\t\tconsole.log(list)\n\t\t\t\t\t\t\t\tfor (let k2 = 0; k2 < list.length; k2++)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tconst sectionRow2 = new SectionRow();\n\t\t\t\t\t\t\t\t\tsectionRow.addElementToContentArea(sectionRow2)\n\t\t\t\t\t\t\t\t\t// sectionRow2.refresh(this.extractHumanReadableName(list[k2].record_jsonpath, list[k2].record_json))\n\t\t\t\t\t\t\t\t\tsectionRow2.refresh(list[k2].problem_hint)\n\t\t\t\t\t\t\t\t\tsectionRow2.onclick = () => {\n\t\t\t\t\t\t\t\t\t\talert(list[k2].record_json)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t*/\n\t\t\t\t}\n\t\t\t}\n\t\t\t\t\t\n\t\t}\n\t\t\n\t\t\n\t\tif (this.current_tab === 'records')\n\t\t{\n\t\t\tthis.issues.classList.remove('selected')\n\t\t\tthis.records.classList.add('selected')\n\t\t\t\n\t\t\tconst moreButton = document.createElement('button')\n\t\t\tmoreButton.classList.add('nextpagebutton')\n\t\t\tmoreButton.textContent = 'next 100'\n\t\t\tthis.container.appendChild(moreButton)\n\t\t\tlet list_offset = 0\n\t\t\tconst nextFun = async () => {\n\n\t\t\t\tconst loader = new Loader();\n\t\t\t\tthis.container.appendChild(loader)\n\n\t\t\t\tconst list = await API3.list__catchsolve_noiodh__test_dataset_check_category_record_jsonpath_failed_vw({\n\t\t\t\t\tsession_start_ts: p_session_start_ts,\n\t\t\t\t\tdataset_name: p_dataset_name,\n\t\t\t\t\tcheck_category: p_category_name,\n\t\t\t\t\toffset: list_offset,\n\t\t\t\t\tlimit: 100\n\t\t\t\t});\n\t\t\t\tloader.remove();\n\t\t\t\tfor (let k2 = 0; k2 < list.length; k2++)\n\t\t\t\t{\n\t\t\t\t\tconst sectionRow2 = new OpenCloseSection();\n\t\t\t\t\t// this.container.appendChild(sectionRow2)\n\t\t\t\t\tmoreButton.parentElement!.insertBefore(sectionRow2, moreButton)\n\t\t\t\t\tsectionRow2.refresh(this.extractHumanReadableName(list[k2].record_jsonpath, list[k2].record_json), '' + list[k2].nr_check_names + ' check failed')\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\tsectionRow2.onclick = async () => {\n\t\t\t\t\t\t\tconst json2 = await API3.list__catchsolve_noiodh__test_dataset_record_check_failed({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsession_start_ts: p_session_start_ts,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdataset_name: p_dataset_name,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcheck_category: p_category_name,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\trecord_jsonpath: list[k2].record_jsonpath\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\tfor (let k = 0; k < json2.length; k++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst sectionRow = new SectionRow();\n\t\t\t\t\t\t\tsectionRow2.addElementToContentArea(sectionRow)\n\t\t\t\t\t\t\tsectionRow.refresh(\"failed: \" + json2[k].check_name)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlist_offset += 100\n\t\t\t}\n\t\t\tmoreButton.onclick = nextFun\n\t\t\tnextFun()\n\n\t\n\t\t\t/*\n\t\t\tconst groupBy = this.groupRecords(json)\n\t\t\tconst keys = Object.keys(groupBy)\n\t\t\tconsole.log(keys)\n\t\t\tif (keys.length == 1 && keys[0] == '')\n\t\t\t{\n\t\t\t\tconst list = groupBy[keys[0]]\n\t\t\t\tfor (let k2 = 0; k2 < list.length; k2++)\n\t\t\t\t{\n\t\t\t\t\tconst sectionRow2 = new OpenCloseSection();\n\t\t\t\t\tthis.container.appendChild(sectionRow2)\n\t\t\t\t\tsectionRow2.refresh(this.extractHumanReadableName(list[k2].record_jsonpath, list[k2].record_json), '' + list[k2].nr_check_names + ' check failed')\n\t\t\t\t\tsectionRow2.onclick = async () => {\n\t\t\t\t\t\tconst json2 = await API3.list__catchsolve_noiodh__test_dataset_record_check_failed({\n\t\t\t\t\t\t\t\t\t\t\t\t\tsession_start_ts: p_session_start_ts,\n\t\t\t\t\t\t\t\t\t\t\t\t\tdataset_name: p_dataset_name,\n\t\t\t\t\t\t\t\t\t\t\t\t\tcheck_category: p_category_name,\n\t\t\t\t\t\t\t\t\t\t\t\t\trecord_jsonpath: list[k2].record_jsonpath\n\t\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\tfor (let k = 0; k < json2.length; k++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst sectionRow = new SectionRow();\n\t\t\t\t\t\t\tsectionRow2.addElementToContentArea(sectionRow)\n\t\t\t\t\t\t\tsectionRow.refresh(\"failed: \" + json2[k].check_name)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor (let k = 0; k < keys.length; k++)\n\t\t\t\t{\n\t\t\t\t\tconst sectionRow = new OpenCloseSection();\n\t\t\t\t\tthis.container.appendChild(sectionRow)\n\t\t\t\t\tsectionRow.refresh(keys[k], '' + groupBy[keys[k]].length + ' records')\n\t\t\t\t\tsectionRow.onclick = () => {\n\t\t\t\t\t\tconst list = groupBy[keys[k]]\n\t\t\t\t\t\tconsole.log(list)\n\t\t\t\t\t\tfor (let k2 = 0; k2 < list.length; k2++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst sectionRow2 = new OpenCloseSection();\n\t\t\t\t\t\t\tsectionRow.addElementToContentArea(sectionRow2)\n\t\t\t\t\t\t\tsectionRow2.refresh(this.extractHumanReadableName(list[k2].record_jsonpath, list[k2].record_json), list[k2].nr_check_names)\n\t\t\t\t\t\t\tsectionRow2.onclick = async (e) => {\n\t\t\t\t\t\t\t\te.stopPropagation()\n\t\t\t\t\t\t\t\tconst json2 = await API3.list__catchsolve_noiodh__test_dataset_record_check_failed({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsession_start_ts: p_session_start_ts,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdataset_name: p_dataset_name,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcheck_category: p_category_name,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trecord_jsonpath: list[k2].record_jsonpath\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tfor (let k = 0; k < json2.length; k++)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tconst sectionRow = new SectionRow();\n\t\t\t\t\t\t\t\t\tsectionRow2.addElementToContentArea(sectionRow)\n\t\t\t\t\t\t\t\t\tsectionRow.refresh(json2[k].check_name)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t */\n\t\t}\n\t}\n}\n\ncustomElements.define('cs-dataset-issues-detail', DatasetIssuesDetail)\n", "<!--\n  SPDX-FileCopyrightText: 2025 Catch Solve di Davide Montesin\n\n  SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<style>\n    @import url(\"anywhere.css\");\n    @import url(\"all-webcomponent.css\");\n\n\t:host {\n\t}\n\t.category {\n\t\tborder: 1px solid gray;\n\t\twidth: 12rem;\n\t\tdisplay: inline-block;\n\t\tmargin: 1rem;\n\t}\n\t.category > img {\n\t\twidth: 100%;\n\t}\n\t.category .category_name {\n\t\tfont-weight: bold;\n\t}\n\t.frame {\n\t\tdisplay: flex;\n\t\talign-items: start;\n\t}\n\t.frame .content {\n\t\tflex-grow: 100;\n\t\tdisplay: flex;\n\t\talign-items: start;\n\t}\n\t.chartdiv {\n\t\twidth:  100px;\n\t\theight: 100px;\n\t\tmargin: auto;\n\t}\n\tdetails > *:nth-child(even) {\n\t  background-color: #ccc;\n\t}\n\t\n\t.content > * {\n\t\tmargin-top: 1rem;\n\t\tmargin-left: 1rem;\n\t}\n\t.noissues {\n\t\tdisplay: none;\n\t}\n</style>\n<div class=\"frame\">\n\t<div class=\"noissues\">sound good, no problems found here!</div>\n\t<div class=\"content\"></div>\n\t<!--<cs-general-info-and-settings></cs-general-info-and-settings>-->\n\t<!--<img src=\"kpi-general-info.png\">-->\n</div>\n", "// SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport { CommonWebComponent } from \"./CommonWebComponent.js\";\nimport { cs_cast, throwNPE } from \"./quality.js\";\nimport {API3, catchsolve_noiodh__test_dataset_check_category_failed_recors_vw__row} from './api/api3.js';\nimport { OpenCloseSection } from \"./OpenCloseSection.js\";\nimport { SectionRow } from \"./SectionRow.js\";\nimport { Loader } from \"./Loader.js\";\nimport { LabelAndData } from \"./LabelAndData.js\";\nimport { DatasetIssueCategoryComponent } from \"./DatasetIssueCategoryComponent.js\";\nimport { GeneralInfoAndSettings } from \"./GeneralInfoAndSettings.js\";\nimport template from './DatasetIssuesByCategories.html?raw'\n\nexport class DatasetIssuesByCategories extends CommonWebComponent\n{\n\t\n\tcontent\n\t\n\tconnected_promise\n\tconnected_func: (s: null) => void = s => null\n\t\n\tconnectedCallback()\n\t{\n\t\tconsole.log('connected')\n\t\tthis.connected_func(null)\n\t}\n\t\n\t// info_and_settings\n\t\n\tnoissues\n\t\n\tconstructor() {\n\t\tsuper(template)\n\t\tthis.connected_promise = new Promise(s => this.connected_func = s)\n\t\tthis.content = cs_cast(HTMLElement, this.sroot.querySelector('.content'));\n\t\t// this.info_and_settings = cs_cast(GeneralInfoAndSettings, this.sroot.querySelector('cs-general-info-and-settings'));\n\n\t\tthis.noissues = cs_cast(HTMLDivElement, this.sroot.querySelector('.noissues'))\n\t}\n\t\n\tasync refresh(p_session_start_ts: string, p_dataset_name: string, p_failed_records: number, p_tot_records: number) {\n\t\t\n\t\t// this.info_and_settings.refresh(p_session_start_ts, p_dataset_name, p_failed_records, p_tot_records);\n\t\t\n\t\tconst loader = new Loader()\n\t\tthis.content.appendChild(loader)\n\t\tconst resp = await API3.list__catchsolve_noiodh__test_dataset_check_category_failed_recors_vw({\n\t\t\tsession_start_ts: p_session_start_ts,\n\t\t\tdataset_name : p_dataset_name\n\t\t})\n\t\tloader.remove()\n\t\tconsole.log(resp) \n\t\tfor (let i = 0; i < resp.length; i++)\n\t\t{\n\t\t\tconst category = new DatasetIssueCategoryComponent();\n\t\t\tthis.content.appendChild(category);\n\t\t\tcategory.refresh(resp[i])\n\t\t}\n\t\tthis.noissues.style.display = resp.length == 0 ? 'block' : 'none';\n\t\t\t\n\t}\n\n\n}\n\ncustomElements.define('cs-dataset-categories', DatasetIssuesByCategories)\n", "export class InvalidTokenError extends Error {\n}\nInvalidTokenError.prototype.name = \"InvalidTokenError\";\nfunction b64DecodeUnicode(str) {\n    return decodeURIComponent(atob(str).replace(/(.)/g, (m, p) => {\n        let code = p.charCodeAt(0).toString(16).toUpperCase();\n        if (code.length < 2) {\n            code = \"0\" + code;\n        }\n        return \"%\" + code;\n    }));\n}\nfunction base64UrlDecode(str) {\n    let output = str.replace(/-/g, \"+\").replace(/_/g, \"/\");\n    switch (output.length % 4) {\n        case 0:\n            break;\n        case 2:\n            output += \"==\";\n            break;\n        case 3:\n            output += \"=\";\n            break;\n        default:\n            throw new Error(\"base64 string is not of the correct length\");\n    }\n    try {\n        return b64DecodeUnicode(output);\n    }\n    catch (err) {\n        return atob(output);\n    }\n}\nexport function jwtDecode(token, options) {\n    if (typeof token !== \"string\") {\n        throw new InvalidTokenError(\"Invalid token specified: must be a string\");\n    }\n    options || (options = {});\n    const pos = options.header === true ? 0 : 1;\n    const part = token.split(\".\")[pos];\n    if (typeof part !== \"string\") {\n        throw new InvalidTokenError(`Invalid token specified: missing part #${pos + 1}`);\n    }\n    let decoded;\n    try {\n        decoded = base64UrlDecode(part);\n    }\n    catch (e) {\n        throw new InvalidTokenError(`Invalid token specified: invalid base64 for part #${pos + 1} (${e.message})`);\n    }\n    try {\n        return JSON.parse(decoded);\n    }\n    catch (e) {\n        throw new InvalidTokenError(`Invalid token specified: invalid json for part #${pos + 1} (${e.message})`);\n    }\n}\n", "<!--\n  SPDX-FileCopyrightText: 2025 Catch Solve di Davide Montesin\n\n  SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<link rel=\"stylesheet\" href=\"index.css\">\n<style>\n    @import url(\"all-webcomponent.css\");\n\n\t@import url(\"anywhere.css\");\n\t:host {\n\t\tposition: relative;\n\t\tdisplay: inline-block;\n\t\tfont-family: sans-serif;\n\t}\n\t.display-none {\n\t\tdisplay: none;\n\t}\n\t.auth-container {\n\t\tposition: relative;\n\t}\n\t.user-button {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tgap: 0.35rem;\n\t}\n\t.openclose-icon {\n\t\tdisplay: inline-block;\n\t\twidth: 0.8rem;\n\t\theight: 0.8rem;\n\t\tbackground-color: currentColor;\n\t\t-webkit-mask: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12'%3E%3Cpath d='M2 4l4 4 4-4' fill='none' stroke='%23000' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E\") center / contain no-repeat;\n\t\tmask: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12'%3E%3Cpath d='M2 4l4 4 4-4' fill='none' stroke='%23000' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E\") center / contain no-repeat;\n\t}\n\t.user-menu {\n\t\tposition: absolute;\n\t\ttop: 100%;\n\t\tright: 0;\n\t\tbackground: white;\n\t\tborder: 1px solid #ccc;\n\t\tbox-shadow: 0 2px 6px rgba(0,0,0,0.2);\n\t\tdisplay: none;\n\t\tmin-width: 120px;\n\t\tz-index: 10;\n\t}\n\t.user-menu.show {\n\t\tdisplay: block;\n\t}\n</style>\n<div class=\"unauthenticated display-none\">\n\t<button>Login</button>\n</div>\n<div class=\"authenticated display-none auth-container\">\n\t<button class=\"user-button\"><span class=\"user-label\">User</span><span class=\"openclose-icon\"></span></button>\n\t<select></select>\n\t<div class=\"user-menu\">\n\t\t<button class=\"logout-button\">Logout</button>\n\t\t<!-- Altre voci future -->\n\t</div>\n</div>\n", "// SPDX-FileCopyrightText: 2025 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport { CommonWebComponent } from './CommonWebComponent.js';\nimport { jwtDecode } from 'jwt-decode';\nimport { kc } from './auth.js';\nimport { API3 } from './api/api3.js';\nimport template from './AuthComponent.html?raw'\n\n\nexport class AuthComponent extends CommonWebComponent {\n\n\tdiv_unauthenticated\n\tdiv_authenticated\n\n\tbutton_login\n\tuser_button\n\tuser_label\n\tuser_menu\n\n\tselect_role\n\n\tconstructor() {\n\t\tsuper(template);\n\n\t\tthis.div_unauthenticated = this.sroot.querySelector('.unauthenticated')!;\n\t\tthis.div_authenticated = this.sroot.querySelector('.authenticated')!;\n\t\tthis.button_login = this.sroot.querySelector('.unauthenticated button') as HTMLButtonElement;\n\t\tthis.user_button = this.sroot.querySelector('.user-button') as HTMLButtonElement;\n\t\tthis.user_label = this.sroot.querySelector('.user-label') as HTMLSpanElement;\n\t\tthis.user_menu = this.sroot.querySelector('.user-menu')!;\n\n\t\t(this.button_login as HTMLButtonElement).onclick = async () => {\n\t\t\tkc.login();\n\t\t};\n\n\t\t(this.user_button as HTMLButtonElement).onclick = (e: MouseEvent) => {\n\t\t\te.stopPropagation(); // \uD83D\uDD25 blocks immediate closure\n\t\t\tthis.user_menu.classList.toggle('show');\n\t\t};\n\n\t\tconst logout_button = this.sroot.querySelector('.logout-button') as HTMLButtonElement;\n\t\tlogout_button.onclick = async () => {\n\t\t\tkc.logout();\n\t\t};\n\n\t\t// Listener globale per chiudere il menu se si clicca fuori\n\t\tdocument.addEventListener('click', (e) => {\n\t\t\tif (!this.sroot.contains(e.target as Node)) {\n\t\t\t\tthis.user_menu.classList.remove('show');\n\t\t\t}\n\t\t});\n\n\t\tthis.select_role = this.sroot.querySelector('select') as HTMLSelectElement;\n\n\t\tthis.select_role.onchange = (e) => {\n\t\t\tconst selected_role = (e.target as HTMLSelectElement).value;\n\t\t\tsessionStorage.setItem('used_key_role', selected_role);\n\t\t\tlocation.reload(); // ricarica la pagina per applicare il nuovo ruolo\n\t\t};\n\n\t\tthis.refreshLoginState();\n\t}\n\n\tasync refreshLoginState() {\n\t\tif (kc.authenticated) {\n\t\t\tconst token = kc.token!;\n\t\t\tconst decoded: any = jwtDecode(token);\n\t\t\tconst username = decoded.preferred_username || decoded.name || 'User';\n\t\t\tthis.user_label.textContent = username;\n\t\t\t\n\t\t\tthis.div_unauthenticated.classList.add('display-none');\n\t\t\tthis.div_authenticated.classList.remove('display-none');\n\t\t\tconst roles = await API3.get_auth_user_roles();\n\t\t\tthis.select_role.textContent = '';\n\t\t\tfor (const role of roles) {\n\t\t\t\tconst option = document.createElement('option');\n\t\t\t\toption.value = role;\n\t\t\t\toption.textContent = role;\n\t\t\t\tthis.select_role.appendChild(option);\n\t\t\t}\n\t\t\tthis.select_role.value = sessionStorage.getItem('used_key_role')!\n\t\t} else {\n\t\t\tthis.div_authenticated.classList.add('display-none');\n\t\t\tthis.div_unauthenticated.classList.remove('display-none');\n\t\t}\n\t}\n}\n\ncustomElements.define('cs-auth-component', AuthComponent);\n", "<!--\n  SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n\n  SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<style>\n    @import url(\"anywhere.css\");\n    @import url(\"all-webcomponent.css\");\n\n    :host {\n        display: block;\n        padding: 24px;\n        color: #141414;\n        background: transparent;\n        font-family: \"IBM Plex Sans\", \"Trebuchet MS\", \"Verdana\", sans-serif;\n        height: 100%;\n        overflow: scroll;\n    }\n\n    .checks.isnotvalid {\n        border: 1px solid red;\n    }\n\n    .form-is-valid {\n        color: #b91c1c;\n        font-size: 0.9rem;\n    }\n\n    .form-shell {\n        max-width: 980px;\n        margin: 0 auto;\n        display: flex;\n        flex-direction: column;\n        gap: 16px;\n    }\n\n    .form-header {\n        display: flex;\n        align-items: flex-end;\n        gap: 12px;\n        padding: 12px 4px;\n        border-bottom: 3px solid #111111;\n    }\n\n    .form-progress {\n        font-size: 0.9rem;\n        color: #6b7280;\n    }\n\n    .form-title {\n        font-size: 1.4rem;\n        font-weight: 700;\n        letter-spacing: -0.02em;\n    }\n\n    .section {\n        background: #ffffff;\n        border: 1px solid #e5e7eb;\n        border-radius: 0;\n        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);\n        padding: 16px;\n    }\n\n    .section-title {\n        font-size: 0.9rem;\n        font-weight: 700;\n        text-transform: uppercase;\n        letter-spacing: 0.08em;\n        color: #111111;\n        margin-bottom: 12px;\n    }\n\n    .section-title .step {\n        display: inline-block;\n        width: 22px;\n        height: 22px;\n        line-height: 22px;\n        text-align: center;\n        border-radius: 50%;\n        background: #111111;\n        color: #ffffff;\n        font-size: 0.8rem;\n        margin-right: 8px;\n    }\n\n    .section-body {\n        display: flex;\n        flex-direction: column;\n        gap: 12px;\n    }\n\n    .form-row {\n        display: grid;\n        grid-template-columns: 170px 1fr;\n        gap: 12px;\n        align-items: center;\n    }\n\n    .form-label {\n        font-weight: 600;\n        color: #111111;\n    }\n\n    .row-inline {\n        display: flex;\n        gap: 10px;\n        align-items: center;\n    }\n\n    cs-auto-complete,\n    .dashboard-name {\n        width: 100%;\n    }\n\n    .dashboard-name {\n        padding: 10px 12px;\n        border: 1px solid #d1d5db;\n        border-radius: 0;\n        background: #ffffff;\n        font-size: 0.95rem;\n    }\n\n    .pill {\n        display: inline-flex;\n        align-items: center;\n        padding: 6px 10px;\n        border-radius: 0;\n        border: 1px solid #111111;\n        font-size: 0.8rem;\n        font-weight: 600;\n        text-transform: uppercase;\n        letter-spacing: 0.04em;\n        white-space: nowrap;\n    }\n\n    .checks-section .checks {\n        display: flex;\n        flex-direction: column;\n        gap: 12px;\n    }\n\n    .checks-toolbar {\n        display: flex;\n        align-items: center;\n        gap: 12px;\n        flex-wrap: wrap;\n    }\n\n    .checks-footer {\n        display: flex;\n        justify-content: flex-end;\n    }\n\n    .no-field-names {\n        color: #6b7280;\n        font-size: 0.85rem;\n    }\n\n    button.add-check,\n    button.save-dashboard {\n        border: none;\n        background: #111111;\n        color: #ffffff;\n        border-radius: 0;\n        padding: 10px 16px;\n        font-weight: 700;\n        letter-spacing: 0.02em;\n        cursor: pointer;\n    }\n\n    button.save-dashboard.primary-action {\n        width: 100%;\n        padding: 14px 18px;\n        font-size: 1rem;\n    }\n\n    .footer {\n        display: flex;\n        align-items: center;\n        gap: 12px;\n    }\n\n    [data-isvisible=\"false\"] {\n        display: none;\n    }\n\n    @media (max-width: 720px) {\n        :host {\n            padding: 16px;\n        }\n\n        .form-row {\n            grid-template-columns: 1fr;\n        }\n\n        .row-inline {\n            flex-direction: column;\n            align-items: stretch;\n        }\n\n        .footer {\n            flex-direction: column;\n            align-items: stretch;\n        }\n    }\n\n</style>\n    <div class=\"pleasewait\">\n        <div class=\"pleasewait-box\">\n            <div class=\"pleasewait-message\">elaboration in progress</div>\n            <button class=\"pleasewait-ok\" type=\"button\">ok</button>\n        </div>\n    </div>\n    <button class=\"testing\" style=\"display: none\">test #1</button>\n    <div class=\"form-shell\">\n        <div class=\"form-header\">\n            <div class=\"form-title\">Dataset settings</div>\n        </div>\n\n        <div class=\"section\">\n            <div class=\"section-title\"><span class=\"step\">1.</span> Dashboard name</div>\n            <div class=\"section-body\">\n                <div class=\"form-row\">\n                    <span class=\"form-label\">Name</span>\n                    <input class=\"dashboard-name\" type=\"text\" data-testid=\"input-dashboard-name\">\n                </div>\n            </div>\n        </div>\n\n        <div class=\"section\">\n            <div class=\"section-title\"><span class=\"step\">2.</span> Data provider</div>\n            <div class=\"section-body\">\n                <div class=\"form-row\">\n                    <span class=\"form-label\">Data provider</span>\n                    <cs-auto-complete\n                        class=\"dataproviders\"\n                        data-testid=\"select-dataprovides\"\n                    ></cs-auto-complete>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"section\">\n            <div class=\"section-title\"><span class=\"step\">3.</span> Dataset</div>\n            <div class=\"section-body\">\n                <div class=\"form-row\">\n                    <span class=\"form-label\">Dataset</span>\n                    <div class=\"row-inline\">\n                        <cs-auto-complete\n                            class=\"datasets\"\n                            data-testid=\"select-datasets\"\n                        ></cs-auto-complete>\n                        <span class=\"dataset-type pill\"></span>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"section\">\n            <div class=\"section-title\"><span class=\"step\">4.</span> Timeseries</div>\n            <div class=\"section-body\">\n                <div class=\"form-row timeseries-na-row\">\n                    <span class=\"form-label\">Timeseries</span>\n                    <span class=\"timeseries-na\">N/A</span>\n                </div>\n                <div class=\"form-row timeseries-active-row\">\n                    <span class=\"form-label\">Status</span>\n                    <cs-auto-complete\n                        class=\"timeseries-active-status\"\n                    ></cs-auto-complete>\n                </div>\n                <div class=\"form-row timeseries_div\">\n                    <span class=\"form-label\">Datatype</span>\n                    <cs-auto-complete\n                        class=\"timeseries-datatype\"\n                        data-testid=\"select-datatype\"\n                    ></cs-auto-complete>\n                </div>\n                <div class=\"form-row period_div\">\n                    <span class=\"form-label\">Period</span>\n                    <cs-auto-complete\n                        class=\"timeseries-mperiod\"\n                    ></cs-auto-complete>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"section checks-section\">\n            <div class=\"section-title\"><span class=\"step\">5.</span> Checks</div>\n            <div class=\"section-body\">\n                <div class=\"checks-toolbar\">\n                    <span class=\"no-field-names\">no metadata found for this dataset</span>\n                </div>\n                <div class=\"checks flex-col gap-medium\"></div>\n                <div class=\"checks-footer\">\n                    <button class=\"add-check\">Add check</button>\n                </div>\n            </div>\n        </div>\n\n            <span class=\"form-is-valid\">?</span>\n            <button class=\"save-dashboard primary-action\">save dashboard</button>\n    </div>\n    <!--\n    <img src=\"new-dataset.png\">\n    -->\n", "<!--\n  SPDX-FileCopyrightText: 2025 Catch Solve di Davide Montesin\n\n  SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<style>\n    @import url(\"anywhere.css\");\n    @import url(\"all-webcomponent.css\");\n\n    :host(.invalid):not(.empty-value) input {\n        border: 2px solid red;\n    }\n\n\n    :host(.invalid.empty-value) input {\n        background-color: rgb(255, 255, 194);\n    }\n\n    \n\n    :host {\n        position: relative;\n    }\n\n    .list {\n        position: absolute;\n        max-height: 16em;\n        overflow-y: scroll;\n        overscroll-behavior: none;\n        background-color: white;\n        z-index: 2;\n    }\n\n    .list > div {\n        min-height: 1em;\n    }\n\n    .option {\n        border: 1px dotted var(--quaternary-color)\n    }\n\n    .option > div {\n        padding: 8px;\n        cursor: pointer;\n    }\n\n    .option > div:not(:last-child) {\n        border-bottom: 1px solid var(--quaternary-color)\n    }\n\n    .openclose {\n        cursor: pointer;\n        display: inline-flex;\n        align-items: center;\n        justify-content: center;\n        width: 0.9rem;\n        height: 0.9rem;\n    }\n    .openclose::before {\n        content: \"\";\n        display: inline-block;\n        width: 0.8rem;\n        height: 0.8rem;\n        background-color: currentColor;\n        -webkit-mask: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12'%3E%3Cpath d='M2 4l4 4 4-4' fill='none' stroke='%23000' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E\") center / contain no-repeat;\n        mask: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12'%3E%3Cpath d='M2 4l4 4 4-4' fill='none' stroke='%23000' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E\") center / contain no-repeat;\n    }\n\n</style>\n<div class=\"flex-row gap-medium flex-align-items-center\">\n    <input data-testid=\"input-search\" class=\"flex-grow\">\n    <div data-testid=\"button-openclose\" class=\"openclose\"></div>\n</div>\n<div class=\"list\">\n    <div class=\"nooptions\">no options found!</div>\n    <div class=\"option padding-medium\" data-testid=\"options\">\n        <div class=\"option-row\"></div>\n    </div>\n</div>\n", "// SPDX-FileCopyrightText: 2025 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport { CommonWebComponent } from \"./CommonWebComponent.js\";\nimport template from './AutoComplete.html?raw'\n\nexport type OptionItem = {\n  value: string\n  label: string\n}\n\ntype OptionListState = 'force-off' | 'filtered_by_input_value' | 'force-all'\n\ntype AutoCompleteState = {\n  option_list_state: OptionListState\n  hasfocus: boolean\n  items: OptionItem[]\n  value_on_focus: string | null\n  value_of_input: string\n  selected_value: string\n}\n\nconst findValueByLabel = (label: string, list: readonly OptionItem[]): string => {\n  for (let i = 0; i < list.length; i++) {\n    if (list[i].label === label)\n      return list[i].value\n  }\n  return ''\n}\n\nconst items_filtered = (\n  option_list_state: OptionListState,\n  items: OptionItem[],\n  value_of_input: string\n): OptionItem[] => {\n  const stateVal = option_list_state\n  if (stateVal === 'force-off')\n    return []\n  const result: OptionItem[] = []\n  if (stateVal === 'force-all') {\n    for (let i = 0; i < items.length; i++) {\n      const item = items[i]\n      result.push({\n        label: item.label,\n        value: item.value,\n      })\n    }\n    return result\n  }\n  const current = value_of_input.toLowerCase()\n  for (let i = 0; i < items.length; i++) {\n    const item = items[i]\n    if (!item.label.toLowerCase().includes(current))\n      continue\n    result.push(item)\n  }\n  return result\n}\n\nconst isvalid = (value_of_input: string, items: OptionItem[]): boolean => {\n  return findValueByLabel(value_of_input, items) !== ''\n}\n\nconst list_hidden = (option_list_state: OptionListState): boolean => {\n  return option_list_state === 'force-off'\n}\n\nconst hide_nooptions = (option_list_state: OptionListState, filtered_count: number): boolean => {\n  return !(option_list_state === 'filtered_by_input_value' && filtered_count === 0)\n}\n\nconst class_invalid = (value_of_input: string, items: OptionItem[]): boolean => {\n  return !isvalid(value_of_input, items)\n}\n\nconst class_empty_value = (value_of_input: string): boolean => {\n  return value_of_input.trim().length === 0\n}\n\nexport type AutoCompleteTestingHtmlElements = {\n    readonly input_filter: HTMLInputElement\n    readonly button_showoptions: HTMLElement\n    readonly options: () => { readonly el: HTMLElement, readonly value: string }[]\n}\n\n\nexport class AutoComplete extends CommonWebComponent {\n  #stateLogic: AutoCompleteState\n  #onchange: () => void = () => {}\n  #inputEl: HTMLInputElement\n  #listEl: HTMLElement\n  #opencloseEl: HTMLElement\n  #noOptionsEl: HTMLElement\n  #optionsContainer: HTMLElement\n  #optionTemplate: HTMLElement\n\n  constructor() {\n    super(template);\n\n    this.#inputEl = this.querySelector('input') as HTMLInputElement\n    this.#listEl = this.querySelector('.list')\n    this.#opencloseEl = this.querySelector('.openclose')\n    this.#noOptionsEl = this.#listEl.querySelector('.nooptions') as HTMLElement\n\n    this.#optionsContainer = this.querySelector('.option')\n    this.#optionTemplate = this.#optionsContainer.removeChild(this.#optionsContainer.firstElementChild!) as HTMLElement\n\n    this.#stateLogic = {\n      option_list_state: 'force-off',\n      hasfocus: false,\n      items: [],\n      value_on_focus: null,\n      value_of_input: '',\n      selected_value: '',\n    }\n\n    this.#opencloseEl.onmousedown = (e) => e.preventDefault()\n    this.#listEl.onmousedown = (e) => e.preventDefault()\n\n    this.#inputEl.addEventListener('input', () => {\n      this.#onchange_input(this.#inputEl.value)\n    })\n    this.#inputEl.addEventListener('focus', () => {\n      this.#onfocus_input()\n    })\n    this.#inputEl.addEventListener('blur', () => {\n      this.#onblur_input()\n    })\n\n    this.#opencloseEl.onclick = () => {\n      this.#onclick_openclose()\n    }\n\n    this.#resync_derived_resources()\n  }\n\n  #onchange_input(value: string) {\n    const state = this.#stateLogic\n    state.value_of_input = value\n    state.option_list_state = 'filtered_by_input_value'\n    const label_matching_value = findValueByLabel(state.value_of_input, state.items)\n    if (label_matching_value !== undefined)\n      state.selected_value = label_matching_value\n    this.#resync_derived_resources()\n  }\n\n  #onclick_openclose() {\n    const state = this.#stateLogic\n    if (state.hasfocus) {\n      state.option_list_state = state.option_list_state === 'force-off' ? 'force-all' : 'force-off'\n    } else {\n      state.option_list_state = 'force-all'\n      this.#inputEl.focus()\n    }\n    this.#resync_derived_resources()\n  }\n\n  #onfocus_input() {\n    const state = this.#stateLogic\n    state.hasfocus = true\n    state.value_on_focus = state.value_of_input\n    if (!isvalid(state.value_of_input, state.items) || state.value_of_input === '')\n      state.option_list_state = 'force-all'\n    this.#resync_derived_resources()\n  }\n\n  #onblur_input() {\n    const state = this.#stateLogic\n    state.hasfocus = false\n    const list = items_filtered(state.option_list_state, state.items, state.value_of_input)\n    if (list.length === 1)\n    {\n      state.value_of_input = list[0].label\n      state.selected_value = list[0].value\n    }\n    state.option_list_state = 'force-off'\n    if (state.value_of_input !== state.value_on_focus)\n      this.#onchange()\n    state.value_on_focus = null\n    this.#resync_derived_resources()\n  }\n\n  #onclick_item(index: number) {\n    const state = this.#stateLogic\n    const list = items_filtered(state.option_list_state, state.items, state.value_of_input)\n    if (index < 0 || index >= list.length)\n      return\n    const value = list[index]\n    state.selected_value = value.value\n    state.value_of_input = value.label\n    state.value_on_focus = value.label\n    state.option_list_state = 'force-off'\n    this.#onchange()\n    this.#resync_derived_resources()\n  }\n\n  set onchange(c: () => void) {\n    this.#onchange = c\n  }\n\n  public batchUpdate() {\n    let committed = false\n    let modified = false\n    const builder = {\n      items: (values: OptionItem[]) => {\n        const state = this.#stateLogic\n        const prev = state.items\n        if (prev === values)\n          return builder\n        if (prev.length === values.length) {\n          let same = true\n          for (let i = 0; i < prev.length; i++) {\n            if (prev[i].value !== values[i].value || prev[i].label !== values[i].label) {\n              same = false\n              break\n            }\n          }\n          if (same)\n            return builder\n        }\n        state.items = values\n        const found = state.items.filter((f) => f.value === state.selected_value)\n        if (found.length === 1)\n          state.value_of_input = found[0].label\n        else\n          state.value_of_input = ''\n        modified = true\n        return builder\n      },\n      value: (v: string) => {\n        const state = this.#stateLogic\n        if (state.selected_value === v)\n          return builder\n        state.selected_value = v\n        const found = state.items.filter((f) => f.value === state.selected_value)\n        if (found.length === 1)\n          state.value_of_input = found[0].label\n        else\n          state.value_of_input =  ''\n        modified = true\n        return builder\n      },\n      commit: () => {\n        if (committed)\n          return\n        committed = true\n        if (!modified)\n          return\n        this.#resync_derived_resources()\n      },\n    }\n    return builder\n  }\n\n  set items(values: OptionItem[]) {\n    this.batchUpdate().items(values).commit()\n  }\n\n  get value(): string {\n    if (!isvalid(this.#stateLogic.value_of_input, this.#stateLogic.items))\n      return ''\n    return this.#stateLogic.selected_value\n  }\n\n  get isvalid(): boolean {\n    return isvalid(this.#stateLogic.value_of_input, this.#stateLogic.items)\n  }\n\n  set value(v: string) {\n    this.batchUpdate().value(v).commit()\n  }\n\n  public testing_htmlelements(): AutoCompleteTestingHtmlElements {\n    return {\n      input_filter: this.#inputEl,\n      button_showoptions: this.#opencloseEl,\n      options: () => {\n        return Array.from(this.#optionsContainer.children).map((e) => ({ \n          el:e as HTMLElement,\n          value: '' }))\n      }\n    }\n  }\n\n  #resync_derived_resources(): void {\n    const state = this.#stateLogic\n    const itemsFiltered = items_filtered(state.option_list_state, state.items, state.value_of_input)\n    const isValid = isvalid(state.value_of_input, state.items)\n    const listHidden = list_hidden(state.option_list_state)\n    const hideNoOptions = hide_nooptions(state.option_list_state, itemsFiltered.length)\n    const classInvalid = class_invalid(state.value_of_input, state.items)\n    const classEmptyValue = class_empty_value(state.value_of_input)\n    void isValid\n\n    this.#inputEl.value = state.value_of_input\n\n    this.#listEl.classList.toggle('display-none', listHidden)\n    this.classList.toggle('invalid', classInvalid)\n    this.classList.toggle('empty-value', classEmptyValue)\n    this.#noOptionsEl.classList.toggle('display-none', hideNoOptions)\n\n    const optionsFragment = document.createDocumentFragment()\n    for (let i = 0; i < itemsFiltered.length; i++) {\n      const v = itemsFiltered[i]\n      const e = this.#optionTemplate.cloneNode(true) as HTMLElement\n      e.textContent = v.label\n      e.setAttribute('data-testid', 'option-' + v.value)\n      e.onclick = () => {\n        this.#onclick_item(i)\n      }\n      optionsFragment.appendChild(e)\n    }\n    this.#optionsContainer.replaceChildren(optionsFragment)\n  }\n}\n\ncustomElements.define(\"cs-auto-complete\", AutoComplete);\n", "<!--\n  SPDX-FileCopyrightText: 2025 Catch Solve di Davide Montesin\n\n  SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<style>\n    @import url(\"anywhere.css\");\n    @import url(\"all-webcomponent.css\");\n\n    :host {\n        display: block;\n        font-family: \"IBM Plex Sans\", \"Trebuchet MS\", \"Verdana\", sans-serif;\n    }\n\n    .maindiv {\n        padding: 10px 12px;\n        border-radius: 0;\n        border: 1px solid #e5e7eb;\n        background: #ffffff;\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\n    }\n\n    .field-meta {\n        display: flex;\n        flex-direction: column;\n        gap: 2px;\n        font-size: 0.75rem;\n        color: #6b7280;\n        text-transform: uppercase;\n        letter-spacing: 0.06em;\n    }\n\n    .compare-value {\n        padding: 8px 10px;\n        border: 1px solid #d1d5db;\n        border-radius: 0;\n        font-size: 0.95rem;\n    }\n\n    .delete {\n        border: none;\n        background: #111111;\n        color: #ffffff;\n        width: 36px;\n        height: 36px;\n        border-radius: 0;\n        cursor: pointer;\n    }\n\n    @media (max-width: 720px) {\n        .maindiv {\n            grid-template-columns: 1fr;\n        }\n\n        .delete {\n            justify-self: end;\n        }\n    }\n\n</style>\n<div class=\"flex-row gap-medium maindiv\">\n\n    <cs-auto-complete class=\"field-name flex-grow\" data-testid=\"input-field-name\"></cs-auto-complete>\n\n    <div class=\"field-meta\" style=\"display: none\">\n        <div class=\"field-name-type\"></div>\n        <div class=\"field-name-is-array\"></div>\n    </div>\n\n    <cs-auto-complete class=\"operation flex-grow\" data-testid=\"input-operation\"></cs-auto-complete>\n\n    <input class=\"compare-value flex-grow\" data-testid=\"input-compare-value\">\n\n    <button class=\"delete\">\uD83D\uDDD1</button>\n</div>\n", "// SPDX-FileCopyrightText: 2025 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport { CommonWebComponent } from './CommonWebComponent.js'\nimport template from './CustomDatasetFormQualityCheck.html?raw'\nimport type { AutoComplete, OptionItem } from './AutoComplete.js'\nimport { SelectedFieldType } from './CustomDatasetForm.js'\n\n\nfunction get_field_name_type(fieldName: string): string {\n    return fieldName.trim().length === 0\n        ? ''\n        : ((JSON.parse(fieldName) as SelectedFieldType).type as string)\n}\n\nfunction get_field_name_is_array(fieldName: string): boolean {\n    return fieldName.trim().length === 0\n        ? false\n        : (JSON.parse(fieldName) as SelectedFieldType).is_array\n}\n\nfunction get_operation_items(fieldName: string): OptionItem[] {\n    const options: OptionItem[] = []\n\n    if (get_field_name_is_array(fieldName)) {\n        options.push(\n            {\n                value: 'in list',\n                label: 'in list'\n            },\n            {\n                value: 'not in list',\n                label: 'not in list'\n            }\n        )\n    } else {\n        options.push(\n            {\n                value: '=',\n                label: '='\n            },\n            {\n                value: '!=',\n                label: '!='\n            }\n        )\n\n        switch (get_field_name_type(fieldName)) {\n            case 'string':\n                options.push({ value: 'contains', label: 'contains' })\n                options.push({ value: 'not contains', label: 'not contains' })\n                break\n            case 'number':\n                options.push({ value: '<=', label: '<=' })\n                options.push({ value: '>=', label: '>=' })\n                break\n        }\n    }\n\n    return options\n}\n\nfunction get_compare_value_placeholder(fieldName: string): string {\n    return get_field_name_is_array(fieldName)\n        ? 'list of values separated by , (csv)'\n        : 'comparison value of type ' + get_field_name_type(fieldName)\n}\n\nfunction isvalid_state(fieldName: string, operation: string, compareValue: string): boolean {\n    return fieldName.trim() !== '' && operation !== '' && compareValue.trim() !== ''\n}\n\nexport class CustomDatasetFormQualityCheck extends CommonWebComponent\n{\n    #state = {\n        field_name: '',\n        operation: '',\n        compare_value: ''\n    }\n    #onchange: () => void = () => {}\n    #compareInput: HTMLInputElement\n    #mainRow: HTMLElement\n    #fieldName: AutoComplete\n    #fieldNameType: HTMLElement\n    #fieldNameIsArray: HTMLElement\n    #operation: AutoComplete\n\n    #isvalid: boolean\n\n    constructor()\n    {\n        super(template)\n\n        this.#mainRow = this.querySelector('.maindiv')\n        this.#fieldName = this.querySelector('.field-name') as AutoComplete\n        this.#fieldNameType = this.querySelector('.field-name-type')\n        this.#fieldNameIsArray = this.querySelector('.field-name-is-array')\n        this.#operation = this.querySelector('.operation') as AutoComplete\n        this.#compareInput = this.querySelector('.compare-value') as HTMLInputElement\n\n        this.#setupUiEffects()\n        this.#isvalid = false\n        this.#resync_derived_resources()\n    }\n\n    #setupUiEffects()\n    {\n        this.#fieldName.onchange = () => {\n            this.value_field_name = this.#fieldName.value\n            this.#onchange()\n        }\n        this.#operation.onchange = () => {\n            this.value_operation = this.#operation.value\n            this.#onchange()\n\n        }\n        this.#compareInput.addEventListener('input', () => {\n            this.value_compare_value = this.#compareInput.value\n            this.#onchange()\n        })\n    }\n\n    #resync_derived_resources(): void {\n        this.#fieldName.value = this.#state.field_name\n        this.#fieldNameType.textContent = get_field_name_type(this.#fieldName.value)\n        this.#fieldNameIsArray.textContent = String(get_field_name_is_array(this.#fieldName.value))\n        this.#operation.items = get_operation_items(this.#fieldName.value)\n        this.#operation.value = this.#state.operation\n        this.#compareInput.value = this.#state.compare_value\n        this.#compareInput.placeholder = get_compare_value_placeholder(this.#fieldName.value)\n\n        const isvalid = isvalid_state(this.#fieldName.value, this.#operation.value, this.#compareInput.value)\n        this.#mainRow.classList.toggle('isnotvalid', !isvalid)\n\n        this.#isvalid = isvalid\n    }\n\n    set value_field_name(v: string) {\n        if (this.#state.field_name === v)\n            return\n        this.#state.field_name = v\n        this.#resync_derived_resources()\n    }\n\n    set value_operation(v: string) {\n        if (this.#state.operation === v)\n            return\n        this.#state.operation = v\n        this.#resync_derived_resources()\n    }\n\n    set value_compare_value(v: string) {\n        if (this.#state.compare_value === v)\n            return\n        this.#state.compare_value = v\n        this.#resync_derived_resources()\n    }\n\n    get value_field_name() {\n        return this.#state.field_name\n    }\n\n    get value_operation() {\n       return  this.#state.operation\n    }\n\n    get value_compare_value() {\n        return this.#state.compare_value\n    }\n\n    get isvalid() {\n        return this.#isvalid\n    }\n\n    \n    set items(values: OptionItem[]) {\n        const current = this.#fieldName.items\n        if (current !== undefined && current.length === values.length) {\n            let same = true\n            for (let i = 0; i < current.length; i++) {\n                const a = current[i]\n                const b = values[i]\n                if (a.value !== b.value || a.label !== b.label) {\n                    same = false\n                    break\n                }\n            }\n            if (same)\n                return\n        }\n        this.#fieldName.items = values\n        this.#resync_derived_resources()\n    }\n\n    set onchange(fn: () => void) {\n        this.#onchange = fn\n    }\n\n    get delete_button() {\n        return this.querySelector('button')\n    }\n\n}\n\ncustomElements.define('cs-custom-dataset-form-quality-check', CustomDatasetFormQualityCheck)\n", "// SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport { CommonWebComponent } from './CommonWebComponent.js'\nimport template from './CustomDatasetForm.html?raw'\n\nimport './AutoComplete.js'\nimport './CustomDatasetFormQualityCheck.js'\nimport { AutoComplete } from './AutoComplete.js'\nimport type { OptionItem } from './AutoComplete.js'\nimport { CustomDatasetFormQualityCheck } from './CustomDatasetFormQualityCheck.js'\nimport { TOURISM_API_BASE, MOBILITY_API_BASE } from './config.js';\n\n\nexport type FieldMeta = {\n    field_name: string,\n    description: string,\n    type: 'string'|'array'|'object'|'number'|'integer'|'boolean'|'oauth2'\n    nullable: true|undefined\n}\n\nexport type SelectedFieldType = {\n    name: string\n    type: FieldMeta['type']\n    is_array: boolean\n}\n\nconst ALL_DATA_PROVIDERS = '--- ALL ---'\n\ntype DatasetItem = {\n    Id: string\n    Shortname: string\n    DataProvider: string[]\n    ApiType: string\n    ApiUrl: string\n    PathParam: string[]\n}\n\ntype DatasetsOpenapi = {\n    paths: {\n        [path: string]: {\n            get: {\n                responses: {\n                    200: {\n                        content: {\n                            'application/json': {\n                                schema: {\n                                    $ref: string\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n    components: {\n        schemas: Schemas\n    }\n}\n\ntype Schemas = {\n    [schema: string]: {\n        properties: {\n            [property: string]: {\n                description: string\n                type: 'string' | 'array' | 'object' | 'number' | 'integer' | 'boolean' | 'oauth2'\n                nullable: true | undefined\n                additionalProperties: { $ref: string | undefined }\n                items: { $ref: string; type: 'string' | 'object' }\n                $ref: string\n            }\n        }\n    }\n}\n\ntype CustomDatasetFormQualityCheckValueAndItems = {\n    field_name: string\n    operation: string\n    compare_value: string\n    items: OptionItem[]\n}\n\ntype TourismState = {\n    loading: boolean\n    current_dashboard_name: string\n    current_dataprovider: string\n    current_filtered_dataset: string\n    current_timeseries_datatype: string\n    timeseries_datatypes: Readonly<OptionItem>[]\n    current_timeseries_mperiod: string\n    timeseries_mperiods: readonly OptionItem[]\n    current_timeseries_active_status: string\n    timeseries_active_statuses: readonly OptionItem[]\n    qualityChecks: CustomDatasetFormQualityCheckValueAndItems[]\n    openapi: DatasetsOpenapi | null\n    datasets: DatasetItem[]\n}\n\ntype ElaborationHandle = {\n    setText: (text: string) => void\n    closeAfter: (ms: number) => void\n    requireOk: (text?: string) => Promise<void>\n    close: () => void\n}\n\nfunction createTourismState(): TourismState {\n    return {\n        loading: false,\n        current_dashboard_name: '',\n        current_dataprovider: ALL_DATA_PROVIDERS,\n        current_filtered_dataset: '',\n        current_timeseries_datatype: '',\n        timeseries_datatypes: [],\n        current_timeseries_mperiod: '',\n        timeseries_mperiods: [\n            { value: '', label: '' },\n            { value: '60', label: '60' },\n            { value: '3600', label: '3600' }\n        ],\n        current_timeseries_active_status: 'only-active',\n        timeseries_active_statuses: [\n            { value: 'all', label: 'all' },\n            { value: 'only-active', label: 'only active' },\n            { value: 'only-not-active', label: 'only not active' }\n        ],\n        qualityChecks: [],\n        openapi: null,\n        datasets: []\n    }\n}\n\nfunction filtered_datasets(state: TourismState): readonly OptionItem[] {\n    const provider = state.current_dataprovider\n    return state.datasets\n        .filter((d) => (d.DataProvider ?? []).includes(provider) || provider === ALL_DATA_PROVIDERS)\n        .map((d): OptionItem => ({ value: d.Shortname, label: d.Shortname }))\n}\n\nfunction data_providers(state: TourismState): readonly OptionItem[] {\n    const providers = new Set<string>()\n    state.datasets.forEach((d) => (d.DataProvider || []).forEach((dd) => { if (dd !== '') providers.add(dd) }))\n    const result = Array.from(providers)\n    result.sort()\n    result.unshift(ALL_DATA_PROVIDERS)\n    return result.map((d): OptionItem => ({ value: d, label: d }))\n}\n\nfunction datasets_filtered_current_type(state: TourismState): string {\n    const current = state.current_filtered_dataset\n    if (state.datasets.length === 0 || current === '')\n        return ''\n    const found = state.datasets.find((d) => d.Shortname === current)\n    return found ? found.ApiType : ''\n}\n\nfunction current_filtered_dataset_object(state: TourismState): DatasetItem | null {\n    const curr = state.current_filtered_dataset\n    const list = state.datasets.filter((d) => d.Shortname === curr)\n    return list.length === 0 ? null : list[0]\n}\n\nfunction field_names(state: TourismState): OptionItem[] {\n    const api = state.openapi\n    if (api === null)\n        return []\n    const currDataset = current_filtered_dataset_object(state)\n    if (currDataset === null)\n        return []\n    const datasetName = currDataset.ApiUrl.split('/').pop()\n    const byId = Object.keys(api.paths).filter((p) => p.endsWith('/' + datasetName + '/{id}'))\n    if (!api.paths[byId[0]])\n        return [{ value: JSON.stringify({\n            name: 'mvalue',\n            type: 'number',\n            is_array: false\n        } as SelectedFieldType), label: 'mvalue' }]\n    let ref = api.paths[byId[0]].get.responses[200].content['application/json'].schema.$ref\n    ref = ref.substring(1)\n    const refParts = ref.split('/')\n    const schemaName = refParts.pop()!\n    const primitiveProperties = traverseProperties('', api.components.schemas, schemaName)\n    primitiveProperties.sort((a, b) => a.label.localeCompare(b.label))\n    return primitiveProperties\n}\n\nfunction field_names_found(fieldNames: OptionItem[]): boolean {\n    return fieldNames.length !== 1 || fieldNames[0].value !== ''\n}\n\nfunction is_qualitychecks_valid(qualityChecks: ReadonlyArray<CustomDatasetFormQualityCheck>): boolean {\n    for (let i = 0; i < qualityChecks.length; i++) {\n        if (!qualityChecks[i].isvalid)\n            return false\n    }\n    return true\n}\n\nfunction traverseProperties(prefix: string, schemas: Schemas, schemaName: string, options: OptionItem[] = []): OptionItem[] {\n    const properties = schemas[schemaName].properties\n    for (const [k, p] of Object.entries(properties)) {\n        const fullk = prefix + k\n        if (['string', 'boolean', 'number', 'integer'].includes(p.type))\n            options.push({\n                value: JSON.stringify({ name: fullk, type: p.type, is_array: false } as SelectedFieldType),\n                label: `${fullk} {${p.type}}`\n            })\n        else if (p.type === 'object') {\n            if (p.$ref) {\n                const name = p.$ref.split('/').pop()!\n                traverseProperties(k + '.', schemas, name, options)\n            }\n\n            if (p.additionalProperties.$ref) {\n                const name = p.additionalProperties.$ref.split('/').pop()!\n                traverseProperties(k + '.*.', schemas, name, options)\n            }\n        }\n        else if (p.type === 'array') {\n            if (['string', 'boolean', 'number', 'integer'].includes(p.items.type)) {\n                options.push({\n                    value: JSON.stringify({ name: fullk, type: p.items.type, is_array: true } as SelectedFieldType),\n                    label: `${fullk}[] {${p.items.type}}`\n                })\n                continue\n            }\n            const name = p.items.$ref.split('/').pop()!\n            traverseProperties(k + '[n].', schemas, name, options)\n        }\n    }\n    return options\n}\n\nexport class CustomDatasetForm extends CommonWebComponent\n{\n    #state: TourismState\n    #startPromise: Promise<void>\n    #currentCustomDashboardId: number | null = null\n    #loadingElement: HTMLElement\n    #loadingMessageElement: HTMLElement\n    #loadingOkButton: HTMLButtonElement\n    #loadingCloseTimeoutId: number | null = null\n    #loadingOkResolver: (() => void) | null = null\n    #defaultElaborationMessage: string\n    #timeseriesFetchAbortController: AbortController | null = null\n    #lastTimeseriesDatasetName: string | null = null\n\n    #formIsvalidSpan: HTMLElement\n\n    #dataproviders: AutoComplete\n    #datasets: AutoComplete\n    #datasetType: HTMLElement\n    #dashboardName: HTMLInputElement\n    #timeseriesNotApplicableRow: HTMLElement\n    #timeseriesActiveRow: HTMLElement\n    #timeseriesActiveStatus: AutoComplete\n    #timeseriesDatatypeRow: HTMLElement\n    #timeseriesDatatype: AutoComplete\n    #timeseriesPeriodRow: HTMLElement\n    #timeseriesPeriod: AutoComplete\n    #addCheckButton: HTMLButtonElement\n    #saveButton: HTMLButtonElement\n    #noFieldNames: HTMLElement\n    #checksdiv: HTMLElement\n    #qualityCheckElements: CustomDatasetFormQualityCheck[] = []\n\n    constructor()\n    {\n        super(template)\n\n        this.#loadingElement = this.querySelector('.pleasewait')\n        this.#loadingMessageElement = this.#loadingElement.querySelector('.pleasewait-message')!\n        this.#loadingOkButton = this.#loadingElement.querySelector('.pleasewait-ok')!\n        this.#defaultElaborationMessage = (this.#loadingMessageElement.textContent || 'elaboration in progress').trim()\n        this.#loadingOkButton.onclick = () => {\n            const resolver = this.#loadingOkResolver\n            this.#loadingOkResolver = null\n            if (resolver) {\n                resolver()\n            }\n            this.#hideElaboration()\n        }\n\n        this.#dataproviders = this.querySelector('.dataproviders') as AutoComplete\n        this.#datasets = this.querySelector('.datasets') as AutoComplete\n        this.#datasetType = this.querySelector('.dataset-type')\n        this.#dashboardName = this.querySelector('.dashboard-name') as HTMLInputElement\n        this.#timeseriesNotApplicableRow = this.querySelector('.timeseries-na-row')\n        this.#timeseriesActiveRow = this.querySelector('.timeseries-active-row')\n        this.#timeseriesActiveStatus = this.querySelector('.timeseries-active-status') as AutoComplete\n        this.#timeseriesDatatypeRow = this.querySelector('.timeseries_div')\n        this.#timeseriesDatatype = this.querySelector('.timeseries-datatype') as AutoComplete\n        this.#timeseriesPeriodRow = this.querySelector('.period_div')\n        this.#timeseriesPeriod = this.querySelector('.timeseries-mperiod') as AutoComplete\n        this.#addCheckButton = this.querySelector('.add-check') as HTMLButtonElement\n        this.#saveButton = this.querySelector('.save-dashboard') as HTMLButtonElement\n        this.#noFieldNames = this.querySelector('.no-field-names')\n        this.#checksdiv = this.querySelector('.checks')\n\n        this.#formIsvalidSpan = this.querySelector('.form-is-valid')\n\n        this.#state = createTourismState()\n        this.#setupUiEffects()\n\n        this.#startPromise = this.#onstart()\n    }\n\n    async loadCustomDashboard(definition: any, dashboardId: number, dashboardName?: string)\n    {\n        await this.#startPromise\n        this.#currentCustomDashboardId = dashboardId\n        const state = this.#state\n        state.current_dashboard_name = dashboardName ?? ''\n        state.current_dataprovider = definition.data_provider ?? ''\n        state.current_filtered_dataset = definition.dataset ?? ''\n        state.current_timeseries_active_status = definition.timeseries?.active_status ?? 'only-active'\n        state.current_timeseries_datatype = definition.timeseries?.datatype ?? ''\n        state.current_timeseries_mperiod = definition.timeseries?.mperiod ?? ''\n        const checks = Array.isArray(definition.checks) ? definition.checks : []\n        const fieldNames = field_names(state)\n        state.qualityChecks = checks.map((row: any) => ({\n            __id: crypto.randomUUID(),\n            field_name: row.field_name ?? '',\n            operation: row.operation ?? '',\n            compare_value: row.compare_value ?? '',\n            isvalid: !!row.isvalid,\n            items: fieldNames\n        }))\n        this.#resync_derived_resources()\n    }\n\n    setElaborationInProgress(message: string = 'operation in progress ...'): ElaborationHandle\n    {\n        this.#showElaboration()\n        this.#setElaborationText(message)\n\n        const handle: ElaborationHandle = {\n            setText: (text: string) => {\n                this.#setElaborationText(text)\n            },\n            closeAfter: (ms: number) => {\n                if (!Number.isFinite(ms) || ms <= 0) {\n                    return\n                }\n                this.#setRequiresOk(false)\n                this.#clearElaborationTimeout()\n                this.#loadingCloseTimeoutId = window.setTimeout(() => {\n                    this.#hideElaboration()\n                }, ms)\n            },\n            requireOk: (text?: string) => {\n                if (typeof text === 'string') {\n                    this.#setElaborationText(text)\n                }\n                this.#clearElaborationTimeout()\n                this.#setRequiresOk(true)\n                return new Promise<void>((resolve) => {\n                    this.#loadingOkResolver = resolve\n                })\n            },\n            close: () => {\n                this.#hideElaboration()\n            }\n        }\n\n        return handle\n    }\n\n    #setElaborationText(text: string)\n    {\n        this.#loadingMessageElement.textContent = text || this.#defaultElaborationMessage\n    }\n\n    #showElaboration()\n    {\n        this.#loadingElement.classList.add('elaborationinprogress')\n    }\n\n    #hideElaboration()\n    {\n        this.#clearElaborationTimeout()\n        this.#setRequiresOk(false)\n        this.#loadingElement.classList.remove('elaborationinprogress')\n    }\n\n    #setRequiresOk(isRequired: boolean)\n    {\n        this.#loadingElement.classList.toggle('requires-ok', isRequired)\n        if (!isRequired) {\n            this.#loadingOkResolver = null\n        }\n    }\n\n    #clearElaborationTimeout()\n    {\n        if (this.#loadingCloseTimeoutId !== null) {\n            clearTimeout(this.#loadingCloseTimeoutId)\n            this.#loadingCloseTimeoutId = null\n        }\n    }\n\n    getCustomDashboardDraft()\n    {\n        const state = this.#state\n        return {\n            id: this.#currentCustomDashboardId,\n            name: state.current_dashboard_name || state.current_filtered_dataset || 'custom_dashboard',\n            test_definition_json: {\n                data_provider: state.current_dataprovider,\n                dataset: state.current_filtered_dataset,\n                dataset_type: datasets_filtered_current_type(state),\n                timeseries: {\n                    active_status: state.current_timeseries_active_status,\n                    datatype: state.current_timeseries_datatype,\n                    mperiod: state.current_timeseries_mperiod\n                },\n                checks: state.qualityChecks.map((row) => ({\n                    field_name: row.field_name,\n                    operation: row.operation,\n                    compare_value: row.compare_value,\n                }))\n            }\n        }\n    }\n\n    #setupUiEffects()\n    {\n        this.#dashboardName.oninput = () => {\n            this.#state.current_dashboard_name = this.#dashboardName.value\n            this.#resync_derived_resources()\n        }\n        this.#dataproviders.onchange = () => {\n            this.#onchange_current_dataprovider(this.#dataproviders.isvalid, this.#dataproviders.value)\n        }\n        this.#datasets.onchange = () => {\n            this.#onchange_current_filtered_dataset(this.#datasets.isvalid, this.#datasets.value)\n        }\n        this.#timeseriesActiveStatus.onchange = () => {\n            this.#onchange_current_timeseries_active_status(\n                this.#timeseriesActiveStatus.isvalid,\n                this.#timeseriesActiveStatus.value\n            )\n        }\n        this.#timeseriesDatatype.onchange = () => {\n            this.#state.current_timeseries_datatype = this.#timeseriesDatatype.value\n            this.#resync_derived_resources()\n        }\n        this.#timeseriesPeriod.onchange = () => {\n            this.#state.current_timeseries_mperiod = this.#timeseriesPeriod.value\n            this.#resync_derived_resources()\n        }\n        this.#addCheckButton.onclick = () => this.#onclick_add_check()\n\n        this.#saveButton.onclick = () => {\n            this.dispatchEvent(new CustomEvent('save-custom-dashboard', { bubbles: true, composed: true }))\n        }\n\n        this.querySelector('.testing').onclick = async () => {\n            const showOptionsButton = this.#dataproviders.testing_htmlelements().button_showoptions\n            showOptionsButton.dispatchEvent(new MouseEvent('click', { bubbles: true, cancelable: true }))\n            await new Promise(s => setTimeout(s, 1000))\n            const txt_input = this.#dataproviders.testing_htmlelements().input_filter\n            for (const txt of ['2', '22', '222']) {\n                txt_input.value = txt\n                txt_input.dispatchEvent(new Event('input', { bubbles: true, cancelable: true }))\n                await new Promise(s => setTimeout(s, 2000))\n            }\n        }\n    }\n\n    #resync_derived_resources(): void {\n        const state = this.#state\n        this.classList.toggle('loading', state.loading)\n\n        if (this.#dashboardName.value !== state.current_dashboard_name) {\n            this.#dashboardName.value = state.current_dashboard_name\n        }\n\n        const dataProviders = data_providers(state)\n        this.#dataproviders.batchUpdate().items([...dataProviders]).value(state.current_dataprovider).commit()\n\n        const filteredDatasets = filtered_datasets(state)\n        this.#datasets.batchUpdate().items([...filteredDatasets]).value(state.current_filtered_dataset).commit()\n\n        const datasetType = datasets_filtered_current_type(state)\n        this.#datasetType.textContent = datasetType\n\n        const isTimeseries = datasetType === 'timeseries'\n        const notApplicableValue = 'N/A'\n        if (!isTimeseries) {\n            if (state.current_timeseries_active_status !== notApplicableValue) {\n                state.current_timeseries_active_status = notApplicableValue\n            }\n            if (state.current_timeseries_datatype !== notApplicableValue) {\n                state.current_timeseries_datatype = notApplicableValue\n            }\n            if (state.current_timeseries_mperiod !== notApplicableValue) {\n                state.current_timeseries_mperiod = notApplicableValue\n            }\n        } else {\n            if (state.current_timeseries_active_status === notApplicableValue) {\n                state.current_timeseries_active_status = 'only-active'\n            }\n            if (state.current_timeseries_datatype === notApplicableValue) {\n                state.current_timeseries_datatype = ''\n            }\n            if (state.current_timeseries_mperiod === notApplicableValue) {\n                state.current_timeseries_mperiod = ''\n            }\n        }\n        this.#timeseriesNotApplicableRow.setAttribute('data-isvisible', String(!isTimeseries))\n        this.#timeseriesActiveRow.setAttribute('data-isvisible', String(isTimeseries))\n        this.#timeseriesDatatypeRow.setAttribute('data-isvisible', String(isTimeseries))\n        this.#timeseriesPeriodRow.setAttribute('data-isvisible', String(isTimeseries))\n\n        this.#timeseriesActiveStatus.batchUpdate()\n            .items([...state.timeseries_active_statuses])\n            .value(state.current_timeseries_active_status)\n            .commit()\n\n        this.#timeseriesDatatype.batchUpdate()\n            .items([...state.timeseries_datatypes])\n            .value(state.current_timeseries_datatype)\n            .commit()\n\n        this.#timeseriesPeriod.batchUpdate()\n            .items([...state.timeseries_mperiods])\n            .value(state.current_timeseries_mperiod)\n            .commit()\n\n        const fieldNames = field_names(state)\n        const hasFieldNames = field_names_found(fieldNames)\n        this.#addCheckButton.disabled = !hasFieldNames\n        this.#noFieldNames.classList.toggle('display-none', hasFieldNames)\n\n        const nextQualityCheckElements: CustomDatasetFormQualityCheck[] = []\n        for (let i = 0; i < state.qualityChecks.length; i++) {\n            const row = state.qualityChecks[i]\n            let qualityCheck = this.#qualityCheckElements[i]\n            if (!qualityCheck) {\n                qualityCheck = new CustomDatasetFormQualityCheck()\n            }\n            qualityCheck.setAttribute('data-testid', 'checks-' + i)\n            qualityCheck.value_field_name = row.field_name\n            qualityCheck.value_operation = row.operation\n            qualityCheck.value_compare_value = row.compare_value\n            qualityCheck.items = fieldNames\n            qualityCheck.onchange = () => {\n                const prevRow = this.#state.qualityChecks[i]\n\n                this.#state.qualityChecks[i] = {\n                    field_name: qualityCheck.value_field_name,\n                    operation: qualityCheck.value_operation,\n                    compare_value: qualityCheck.value_compare_value,\n                    items: prevRow.items\n                }\n\n                void prevRow\n                this.#resync_derived_resources()\n            }\n            qualityCheck.delete_button.onclick = () => {\n                if (confirm('Are you sure?')) {\n                    this.#state.qualityChecks.splice(i, 1)\n                    this.#qualityCheckElements.splice(i, 1)\n                    this.#resync_derived_resources()\n                }\n            }\n            nextQualityCheckElements.push(qualityCheck)\n        }\n        this.#qualityCheckElements = nextQualityCheckElements\n        const currentChildren = Array.from(this.#checksdiv.children)\n        const sameOrder = currentChildren.length === nextQualityCheckElements.length &&\n            currentChildren.every((child, i) => child === nextQualityCheckElements[i])\n        if (!sameOrder) {\n            for (let i = 0; i < nextQualityCheckElements.length; i++) {\n                const row = nextQualityCheckElements[i]\n                const currentChild = this.#checksdiv.children[i]\n                if (currentChild !== row) {\n                    this.#checksdiv.insertBefore(row, currentChild ?? null)\n                }\n            }\n            for (const child of Array.from(this.#checksdiv.children)) {\n                if (!nextQualityCheckElements.includes(child as CustomDatasetFormQualityCheck)) {\n                    child.remove()\n                }\n            }\n        }\n        const rows_valid = is_qualitychecks_valid(nextQualityCheckElements)\n        const currentDataset = current_filtered_dataset_object(state)\n        if (currentDataset && currentDataset.ApiType === 'timeseries') {\n            const datasetName = currentDataset.ApiUrl.split('/').pop() || ''\n            if (datasetName !== this.#lastTimeseriesDatasetName) {\n                this.#lastTimeseriesDatasetName = datasetName\n                void this.#fetch_timeseries_datatypes(datasetName)\n            }\n        } else {\n            this.#lastTimeseriesDatasetName = null\n        }\n\n        const form_errors: string[] = []\n        if (!this.#dataproviders.isvalid) {\n            form_errors.push('select a data provider')\n        }\n        if (!this.#datasets.isvalid) {\n            form_errors.push('select a dataset')\n        }\n        if (isTimeseries && !this.#timeseriesDatatype.isvalid) {\n            form_errors.push('select a timeseries datatype')\n        }\n        if (isTimeseries && !this.#timeseriesActiveStatus.isvalid) {\n            form_errors.push('select a timeseries status')\n        }\n        if (isTimeseries && !this.#timeseriesPeriod.isvalid) {\n            form_errors.push('select a timeseries period')\n        }\n        if (this.#state.qualityChecks.length === 0) {\n            form_errors.push('add at least one check')\n        }\n        if (!rows_valid) {\n            form_errors.push('invalid checks')\n        }\n        const form_is_valid = form_errors.join(', ')\n\n        this.#formIsvalidSpan.textContent = form_is_valid\n\n        // this.#saveButton.disabled = form_is_valid !== ''\n    }\n\n    async #fetch_timeseries_datatypes(datasetName: string) {\n        this.#timeseriesFetchAbortController?.abort()\n        const controller = new AbortController()\n        this.#timeseriesFetchAbortController = controller\n        try {\n            const resp = await fetch(\n                `${MOBILITY_API_BASE}/v2/flat/*/*?select=stype,tname&where=stype.eq.${datasetName}`,\n                { signal: controller.signal }\n            )\n            const json = await resp.json()\n            const list: OptionItem[] = json.data.map((r: any): OptionItem => ({ label: r.tname, value: r.tname }))\n            list.sort((a, b) => a.label.localeCompare(b.label))\n            this.#state.timeseries_datatypes = list\n            this.#resync_derived_resources()\n        } catch (err) {\n            if (!(err instanceof DOMException && err.name === 'AbortError')) {\n                throw err\n            }\n        }\n    }\n\n    async #onstart() {\n        const startState = this.#state\n        startState.loading = true\n        this.#resync_derived_resources()\n        await new Promise((s) => setTimeout(s, 0))\n        const datasetlist_response = await fetch(\n            `${TOURISM_API_BASE}/v1/MetaData?pagesize=300&origin=webcomp-datasets-list`\n        )\n        const datasetlist: DatasetItem[] = (await datasetlist_response.json()).Items\n        datasetlist.sort((aName, bName) => {\n            return aName > bName ? 1 : (aName < bName ? -1 : 0)\n        })\n\n        const metadata_response = await fetch(`${TOURISM_API_BASE}/swagger/v1/swagger.json`)\n        const metadata = await metadata_response.json() as DatasetsOpenapi\n\n        const state = this.#state\n        state.datasets = datasetlist\n        state.openapi = metadata\n        state.loading = false\n        this.#resync_derived_resources()\n    }\n\n    #onchange_current_dataprovider(isvalid: boolean, value: string) {\n        if (isvalid)\n            this.#state.current_dataprovider = value\n        this.#state.current_filtered_dataset = ''\n        this.#state.qualityChecks = []\n        this.#resync_derived_resources()\n    }\n\n    #onchange_current_filtered_dataset(isvalid: boolean, value: string) {\n        const dataset = isvalid ? value : ''\n        this.#state.current_filtered_dataset = dataset\n        if (!this.#state.current_dashboard_name) {\n            this.#state.current_dashboard_name = dataset\n        }\n        this.#state.current_timeseries_datatype = ''\n        this.#state.current_timeseries_mperiod = ''\n        this.#resync_derived_resources()\n    }\n\n    #onchange_current_timeseries_active_status(isvalid: boolean, value: string) {\n        this.#state.current_timeseries_active_status = isvalid ? value : 'only-active'\n        this.#resync_derived_resources()\n    }\n\n    #onclick_add_check() {\n        const state = this.#state\n        state.qualityChecks.push({\n            field_name: '',\n            compare_value: '',\n            operation: '',\n            items: field_names(state)\n        })\n        this.#resync_derived_resources()\n    }\n}\n\nconst CustomDatasetFormTagName = `cs-${CustomDatasetForm.name.replace(/([a-z0-9])([A-Z])/g, '$1-$2').toLowerCase()}`\ncustomElements.define(CustomDatasetFormTagName, CustomDatasetForm)\n", "<!--\n  SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n\n  SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<link rel=\"stylesheet\" href=\"index.css\">\n<style>\n    @import url(\"anywhere.css\");\n    @import url(\"all-webcomponent.css\");\n\n\tcs-menu-element {\n\t\twidth: 16rem;\n\t\tflex-shrink: 0;\n\t\theight: 100%;\n\t\toverflow: scroll;\n\t}\n\t.header {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 1rem;\n\t}\n\t.header-center {\n\t\tflex-grow: 1;\n\t\ttext-align: center;\n\t}\n\n\n\n\t.logo {\n\t\theight: 2rem;\n\t}\n\n\t.body {\n\t\tborder-top: 1px solid #ccc;\n\t\tmin-height: 0; /* don't go outside parent */\n\t}\n\n\t.projects {\n\t\tflex-grow: 100;\n\t\tborder-left: 1px solid #ccc;\n\t\tpadding: 1rem;\n\t\toverflow: scroll;\n\t}\n\n\t:host {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\n\t.MainComponent {\n\t\tmin-height: 0; /* don't go outside parent */\n\t\tflex-grow: 1;\n\t}\n\n\n</style>\n<div class=\"MainComponent flex-col padding-medium gap-medium\">\n\t<div class=\"header\">\n\t\t<img class=\"logo\" src=\"NOI_OPENDATAHUB_NEW_BK_nospace-01.svg\">\n\t\t<div class=\"header-center\"></div>\n\t</div>\n\t<button class=\"testing\" style=\"display: none\";>testing</button>\n\t<div class=\"body flex-row flex-grow\">\n\t\t<div class=\"projects\"></div>\n\t</div>\n</div>\n", "// SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport { CommonWebComponent } from './CommonWebComponent.js'\nimport {MenuComponent} from './MenuComponent.js'\nimport {StandardDashboardsComponent} from './StandardDashboardsComponent.js'\nimport {CustomDashboardsComponent} from './CustomDashboardsComponent.js'\n\n\nimport {DatasetIssuesDetail} from './DatasetIssuesDetail.js'\nimport { cs_cast, cs_notnull } from './quality.js';\nimport { DatasetIssuesByCategories } from './DatasetIssuesByCategories.js';\n\nimport { AuthComponent } from './AuthComponent.js'\nimport { CustomDatasetForm } from './CustomDatasetForm.js';\nimport { API3 } from './api/api3.js'\nimport { kc } from './auth.js'\nimport template from './MainComponent.html?raw'\n\nexport class MainComponent extends CommonWebComponent\n{\n\tdashboards: StandardDashboardsComponent|null = null;\n\tcustomDashboards: CustomDashboardsComponent|null = null;\n\t\n\tchangingSection\n\t\n\tlogo\n\n\tconstructor()\n\t{\n\t\tsuper(template)\n\t\tthis.changingSection = this.sroot.querySelector('.projects')!\n\t\t\n\t\tthis.logo = cs_cast(HTMLImageElement, this.sroot.querySelector('.logo'))\n\t\tthis.logo.onclick = () => {\n\t\t\tlocation.hash = ''\n\t\t}\n\t\t\n\t\tthis.sroot.querySelector('.header')!.appendChild(new AuthComponent())\n\t\t\n\t\tconst menu: MenuComponent = new MenuComponent();\n\t\tmenu.setAttribute(\"data-testid\", \"leftmenu\")\n\t\tmenu.refresh()\n\t\tthis.changingSection.parentElement!.prepend(menu);\n\t\t\n\t\tconst onhashchange = async () => {\n\t\t\t\n\t\t\tconsole.log('hash')\n\t\t\tconsole.log(location.hash)\n\t\t\t\n\t\t\tthis.changingSection.textContent = ''\n\t\t\t\n\t\t\tlet cleanedhash = location.hash\n\t\t\tif (cleanedhash.startsWith('#state='))\n\t\t\t\tcleanedhash = ''\n\t\t\t\n\t\t\tif (cleanedhash === '')\n\t\t\t{\n\t\t\t\tif (this.dashboards === null)\n\t\t\t\t{\n\t\t\t\t\tthis.dashboards = new StandardDashboardsComponent();\n\t\t\t\t\tthis.dashboards.refresh();\n\t\t\t\t}\n\t\t\t\tthis.changingSection.appendChild(this.dashboards)\n\t\t\t\tmenu.selectItem('')\n\t\t\t}\n\n\t\t\tif (cleanedhash.indexOf('#page=dataset-categories&') === 0)\n\t\t\t{\n\t\t\t\tthis.changingSection.textContent = ''\n\t\t\t\tconst detail = new DatasetIssuesByCategories();\n\t\t\t\tthis.changingSection.appendChild(detail)\n\t\t\t\tconst params = new URLSearchParams(cleanedhash.substring(1));\n\t\t\t\tconst session_start_ts = cs_notnull(params.get('session_start_ts'))\n\t\t\t\tconst dataset_name = cs_notnull(params.get('dataset_name'))\n\t\t\t\tconst failed_records = parseInt(cs_notnull(params.get('failed_records')))\n\t\t\t\tconst tested_records = parseInt(cs_notnull(params.get('tested_records')))\n\t\t\t\tdetail.refresh(session_start_ts, dataset_name, failed_records, tested_records);\n\t\t\t\tmenu.selectItem(dataset_name)\n\t\t\t}\n\t\t\t\n\t\t\tif (cleanedhash.startsWith('#page=summary&'))\n\t\t\t{\n\t\t\t\tthis.changingSection.textContent = ''\n\t\t\t\tconst detail = new DatasetIssuesDetail();\n\t\t\t\tthis.changingSection.appendChild(detail)\n\t\t\t\tconst params = new URLSearchParams(cleanedhash.substring(1));\n\t\t\t\tconst session_start_ts = cs_notnull(params.get('session_start_ts'))\n\t\t\t\tconst dataset_name = cs_notnull(params.get('dataset_name'))\n\t\t\t\tconst category_name = cs_notnull(params.get('category_name'))\n\t\t\t\tconst failed_records = parseInt(cs_notnull(params.get('failed_records')))\n\t\t\t\tconst tot_records = parseInt(cs_notnull(params.get('tot_records')))\n\t\t\t\tdetail.refresh(session_start_ts, dataset_name, category_name, failed_records, tot_records);\n\t\t\t\tmenu.selectItem(dataset_name)\n\t\t\t}\n\n\t\t\tif (cleanedhash.startsWith('#customdataset'))\n\t\t\t{\n\t\t\t\tthis.changingSection.textContent = ''\n\t\t\t\tconst params = new URLSearchParams(cleanedhash.substring('#customdataset'.length))\n\t\t\t\tconst idParam = params.get('id')\n\t\t\t\tif (idParam !== null)\n\t\t\t\t{\n\t\t\t\t\tmenu.selectItem(`custom:${idParam}`)\n\t\t\t\t\tconst form = new CustomDatasetForm()\n\t\t\t\t\tform.setAttribute('data-testid', 'custom-dataset-form')\n\t\t\t\t\tform.addEventListener('save-custom-dashboard', async () => {\n\t\t\t\t\t\tconst elaborationHandle = form.setElaborationInProgress()\n\t\t\t\t\t\tlet shouldCloseImmediately = true\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst draft = form.getCustomDashboardDraft()\n\t\t\t\t\t\t\tconst payload: { id: number; name: string; test_definition_json: any } = {\n\t\t\t\t\t\t\t\tid: draft.id!,\n\t\t\t\t\t\t\t\tname: draft.name,\n\t\t\t\t\t\t\t\ttest_definition_json: draft.test_definition_json\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst body = new URLSearchParams()\n\t\t\t\t\t\t\tbody.set('action', 'insert_custom_dashboard')\n\t\t\t\t\t\t\tbody.set('test_definition_json', JSON.stringify(payload))\n\t\t\t\t\t\t\tbody.set('current_role', sessionStorage.getItem('used_key_role') ?? '')\n\n\t\t\t\t\t\t\tconst headers: HeadersInit = { 'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8' }\n\t\t\t\t\t\t\tif (kc.token) {\n\t\t\t\t\t\t\t\theaders.Authorization = `Bearer ${kc.token}`\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst response = await fetch('api', {\n\t\t\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\t\t\theaders,\n\t\t\t\t\t\t\t\tbody\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tif (response.ok) {\n\t\t\t\t\t\t\t\telaborationHandle.setText('success')\n\t\t\t\t\t\t\t\telaborationHandle.closeAfter(2000)\n\t\t\t\t\t\t\t\tshouldCloseImmediately = false\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\telaborationHandle.setText(`error ${response.status}`)\n\t\t\t\t\t\t\t\telaborationHandle.closeAfter(2000)\n\t\t\t\t\t\t\t\tshouldCloseImmediately = false\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch {\n\t\t\t\t\t\t\telaborationHandle.setText('error')\n\t\t\t\t\t\t\telaborationHandle.closeAfter(2000)\n\t\t\t\t\t\t\tshouldCloseImmediately = false\n\t\t\t\t\t\t} finally {\n\t\t\t\t\t\t\tif (shouldCloseImmediately) {\n\t\t\t\t\t\t\t\telaborationHandle.close()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\tthis.changingSection.appendChild(form)\n\t\t\t\t\tconst elaborationHandle = form.setElaborationInProgress()\n\t\t\t\t\tconst rows = await API3.list__catchsolve_noiodh__custom_dashboards({ id: Number(idParam) })\n\t\t\t\t\tif (rows.length === 0) {\n\t\t\t\t\t\tawait form.loadCustomDashboard({}, Number(idParam), 'noname')\n\t\t\t\t\t\telaborationHandle.close()\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tconst dashboard = rows[0]\n\t\t\t\t\tlet definition: any\n\t\t\t\t\ttry {\n\t\t\t\t\t\tdefinition = JSON.parse(dashboard.test_definition_json)\n\t\t\t\t\t} catch {\n\t\t\t\t\t\telaborationHandle.close()\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tawait form.loadCustomDashboard(definition, dashboard.id, dashboard.name)\n\t\t\t\t\telaborationHandle.close()\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tmenu.selectItem('custom')\n\t\t\t\t\tif (this.customDashboards === null)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.customDashboards = new CustomDashboardsComponent();\n\t\t\t\t\t\tthis.customDashboards.refresh();\n\t\t\t\t\t}\n\t\t\t\t\tthis.changingSection.appendChild(this.customDashboards)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\twindow.onpopstate = (e) => {\n\t\t\tonhashchange()\n\t\t}\n\n\t\tonhashchange()\n\n\t\tthis.querySelector('.testing').onclick = () => {\n\t\t\tif (this.dashboards != null)\n\t\t\t{\n\t\t\t\tconst first = this.dashboards.testing_htmlelements()[0]\n\t\t\t\tfirst.dispatchEvent(new MouseEvent('click', { bubbles: true, cancelable: true }))\n\t\t\t}\n\t\t}\n\n\t\t\n\t}\n\t\n}\n\ncustomElements.define('cs-main-component', MainComponent)\n", "// SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin\n//\n// SPDX-License-Identifier: AGPL-3.0-or-later\n\nimport { initAuth } from './auth.js';\nimport { MainComponent } from './MainComponent.js';\n\nasync function main() {\n\n    // initialize authentication before anything else\n    await initAuth();\n\n    const mainComponent = new MainComponent();\n    mainComponent.setAttribute('data-testid','main-component')\n    document.body.appendChild(mainComponent)\n\n}\n\nmain();\n\n"],
  "mappings": "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",
  "names": ["error", "b64DecodeUnicode", "base64UrlDecode", "isvalid", "isvalid", "elaborationHandle"]
}
